!function(t,a){void 0!==t.Vue&&t.Vue.component("background-container",function(){var t={default:3,"zoom-tile":5,top:11,"in-horizontal":1,bottom:12,left:21,"in-vertical":2,right:22,"left-top":13,"center-top":8,"right-top":14,"left-center":6,"center-center":0,"right-center":7,"left-bottom":15,"center-bottom":9,"right-bottom":16};function a(a){var e={};switch(0===a.picScale?vue_utils.Background.PAVING_EFFECT.some(function(i){return t[i.key]==a.repeat&&(["backgroundRepeat","backgroundPositionX","backgroundPositionY","backgroundSize"].forEach(function(t){e[t]=i[t]}),!0)}):1===a.picScale?vue_utils.Background.IMAGE_POSITION.some(function(i){return t[i.key]==a.repeat&&(["backgroundRepeat","backgroundPositionX","backgroundPositionY","backgroundSize"].forEach(function(t){e[t]=i[t]}),!0)}):2===a.picScale?["backgroundRepeat","backgroundPositionX","backgroundPositionY","backgroundSize"].forEach(function(t){e[t]=vue_utils.Background.SCALING_FILL[0][t]}):3===a.picScale?["backgroundRepeat","backgroundPositionX","backgroundPositionY","backgroundSize"].forEach(function(t){e[t]=vue_utils.Background.SCALING_STRETCH[0][t]}):4===a.picScale&&["backgroundRepeat","backgroundPositionX","backgroundPositionY","backgroundSize"].forEach(function(t){e[t]=vue_utils.Background.SCALING_CONTAIN[0][t]}),a.opacity>-1&&(e.opacity=1-a.opacity/100),a.effectType){case 0:e.backgroundAttachment="scroll";break;case 1:e.backgroundAttachment="fixed"}return e.backgroundColor=vue_utils.concatBackgroundColor(a.color),e.backgroundImage=vue_utils.concatBackgroundImage(a.imgPath,a.color),e}function e(t){var a=t.repeat;return t.repeat=0==t.picScale&&[3,5,11,1,12,21,2,22].indexOf(t.repeat)<0?3:t.repeat,t.repeat=1==t.picScale&&[13,8,14,6,0,7,15,9,16].indexOf(t.repeat)<0?0:t.repeat,a!=t.repeat}return{name:"BackgroundContainer",template:'<background-core-component ref="background" :value="valueForBackgroundCore" :file-upload="fileUpload" :link-jump="linkJump" :use-attachment="showeffect" :label-width="labelWidth" @on-type-change="onTypeChange" @on-image-change="onImageChange" @on-attachment-change="onAttachmentChange" @on-repeat-change="onRepeatChange" @on-scale-change="onScaleChange" @on-color-changing="onColorChanging" @on-color-change="onColorChange" @on-opacity-changing="onOpacityChanging" @on-opacity-change="onOpacityChange"></background-core-component>',props:{data:{type:Object,default:function(){return{}}},showeffect:Boolean,labelWidth:{type:String,default:"130px"}},data:function(){var t=a(this.data);return{valueForBackgroundCore:t,cache:{color:this.data.color,picScale:this.data.picScale,repeat:this.data.repeat,effectType:this.data.effectType,imgPath:this.data.imgPath,imgId:this.data.imgId,opacity:this.data.opacity}}},watch:{data:{deep:!0,handler:function(t){var e=a(t);this.valueForBackgroundCore=e}}},methods:{onTypeChange:function(t){var a=vue_utils.parseBackgroundImageUrl(t.backgroundImage);""===a?(this._prevFilePath=this.data.imgPath,this._prevFileId=this.data.imgId,this.imgChange($.toJSON({data:[{filePath:"",fileId:""}]}))):a==this._prevFilePath&&this.imgChange($.toJSON({data:[{filePath:this._prevFilePath,fileId:this._prevFileId}]}))},onImageChange:function(t){var a=vue_utils.parseBackgroundImageUrl(t.backgroundImage);""===a&&this.imgChange($.toJSON({data:[{filePath:"",fileId:""}]}))},onAttachmentChange:function(t){switch(t.backgroundAttachment){case"scroll":this.effectTypeChange(0);break;case"fixed":this.effectTypeChange(1)}},onRepeatChange:function(a){var e=this;[vue_utils.Background.IMAGE_POSITION,vue_utils.Background.PAVING_EFFECT].some(function(i){return i.some(function(i){return!!["backgroundRepeat","backgroundPositionX","backgroundPositionY","backgroundSize"].every(function(t){return a[t]===i[t]})&&(e.bgRepeatChange(t[i.key]),!0)})})},onScaleChange:function(t){var a=this;[vue_utils.Background.PAVING_EFFECT,vue_utils.Background.IMAGE_POSITION,vue_utils.Background.SCALING_FILL,vue_utils.Background.SCALING_STRETCH,vue_utils.Background.SCALING_CONTAIN].some(function(e,i){return e.some(function(e){return!!["backgroundRepeat","backgroundPositionX","backgroundPositionY","backgroundSize"].every(function(a){return t[a]===e[a]})&&(a.bgScaleChange(i),!0)})})},onColorChanging:function(t){this.bgColorchange(vue_utils.parseBackgroundImageGradient(t.backgroundImage)||t.backgroundColor)},onColorChange:function(t){this.bgColorChangeStop(vue_utils.parseBackgroundImageGradient(t.backgroundImage)||t.backgroundColor)},onOpacityChanging:function(t){this.bgOpacityChange(100*(1-t.opacity))},onOpacityChange:function(t){this.bgOpacityChangeStop(100*(1-t.opacity))},linkJump:function(){window.open("../view.jsp?fileID="+this.data.imgId)},fileUpload:function(){var t=this;Site.fileUpload2(!1,this.data.uploadData,function(a){if(!a)return;var e=$.parseJSON(a).data[0]||{},i={filePath:t.data.imgPath||"",fileId:t.data.imgId||"",classname:t.data.fontClass||"",color:t.data.fontColor||""},n={filePath:e.filePath||"",fileId:e.fileId||"",classname:e.classname||"",color:e.color||""};t.fileChangeCallBack(a),t.$emit("on-undo",{data:[n]},{data:[i]})})},fileChangeCallBack:function(t){if(t&&t){this.imgChange(t);var a=$.parseJSON(t),e=a.data[0]||{};this.data.imgPath=e.filePath,this.data.imgId=e.fileId}},refreshCache:function(){this.cache={color:this.data.color,picScale:this.data.picScale,repeat:this.data.repeat,effectType:this.data.effectType,imgPath:this.data.imgPath,imgId:this.data.imgId,opacity:this.data.opacity}},effectTypeChange:function(t){this.effectTypeEmit(t),this.$emit("on-undo",this.data,this.cache),this.refreshCache()},effectTypeEmit:function(t){this.data.effectType=t,this.$emit("bg-effect-change",t)},bgColorchange:function(t){this.bgColorEmit(t)},bgColorChangeStop:function(t){this.bgColorEmit(t),this.$emit("on-undo",this.data,this.cache),this.refreshCache()},bgColorEmit:function(t){this.data.color=t,this.$emit("bg-color-change",t)},bgRepeatChange:function(t){this.bgRepeatEmit(t),this.$emit("on-undo",this.data,this.cache),this.refreshCache()},bgRepeatEmit:function(t){this.data.repeat=t,this.$emit("bg-repeat-change",t)},bgScaleChange:function(t){this.bgScaleEmit(t),this.$emit("on-undo",this.data,this.cache),this.refreshCache()},bgScaleEmit:function(t){this.data.picScale=t,2==t?this.data.repeat=30:4==t?this.data.repeat=40:3==t?this.data.repeat=4:0!=t&&1!=t||e(this.data)&&this.bgRepeatEmit(this.data.repeat),this.bgRepeatEmit(this.data.repeat),this.$emit("bg-scale-change",t)},imgChange:function(t){this.imgEmit(t),this.$emit("on-undo",this.data,this.cache),this.refreshCache()},imgEmit:function(t){this.bgImgChange(t)},bgImgChange:function(t){this.bgImgEmit(t),this.$emit("on-undo",this.data,this.cache),this.refreshCache()},bgImgEmit:function(t){var a=JSON.parse(t),i=a.data[0]||{};this.data.imgPath=i.filePath,this.data.imgId=i.fileId,i.fileId&&(this.data.repeat=-1==this.data.repeat?3:this.data.repeat),this.$emit("img-change",t),e(this.data)&&this.bgRepeatEmit(this.data.repeat)},bgDataEmit:function(t){var a={},e={data:[a]};this.data.imgPath=t.imgPath,this.data.imgId=t.imgId,a.filePath=t.imgPath,a.fileId=t.imgId,this.$emit("img-change",JSON.stringify(e))},bgOpacityChange:function(t){this.bgOpacityEmit(t)},bgOpacityChangeStop:function(t){this.bgOpacityEmit(t),this.$emit("on-undo",this.data,this.cache),this.refreshCache()},bgOpacityEmit:function(t){this.data.opacity=t,this.$emit("bg-opacity-change",t)},bgOpacityBlur:function(t){this.$emit("bg-opacity-blur",t,this.$refs.opacity)}}}}())}(this);