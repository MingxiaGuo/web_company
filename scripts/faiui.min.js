function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t){function e(l,c){var h=[];void 0!==c.dataList&&null!==c.dataList||(c.dataList=[]),t.each(c.dataList,function(t,e){void 0===e[c.primaryKey]&&(c.dataList[t][c.primaryKey]=c.tmp.maxPrimaryKey,c.tmp.maxPrimaryKey++)}),function(e,i){var o=[];t.each(i.dataList,function(e,a){var s=0;t.each(i.tmp.searchMatcher,function(e,i){var o=i.searchKeyList,n=i.searchString,r=i.useToLowerCase;void 0===r&&(r=!0);var l=i.cmd;void 0===l&&(l="like");var d=!1;t.each(o,function(e,o){var s=a[o];if(r&&"string"==typeof n&&"string"==typeof s?(s=s.toString().toLowerCase(),n=n.toString().toLowerCase()):"string"==typeof s?s=s.toString():void 0===s&&(s=""),"eq"==l){if(s===n)return d=!0,!1}else if("gt"==l){if(s>n)return d=!0,!1}else if("lt"==l){if(s<n)return d=!0,!1}else if("ge"==l){if(a[o].toString()>=n)return d=!0,!1}else if("le"==l){if(s<=n)return d=!0,!1}else if("and"==l){if(Fai.checkBit(s,n))return d=!0,!1}else if("inArray"==l){if(t.inArray(n,s)>=0)return d=!0,!1}else if("callBack"==l){if(i.callBack(a))return d=!0,!1}else if("string"!=typeof s&&(s=s.toString()),s.indexOf(n)>=0)return d=!0,!1}),d&&s++}),s==i.tmp.searchMatcher.length&&o.push(a)}),i.tmp.result=o}(0,c);var p=c.dataList;c.tmp.searchMatcher.length>0&&(p=c.tmp.result);var u=function(t,e){var o=t.page.startPage,a=t.page.showCount,s=t.tmp.maxPage,n=[];if(0==a)return e;var r=e.length;if(e&&e.length>0){var r=e.length;s=r%a==0?r/a:Math.floor(r/a)+1,o=(o=o<1?1:o)>s?s:o,t.page.startPage=o;var l=(o-1)*a<0?0:(o-1)*a,d=o+a<0?0:o+a;for(d=d>r?r:l+a,i=l;i<d;i++)void 0!==e[i]&&n.push(e[i])}else s=1;return t.tmp.maxPage=s,n}(c,p);if(u.length>0)t.each(u,function(e,i){i[c.primaryKey];var o="";c.tableRowsClass[i[c.primaryKey]]&&(o=' class="'+c.tableRowsClass[i[c.primaryKey]]+'"');var a=c.primaryKey+'="'+i[c.primaryKey]+'"';h.push("<tr "+a+o+">"),c.tableColumn.showCheckbox&&h.push('<td class="checkBoxWidth textCenter"><label class="faiTableCheckboxLabel"><input type="checkbox" value=""></label></td>'),t.each(c.tableColumn.columns,function(e,o){var a=o.key,s=i[a],n=o.rowClass,r="";r=void 0!==o.extData&&t.isFunction(o.extData)?o.extData(s,i):void 0===o.encode||o.encode?Fai.encodeHtml(s):s,o.custom&&(r=o.customData),c.sortData.showSortBtn&&a==c.sortData.showColumnKey&&(r='<div class="sortPanel"><a class="up pointer"></a><a class="down pointer"></a></div>',n=void 0!==n?"sortWidth "+n:"sortWidth");var l="",d="padding ellipsis tdWrap";l=void 0!==n?n+" ellipsis":"defaultWidth ellipsis";var p="";o.onTitle&&(p=' title="'+Fai.encodeHtml(s)+'"',o.textArea&&(p=' title="'+Fai.encodeHtmlAttr(s)+'"')),o.textArea&&(d+=" textAreaWrap "),h.push('<td class="'+l+'"'+p+'><div class="'+d+'">'+r+"</div></td>")}),h.push("</tr>")});else{var f=r(l);h.push('<tr class="queryIngTr">'),h.push('<td class="padding" colspan="'+f+'">'+c.noDataMsg+"</td>"),h.push("</tr>")}l.find("div.center table:first>tbody").html(h.join("")),(Fai.isIE6()||Fai.isIE7())&&(o(l),t(window).resize(function(){o(l)})),c.itemHover&&l.find("div.center table:first>tbody>tr").hover(function(){t(this).addClass("hover")},function(){t(this).removeClass("hover")}),function(e,i){var o,a,s=0,n=0,r=!1,l=i.expandMinWidth,d=l,c=e.find("div.center table:first>thead"),h=e.find("div.center table:first>thead th"),p=e.find("div.center table:first>thead").find("th.expand").find(".expandRightLine"),u=c.find("th.pointer");p.hover(function(){t(this).addClass("expanding")},function(){t(this).removeClass("expanding")}),p.mousedown(function(e){s=e.pageX,o=t(this).parents("th.expand"),t(this),n=o.width(),r=!0,c.addClass("changeCursor"),u.removeClass("pointer"),o.addClass("expanding"),a=o.attr("data-key"),t(i.tableColumn.columns).each(function(t,e){if(e.key==a)return d=e.expandMinWidth||l,!1;d=l}),h.mousemove(function(t){var e=0,i=0;r&&(c.onselectstart=function(){return!1},e=parseInt(t.pageX-s),i=parseInt(n+e),o.css({width:i<d?d+"px":i+"px"}))})}).mousemove(function(e){o=t(this).parents("th.expand"),a=o.attr("data-key"),t(i.tableColumn.columns).each(function(t,e){if(e.key==a)return d=e.expandMinWidth||l,!1;d=l});var h=0,p=0;r&&(c.onselectstart=function(){return!1},h=parseInt(e.pageX-s),p=parseInt(n+h),o.css({width:p<d?d+"px":p+"px"}))}),t(document).mouseup(function(e){r&&(r=!1,c.removeClass("changeCursor"),u.addClass("pointer"),""!=i.expandCookie&&t.cookie(i.expandCookie+o.attr("data-key"),o.width(),{expires:365,path:"/"}))})}(l,c),(c.sortData.showSortBtn||c.sortData.sortable)&&function(e,i){e.find("div.center table:first>tbody>tr").each(function(){var e=parseInt(t(this).attr(i.primaryKey));-1!=t.inArray(e,i.sortData.unSortList)&&t(this).removeClass("move").addClass("unSort").find(".sortPanel").remove()})}(l,c),c.sortData.showSortBtn&&(s(l),function(e,i){e.find("div.center table:first>tbody>tr>td .sortPanel a").bind("click",function(){var o=t(this).parents("tr");t(this).hasClass("up")?o.insertBefore(o.prev()):t(this).hasClass("down")&&o.insertAfter(o.next()),s(e),i.sortData.sortBack&&i.sortData.sortBack(),n(e,i),a(e)}),s(e)}(l,c)),c.sortData.sortable&&function(e,i){e.find("div.center table:first>tbody>tr").each(function(){t(this).hasClass("queryIngTr unSort")||t(this).addClass("move")}),e.sortable("destroy"),e.sortable({start:function(){var i=r(e);t(".sortablePlaceholder").append('<td colspan="'+i+'"><div class="sortableHighlight"></div></td>')},axis:"y",placeholder:"sortablePlaceholder",items:"div.center table:first>tbody>tr:not(.unSort)",distance:3,cancel:".queryIngTr, input, .unSort",stop:function(){a(e),s(e),i.sortData.sortBack&&i.sortData.sortBack(),n(e,i)}}),e.disableSelection()}(l,c),a(l),c.bottom.show&&c.bottom.showTotal&&function(e){var i=0;t.each(e.find("div.center table:first>tbody>tr"),function(){t(this).hasClass("queryIngTr")||i++}),e.find("div.bottom>.total>.pageTotal").html("本页共"+i+"个 ")}(l),c.bottom.show&&c.bottom.showAllTotal&&function(t,e){var i=e.length;t.find("div.bottom>.total>.allTotal").html("总共"+i+"个")}(l,c.tmp.result),c.bottom.show&&c.bottom.showExtTotal&&function(e,i){var o="";void 0!==i.bottom.showExtData&&t.isFunction(i.bottom.showExtData)&&(o=i.bottom.showExtData(i.tmp.result));e.find("div.bottom>.total>.extTotal").html(o)}(l,c),c.bottom.show&&c.bottom.showPage&&function(i,o){var a,s,n=[];if(a=o.page.startPage-2<=0?1:o.page.startPage-2,s=o.page.startPage+2>=o.tmp.maxPage?o.tmp.maxPage:o.page.startPage+2,!0===o.page.pageClass.isDefaultPage)if("new2"==o.page.pageClass.pageStyle){n.push('<a href="javascript:;" hidefocus="true" class="firstPage '+o.page.pageClass.pagePrevClass+'">首页</a>'),n.push('<a href="javascript:;" hidefocus="true" class="prevPage disabledBtn '+o.page.pageClass.pagePrevClass+'"><<上一页</a>'),Math.abs(o.page.startPage-1)>5&&1!=a&&n.push("<div class='pageNo_model'><a class='grayContent'>1</a></div>"),a>2&&n.push("<div class='pageEllipsis_new'></div>");for(var r=a;r<=s;r++)r==o.page.startPage?n.push("<div class='pageNo_model'><span style='margin-left:4px;' class='blueTitle'>"+o.page.startPage+"</span></div>"):n.push("<div class='pageNo_model'><a class='grayContent'>",r,"</a></div>");s<o.tmp.maxPage-1&&n.push("<div class='pageEllipsis_new'></div>"),Math.abs(o.page.startPage-o.tmp.maxPage)>5&&o.tmp.maxPage!=s&&n.push("<div class='pageNo_model'><a class='grayContent'>"+o.tmp.maxPage+"</a></div>"),n.push('<a href="javascript:;" hidefocus="true" class="nextPage disabledBtn '+o.page.pageClass.pageNextClass+'">下一页>></a>'),n.push('<a href="javascript:;" hidefocus="true" class="endPage '+o.page.pageClass.pageNextClass+'">尾页</a>')}else if("new"==o.page.pageClass.pageStyle){n.push('<a href="javascript:;" hidefocus="true" class="prevPage disabledBtn '+o.page.pageClass.pagePrevClass+'"><div class="pagePrevClassImg"></div></a>'),Math.abs(o.page.startPage-1)>5&&1!=a&&n.push("<div class='pageNo_model'><a class='grayContent'>1</a></div>"),a>2&&n.push("<div class='pageEllipsis_new'></div>");for(var r=a;r<=s;r++)r==o.page.startPage?n.push("<div class='pageNo_model'><span style='margin-left:4px;' class='blueTitle'>"+o.page.startPage+"</span></div>"):n.push("<div class='pageNo_model'><a class='grayContent'>",r,"</a></div>");s<o.tmp.maxPage-1&&n.push("<div class='pageEllipsis_new'></div>"),Math.abs(o.page.startPage-o.tmp.maxPage)>5&&o.tmp.maxPage!=s&&n.push("<div class='pageNo_model'><a class='grayContent'>"+o.tmp.maxPage+"</a></div>"),n.push('<a href="javascript:;" hidefocus="true" class="nextPage disabledBtn '+o.page.pageClass.pageNextClass+'"><div class="pageNextClassImg"></div></a>'),n.push('<span style="margin-left: 10px;position: relative;top:1px;" class="currentPage">共&nbsp;'+o.tmp.maxPage+"&nbsp;页</span>"),n.push('<div class="pageSearch pageSearch_N"><span class="grayTitle">到第&nbsp;<input oninput="this.value=this.value.replace(/[^0-9]+/g,\'\')" type="text" maxlength="3" onkeypress="javascript:return Fai.isNumberKey(event);">&nbsp;页<span></div>'),n.push('<div class="pageSearchClick pageSearchClick_N"><a class="bottomSearch" href="javascript:;">确定</a></div>')}else n.push('<a href="javascript:;" hidefocus="true" class="prevPage disabledBtn '+o.page.pageClass.pagePrevClass+'"><div class="pagePrevClassImg"></div></a>'),n.push('<span class="currentPage">'+o.page.startPage+"/"+o.tmp.maxPage+"</span>"),n.push('<a href="javascript:;" hidefocus="true" class="nextPage disabledBtn '+o.page.pageClass.pageNextClass+'"><div class="pageNextClassImg"></div></a>'),n.push('<div class="pageSearch"><input type="text" maxlength="3" onkeypress="javascript:return Fai.isNumberKey(event);"></div>'),n.push('<div class="pageSearchClick">跳转</div>');else n.push('<a href="javascript:;" hidefocus="true" class="prevPage disabledBtn">上一页</a>'),n.push('<span class="currentPage">'+o.page.startPage+"/"+o.tmp.maxPage+"页</span>"),n.push('<a href="javascript:;" hidefocus="true" class="nextPage disabledBtn">下一页</a>');i.find("div.bottom>.page").html(n.join("")),function(i,o){var a=i.find("div.bottom>div.page"),s=a.find("a.prevPage"),n=a.find("a.nextPage"),r=a.find("a.firstPage"),l=a.find("a.endPage"),d=a.find(".pageSearchClick"),c=o.page.startPage,h=(o.page.showCount,o.tmp.maxPage);if("new"==o.page.pageClass.pageStyle){var p=a.find(".pageNo_model");p.each(function(){var a=t(this).find(".grayContent").text();t(this).find(".grayContent").addClass("pointer"),t(this).find(".grayContent").bind("click",function(){o.page.startPage=parseInt(a),e(i,o)})})}if("new2"==o.page.pageClass.pageStyle){var p=a.find(".pageNo_model");p.each(function(){var a=t(this).find(".grayContent").text();t(this).find(".grayContent").addClass("pointer"),t(this).find(".grayContent").bind("click",function(){o.page.startPage=parseInt(a),e(i,o)})});var r=a.find(".firstPage");r.bind("click",function(){o.page.startPage=1,e(i,o)});var l=a.find(".endPage");l.bind("click",function(){o.page.startPage=a.find(".pageNo_model:last").text(),e(i,o)})}c>1&&s.removeClass("disabledBtn");c<h&&n.removeClass("disabledBtn");"new"==o.page.pageClass.pageStyle&&(s.hasClass("disabledBtn")&&(s.removeClass("prevShow_model"),s.addClass("prevHide_model")),n.hasClass("disabledBtn")&&(n.removeClass("nextShow_model"),n.addClass("nextHide_model")));"new2"==o.page.pageClass.pageStyle&&(s.hasClass("disabledBtn")&&(s.removeClass("prevShow_model"),s.addClass("prevHide_model"),r.removeClass("prevShow_model"),r.addClass("prevHide_model")),n.hasClass("disabledBtn")&&(n.removeClass("nextShow_model"),n.addClass("nextHide_model"),l.removeClass("nextShow_model"),l.addClass("nextHide_model")));s.hasClass("disabledBtn")||(s.addClass("pointer"),s.bind("click",function(){!function(t,i){var o=i.page.startPage,a=i.page.showCount,s=i.dataList.length;s%a==0||Math.floor(s/a);o-1>0&&o--;i.page.startPage=o,e(t,i)}(i,o)}));n.hasClass("disabledBtn")||(n.addClass("pointer"),n.bind("click",function(){!function(t,i){var o=i.page.startPage,a=i.page.showCount,s=i.dataList.length,n=s%a==0?s/a:Math.floor(s/a)+1;o+1<=n&&o++;i.page.startPage=o,e(t,i)}(i,o)}));h>1&&d.removeClass("disabledBtn");d.hasClass("disabledBtn")||(d.addClass("pointer"),d.bind("click",function(){!function(t,i){var o=t.find("div.bottom>div.page").find(".pageSearch input").val();""!=o&&(o=parseInt(o));i.page.startPage;var a=i.page.showCount,s=i.dataList.length,n=s%a==0?s/a:Math.floor(s/a)+1;o<=n&&o>0?i.page.startPage=o:""===o?Fai.ing("您没有输入数值。",!0):i.page.startPage=n;e(t,i)}(i,o)}))}(i,o)}(l,c),function(e){var i=e.find("div.center table:first>thead>tr>th.checkBoxWidth input.checkbox.all"),o=e.find("div.center table:first>thead>tr>th.checkBoxWidth input.checkbox.all").parents("tr"),a=e.find("div.center table:first>tbody>tr>td.checkBoxWidth input");o.removeClass("checkedAll"),i.bind("click",function(){var i=t(this).prop("checked");a.prop("checked",i);var s=e.find("div.center table:first>tbody>tr>td.checkBoxWidth input[type='checkbox']").parents("tr");i?(s.addClass("checked"),o.addClass("checkedAll")):(s.removeClass("checked"),o.removeClass("checkedAll"))}),a.bind("click",function(){var s=e.find("div.center table:first>tbody>tr>td.checkBoxWidth input:checked");s.length==a.length?(i.prop("checked",!0),o.addClass("checkedAll")):(i.prop("checked",!1),o.removeClass("checkedAll")),t(this).prop("checked")?t(this).parents("tr").addClass("checked"):t(this).parents("tr").removeClass("checked")})}(l),function(t){t.find("div.center table:first>thead>tr>th.checkBoxWidth input.checkbox.all").prop("checked",!1)}(l),d(l,c)}function o(t){t.find("tr.fixIE6forFaiTable").remove();var e=t.width();if(t.find("table.faiTable").width()-e>0){var i=r(t),o=[];o.push('<tr class="fixIE6forFaiTable">'),o.push('<td colspan="'+i+'"></td>'),o.push("</tr>"),t.find("table.faiTable").append(o.join(""))}}function a(e){e.find("div.center table:first>tbody>tr").removeClass("even odd").each(function(e,i){e%2==0?t(this).addClass("odd"):t(this).addClass("even")})}function s(t){var e=t.find("div.center table:first>tbody>tr>td .sortPanel a.up"),i=t.find("div.center table:first>tbody>tr>td .sortPanel a.down");e.removeClass("disabled").first().addClass("disabled"),i.removeClass("disabled").last().addClass("disabled")}function n(e,i){var o=i.dataList,a=i.page.showCount,s=i.page.startPage,n=o.length,r=a*(s-1),l=a*s-1,d=e.find("div.center table:first>tbody>tr"),c=[],h=[];0==a&&(l=n-1,r=0),l>n&&(l=n-1);for(var p=r;p<=l;p++)c.push(o[p]);t.each(d,function(e,o){var a=t(o).attr(i.primaryKey);t.each(c,function(t,e){if(a==e[i.primaryKey])return h.push(e),!1})});for(var u=0,f=r;f<=l;f++)o[f]=h[u],u++;i.dataList=o}function r(t){return t.find("div.center table:first>thead>tr>th").length}function l(e,i){if(t.isArray(e)){var o=t.extend(!0,[],e);return t.each(o,function(t,e){delete e[i.primaryKey]}),o}if("object"===_typeof(e)){var a=t.extend(!0,{},e);return delete a[i.primaryKey],a}}function d(e,i){var o=e.find("div.center table:first>thead>tr>th"),a=e.find("div.center table:first>tbody>tr"),s=i.tableColumn.hiddenKeyList;t.each(o,function(e){var i=t(this).attr("data-key");t(this).removeClass("disabled"),-1!=t.inArray(i,s)&&t(this).addClass("disabled"),t.each(a,function(o){t(this).find("td").eq(e).removeClass("disabled"),-1!=t.inArray(i,s)&&t(this).find("td").eq(e).addClass("disabled")})})}t.widget("ui.faiTable",{options:{before:function(){},toolBar:[],tableColumn:{showCheckbox:!1,columns:[],hiddenKeyList:[]},bottom:{show:!1,showTotal:!1,showAllTotal:!1,showExtTotal:!1,showPage:!1},ajax:{type:"post",url:"",data:""},primaryKey:"_index",dataList:[],noDataMsg:"没有数据",tableRowsClass:{},sortData:{sortable:!1,showSortBtn:!1,showColumnKey:"_sort",unSortList:[],sortBack:function(){}},page:{startPage:1,showCount:0,pageClass:{isDefaultPage:!1,pageStyle:"",pagePrevClass:"",pageNextClass:""}},itemHover:!1,tmp:{result:[],maxPage:0,newAddDataList:[],rmDataList:[],editDataList:[],maxPrimaryKey:0,searchMatcher:[]},after:function(){},expand:!1,expandCookie:"",expandMinWidth:5,sortCallback:null,customClassStyle:"",toolBarPosition:"top"},_create:function(){var i=this.options,o=this.element;i.before&&i.before();var a=[];i.customClassStyle?a.push("<div class="+i.customClassStyle+">"):a.push('<div class="faiTableWrap">'),"top"==i.toolBarPosition&&i.toolBar.length>0&&(a.push('<div class="top">'),t.each(i.toolBar,function(t,e){if(e.show){var i="";void 0!==e.extClass&&(i+=e.extClass);var o="";void 0!==e.content&&(o+=e.content),a.push('<div class="toolBar '+i+'">'+o+"</div>")}}),a.push("</div>")),a.push('<div class="center">'),a.push('<table class="faiTable" cellpadding="0" cellspacing="0">'),a.push("<thead>"),a.push("<tr>"),i.tableColumn.showCheckbox&&a.push('<th class="checkBoxWidth textCenter sep"><label class="faiTableCheckboxLabel"><input class="checkbox all" type="checkbox"></label></th>');var s=!1,n="",r="",l=i.expand;i.tableColumn.columns.length>0?t.each(i.tableColumn.columns,function(t,e){var o=e.onsort,d=e.sortAs,c=e.expand;void 0===c&&(c=l);e.sortCallback;var h="";void 0!==e.key&&(h=' data-key="'+e.key+'"');var p="",u="";i.tableColumn.columns.length!=t+1&&(u=" sep");var f="";o&&(f=" sort pointer"),s||"asc"!=d||(s=!0,n="asc",r=e.key,o&&(f+=" asc")),s||"desc"!=d||(s=!0,n="desc",r=e.key,o&&(f+=" desc"));var m=e.colClass;i.sortData.showSortBtn&&e.key==i.sortData.showColumnKey&&(f="",m=void 0!==m?"sortWidth "+m:"sortWidth"),p=void 0!==m?' class="'+m+u+f:' class="defaultWidth'+u+f,c?(p+=' expand "',a.push("<th"+h+p+'><div class="expandRightLine-box"><div class="expandRightLine"></div></div><div class="padding title">'+e.name+"</div></th>")):(p+=' "',a.push("<th"+h+p+'><div class="padding">'+e.name+"</div></th>"))}):a.push("<th>&nbsp;</th>"),a.push("</tr>"),a.push("</thead>"),a.push("<tbody>"),a.push("</tbody>"),a.push("<tfoot></tfoot>"),a.push("</table>"),a.push("</div>"),"bottom"==i.toolBarPosition&&i.toolBar.length>0&&(a.push('<div class="top">'),t.each(i.toolBar,function(t,e){if(e.show){var i="";void 0!==e.extClass&&(i+=e.extClass);var o="";void 0!==e.content&&(o+=e.content),a.push('<div class="toolBar '+i+'">'+o+"</div>")}}),a.push("</div>")),i.bottom.show&&(a.push('<div class="bottom">'),a.push('<div class="total">'),i.bottom.showTotal&&a.push('<span class="pageTotal"></span>'),i.bottom.showAllTotal&&a.push('<span class="allTotal"></span>'),i.bottom.showExtTotal&&a.push('<span class="extTotal"></span>'),a.push("</div>"),i.bottom.showPage&&(a.push('<div class="page">'),a.push("</div>")),a.push("</div>")),a.push("</div>"),o.append(a.join("")),void 0!==i.ajax.url&&""!=i.ajax.url?(i.dataList=[],function(i,o,a,s,n){var r=[],l=i.find("div.center table:first>thead>tr>th").length;r.push('<tr class="queryIngTr">'),r.push('<td class="padding" colspan="'+l+'"><div class="ajaxLoading1 queryIng">数据加载中...</div></td>'),r.push("</tr>"),i.find("div.center table:first>tbody").html(r.join("")),t.ajax({type:o.ajax.type,data:o.ajax.data,url:o.ajax.url,error:function(){i.find("div.center table:first>tbody td").html('<td colspan="'+l+'"><div class="ajaxLoading1 queryIng">数据加载失败...</div></td>')},success:function(r){var l=t.parseJSON(t.trim(r));o.dataList=l,a&&s&&n&&o.dataList.sort(function(t,e){var i=Fai.compareObjNew(t,e,s,n);return 0==i&&"name"!=n&&(i=Fai.compareObjNew(t,e,"asc","name")),i}),e(i,o)}})}(o,i,s,n,r)):(s&&n&&r&&i.dataList.sort(function(t,e){var i=Fai.compareObjNew(t,e,n,r);return 0==i&&"name"!=r&&(i=Fai.compareObjNew(t,e,"asc","name")),i}),e(o,i)),function(i,o){i.find("div.center table:first>thead>tr>th.sort").bind("click",function(){if(t(this).hasClass("expanding"))t(this).removeClass("expanding");else{var a=t(this).attr("data-key"),s="";t(this).hasClass("desc")?(t(this).addClass("asc").removeClass("desc").siblings().removeClass("asc desc"),s="asc"):(t(this).addClass("desc").removeClass("asc").siblings().removeClass("asc desc"),s="desc"),o.dataList.sort(function(t,e){var i=Fai.compareObjNew(t,e,s,a);return 0==i&&"name"!=a&&(i=Fai.compareObjNew(t,e,"asc","name")),i}),e(i,o),o.sortCallback&&o.sortCallback()}})}(o,i),function(e,i){e.find("div.center table:first>thead>tr>th").each(function(e){if(null!=t(this).attr("data-key")){var o=parseInt(t.cookie(i.expandCookie+t(this).attr("data-key"),{path:"/"}))||0;0!=o&&t(this).css({width:o+"px"})}})}(o,i),i.after&&i.after()},sortDataList:function(e){var i=this.options,o=this.element,r=i.dataList,l=o.find("div.center table:first>tbody>tr"),d=o.find("div.center table:first>tbody");t.each(e,function(e,i){t.each(r,function(e,o){if(i===o.id){var a=o._index;return t.each(l,function(e,i){var o=parseInt(t(i).attr("_index"));if(a===o)return d.append(i),!1}),!1}})});for(var c=(l=o.find("div.center table:first>tbody>tr")).length-1;c>=0;c--){t(l[c]).find("div.checkedBtn").length>0&&d.prepend(l[c])}s(o),a(o),n(o,i)},returnDataList:function(t){var e=this.options,i=e.dataList,o=l(i,e);return t?i:o},returnRmDataList:function(){var t=this.options;return l(t.tmp.rmDataList,t)},returnChoiceDataList:function(e){var i=this,o=i.element,a=i.options,s=o.find("div.center table:first>tbody>tr>td.checkBoxWidth input[type='checkbox']:checked").parents("tr"),n=[];return s.each(function(o,s){var r=t(this).attr(a.primaryKey);n.push(i.getPrimaryKeyData(r,e))}),n},rmChoices:function(){var i=this.element,o=this.options,a=o.dataList,s=o.tmp.rmDataList,n=o.tmp.newAddDataList,r=o.tmp.result,l=o.tmp.editDataList,d=i.find("div.center table:first>tbody>tr>td.checkBoxWidth input[type='checkbox']:checked").parents("tr");return 0==d.length||(d.each(function(e,i){var d=t(this).attr(o.primaryKey);t.each(a,function(t,e){if(e[o.primaryKey]==d)return s.push(e),a.splice(t,1),!1}),t.each(n,function(t,e){if(e[o.primaryKey]==d)return n.splice(t,1),!1}),t.each(r,function(t,e){if(e[o.primaryKey]==d)return r.splice(t,1),!1}),t.each(l,function(t,e){if(e[o.primaryKey]==d)return l.splice(t,1),!1})}),e(i,o),!0)},rmChoicesList:function(e){var i=this;return t.each(e,function(t,e){i.rmPrimaryKeyData(e)}),!0},addData:function(t,i){var o=this.element,a=this.options,s=a.dataList,n=a.tmp.newAddDataList;return t[a.primaryKey]=a.tmp.maxPrimaryKey,a.tmp.maxPrimaryKey++,i?s.splice(0,0,t):s.push(t),n.push(t),e(o,a),!0},returnNewAddDataList:function(){var t=this.options;return l(t.tmp.newAddDataList,t)},hiddenColumns:function(t){var e=this.options,i=this.element;e.tableColumn.hiddenKeyList=t,d(i,e)},searchString:function(i){var o=this.options,a=this.element;o.page.startPage>1&&(o.page.startPage=1),t.each(o.tmp.searchMatcher,function(t,e){if(e.uid==i.uid)return o.tmp.searchMatcher.splice(t,1),!1}),o.tmp.searchMatcher.push(i),e(a,o)},rmSearchObj:function(i){var o=this.element,a=this.options;t.each(a.tmp.searchMatcher,function(t,e){if(e.uid==i)return a.tmp.searchMatcher.splice(t,1),!1}),e(o,a)},getPrimaryKeyId:function(e){var i=this.options,o=t(e).parents("tr").attr(i.primaryKey);return parseInt(o)},getPrimaryKeyData:function(e,i){var o=this.options,a=o.dataList,s=!1,n={};if(t.each(a,function(t,i){if(i[o.primaryKey]==e)return s=!0,n=i,!1}),s)return i?n:l(n,o)},rmPrimaryKeyData:function(i){var o=this.element,a=this.options,s=a.dataList,n=a.tmp.rmDataList,r=a.tmp.newAddDataList,l=a.tmp.result,d=a.tmp.editDataList;return t.each(s,function(t,e){if(e[a.primaryKey]==i)return n.push(e),s.splice(t,1),!1}),t.each(r,function(t,e){if(e[a.primaryKey]==i)return r.splice(t,1),!1}),t.each(l,function(t,e){if(e[a.primaryKey]==i)return l.splice(t,1),!1}),t.each(d,function(t,e){if(e[a.primaryKey]==i)return d.splice(t,1),!1}),e(o,a),!0},editData:function(i,o,a){var s=this.element,n=this.options,r=n.dataList,l=n.tmp.editDataList,d=n.tmp.newAddDataList,c=!1,h="";return t.each(r,function(e,s){if(s[n.primaryKey]==i){a?t.extend(s,o):t.extend(!0,s,o),c=!0;var r=!1;return t.each(d,function(t,e){if(e[n.primaryKey]==i)return r=!0,!1}),r||(t.each(l,function(t,e){if(e[n.primaryKey]==i)return l.splice(t,1),!1}),l.push(s)),!1}}),!!c&&(t(n.tableColumn.columns).each(function(){t(this)[0].ext&&(h=t(this)[0].key)}),""!=h&&"string"==typeof h&&n.dataList.length>i&&(n.dataList[i][h]=o[h]),e(s,n),!0)},editReplaceData:function(i,o){var a=this.element,s=this.options,n=s.dataList,r=!1,l="";return t.each(n,function(t,e){if(e[s.primaryKey]==i){for(var a in r=!0,e){var n=o[a];void 0!==n&&(e[a]=n)}return!1}}),!!r&&(t(s.tableColumn.columns).each(function(){t(this)[0].ext&&(l=t(this)[0].key)}),""!=l&&"string"==typeof l&&(s.dataList[0][l]=o[l]),e(a,s),!0)},returnEditDataList:function(){var t=this.options;return l(t.tmp.editDataList,t)},addClassToRow:function(t){},unSortListAdd:function(e){this.element;var i=this.options,o=i.sortData.unSortList;-1==t.inArray(e,o)&&i.sortData.unSortList.push(e)},unSortListRm:function(e){var i=this.options,o=i.sortData.unSortList;t.each(o,function(t,o){if(o==e)return i.sortData.unSortList.splice(t,1),!1})},editThisRowColumn:function(e,i,o,a){var s=this,n=s.options,r=s.getPrimaryKeyId(e),l=t(e).parents("tr"),d=-1;t.each(n.tableColumn.columns,function(t,e){if(e.key==i)return d=t,!0}),n.tableColumn.showCheckbox&&d++;var c=l.find("td").eq(d).find("div.tdWrap"),h=t.trim(c.text()),p=t('<input type="text" class="txtInput" maxlength="'+o+'"/>');""==h&&(h=t(".txtInput").val()),p.val(h),p.bind("blur",function(){var e=t.trim(t(this).val()),o={primaryKeyId:r,primaryKey:n.primaryKey,key:i,"old-data":h,"new-data":e};void 0!==a&&a(o);var l=o["new-data"];if(c.html(Fai.encodeHtml(l)),l!=h){var d={};d[i]=l,s.editData(r,d)}return!1}),p.bind("keypress",function(e){13==e.keyCode&&t(this).blur()}),c.html(p),setTimeout(function(){p.focus()},1)},editFileName:function(e,i,o,a){var s=this.options,n=this.getPrimaryKeyId(e),r=t(e).parents("tr"),l=-1;t.each(s.tableColumn.columns,function(t,e){if(e.key==i)return l=t,!0}),s.tableColumn.showCheckbox&&l++;var d=r.find("td").eq(l).find("div.tdWrap"),c=t.trim(d.text()),h=c.lastIndexOf("."),p=c.substring(h),u=c.substring(0,h),f=t('<input type="text" class="txtInput" maxlength="'+o+'"/>');f.val(u),f.bind("blur",function(){var e=t.trim(t(this).val()),o={primaryKeyId:n,primaryKey:s.primaryKey,key:i,"src-data":c,"type-data":p,"name-data":u,"new-data":e};if(void 0!==a)a(o);else{var r=o["new-data"];d.html(Fai.encodeHtml(r))}return!1}),f.bind("keypress",function(e){13==e.keyCode&&t(this).blur()}),d.html(f),setTimeout(function(){f.focus()},1)},returnResultDataList:function(t){var e=this.options,i=e.tmp.result,o=l(i,e);return t?i:o},refreshHiddenList:function(e){var i=this.element,o=this.options;return t.isArray(e)&&(o.tableColumn.hiddenKeyList=e),d(i,o),!0},refreshshowCountList:function(t){var i=this.options,o=this.element;t&&(i.page.showCount=t),e(o,i)},refreshShowTable:function(t){var i=this.element,o=this.options;return o.dataList=t,e(i,o),!0}})}(jQuery),function(t){var e=new Array("00","33","66","99","CC","FF"),o=new Array("FF0000","00FF00","0000FF","FFFF00","00FFFF","FF00FF");function a(a,n,r,d,c,h,p){var u=t("#"+a);"undefined"!=typeof Fai&&void 0!==Fai.top._resRoot&&Fai.top._resRoot,void 0!==c&&null!=c&&""!=c&&u.css("background",c),u.attr("title","点击选择颜色"),t("#"+a).click(function(){var a,c,f,m,v,g,b,y=t(this).offset().top,_=t(this).height(),w=t(this).offset().left;!function(a){var s;a?(Fai.top.$("body").append('<div id="colorpanel" class="colorpanel"></div>'),s=Fai.top.$("#colorpanel")):(t("body").append('<div id="colorpanel" class="colorpanel"></div>'),s=t("#colorpanel"));var n="";for(i=0;i<2;i++)for(j=0;j<6;j++)for(n+="<tr height=12>",n=0==i?n+'<td width=11 style="background-color:#'+e[j]+e[j]+e[j]+';">':n+'<td width=11 style="background-color:#'+o[j]+';">',k=0;k<3;k++)for(l=0;l<6;l++)n=n+'<td width=11 style="background-color:#'+e[k+3*i]+e[l]+e[j]+';">';var r="";"undefined"!=typeof Fai&&void 0!==Fai.top._resRoot&&Fai.top._resRoot,t.browser.msie&&/6.0/.test(navigator.userAgent)&&(r='<iframe frameborder="0" tabindex="-1" src="javascript:false" class="colorFrameBorder"/>'),n=r+'<div class="color_outsideBorder"><table width=229px border="0" cellspacing="0" cellpadding="0" style="background-color:#e8f3fe;" class="colorTableBody"><tr height=27><td colspan=21><table cellpadding="0" cellspacing="1" border="0" class="colorBorderCollapse"><tr><td width="3"><td><div class="DisColorBorder"><div id="DisColor" class="DisColor"></div><div></td><td width="3"><td id="is_Transparent"><input type="text" id="HexColor" size="7" class="HexColor" value="#000000"><a hidefocus="true" class="color_transparent" href="javascript:;" onclick="return false;" id="_cTransparent" title="透明色"></a><a hidefocus="true" class="color_sure" href="javascript:;" onclick="return false;" id="_cconfirm" title="确定"></a><a hidefocus="true" class="color_close" href="javascript:;" onclick="return false;" id="_cclose" title="关闭"></a></td></tr></table></td></table><div class="color_insideBorder"><div class="color_white"><table id="CT" border="1" cellspacing="0" cellpadding="0" class="colorBorderCollapse color_borderTableColor" bordercolor="000000">'+n+"</table></div></div></div>",s.html(n),s.mouseout(function(t){s.attr("mouseIn",0)}),s.mouseover(function(t){s.attr("mouseIn",1)}),s.focusout(function(){1!=s.attr("mouseIn")?s.remove():s.find("#HexColor").focus()})}(p),p?(a=Fai.top.$("#DisColor"),c=Fai.top.$("#HexColor"),f=Fai.top.$("#colorpanel"),m=Fai.top.$("#CT tr td"),v=Fai.top.$("#_cTransparent"),g=Fai.top.$("#_cconfirm"),b=Fai.top.$("#_cclose")):(a=t("#DisColor"),c=t("#HexColor"),f=t("#colorpanel"),m=t("#CT tr td"),v=t("#_cTransparent"),g=t("#_cconfirm"),b=t("#_cclose"));var C=u.css("background-color");a.css("background-color",C),"rgba(0, 0, 0, 0)"==C||"transparent"==C?c.val(""):(C=s(C),c.val(C));var x=y+_+r,P=w+d-4;if(p){var S=Fai.top.$(".formDialog");S.length>0&&(x+=S.offset().top+9,P+=S.offset().left+26)}f.css({top:x,left:P}),y+_+r<0&&f.css({top:"4px"}),f.show(),m.unbind("click").mouseover(function(){var e=t(this).css("background-color");e=s(e),a.css("background-color",e),c.val(e)}).click(function(){if(n){var e=t(this).css("background-color");n(s(e))}e=s(e),u.css("background",e),u.css("border","1px solid #aab3bb"),f.remove()}),void 0!==h&&1==h?(v.show(),v.mouseover(function(){a.css("background-color",""),c.val(null)}).click(function(){n&&(n("transparent"),u.css("background","transparent")),f.remove()})):v.hide(),g.click(function(){if(n){var t=c.val(),e=!1;0!=t.indexOf("#")||4!=t.length&&7!=t.length||(e=!0),""!=t&&(t=s(t)),void 0!==h&&1==h&&""==t&&(t="transparent",e=!0),e&&(n(t),u.css("background",t),u.css("border","1px solid #aab3bb")),f.remove()}}),b.click(function(){f.remove()}),f.find("#HexColor").focus(),f.attr("mouseIn",0),c.keydown(function(e){return t.browser.msie?13!=event.keyCode||(g.click(),!1):13!=e.which||(g.click(),!1)}),c.bind("cut paste",function(){setTimeout(function(){var t=c.val(),e=!1;0!=t.indexOf("#")||4!=t.length&&7!=t.length||(e=!0),void 0!==h&&1==h&&""==t&&(t="transparent",e=!0),e&&a.css("background-color",t)},10)}),c.keyup(function(){var e=t(this).val(),i=!1;0!=e.indexOf("#")||4!=e.length&&7!=e.length||(i=!0),void 0!==h&&1==h&&""==e&&(e="transparent",i=!0),i&&a.css("background-color",e)})})}function s(t){if("#"==t.charAt(0))return t;Number(t);var e=t.split(/\D+/);return"#"+function(t,e){var i=t.toString(16);for(;i.length<e;)i="0"+i;return i}(65536*Number(e[1])+256*Number(e[2])+Number(e[3]),6)}jQuery.extend({showcolor:function(t,e,i,o,s,n,r){a(t,e,i,o,s,n,r)}})}(jQuery),function(t){function e(e){e.stopPropagation();var d=e.data.$$,c=e.data.options;d(".faiColorPicker").remove();var h=c.historyCookie("colorpicker_history")?decodeURIComponent(c.historyCookie("colorpicker_history")).split(","):[],u='<div class="faiColorPicker" id="'+("faiColorPicker"+Math.floor(1e3*Math.random()))+'"><input type="text" id="faiColorPicker-hidden" /><div class="faiColorPicker-clearcolor"><div class="original-title">当前颜色:</div><div class="original-color" style="background-color:transparent;"></div><div class="original-clear" title="透明色"></div></div>';u+='<div class="faiColorPicker-colorcol">';for(var f,m=1;m<10;m++)u+='<div class="col"><div class="col-color first"><div    style="background-color:'+(f=c["col"+m])[0]+'"></div></div><div class="col-color second"><div style="background-color:'+f[1]+'"></div></div><div class="col-color"><div      style="background-color:'+f[2]+'"></div></div><div class="col-color"><div       style="background-color:'+f[3]+'"></div></div><div class="col-color"><div       style="background-color:'+f[4]+'"></div></div><div class="col-color last"><div  style="background-color:'+f[5]+'"></div></div></div>';u+="</div>",u+='<div class="faiColorPicker-colornormal"><div class="colornormal-title">标准颜色:</div><div class="colornormal-color">';for(var v,g,b=c.colnormal,y=0;y<9;y++)u+='<div class="col"><div class="col-color normal"><div style="background-color:'+b[y]+'"></div></div></div>';u+="</div></div>",u+='<div class="faiColorPicker-colorhistory"><div class="colorhistory-title">最近使用:</div><div class="colorhistory-color">';y=0;for(var _=h.length;y<_;y++)u+='<div class="col"><div class="col-color history"><div style="background-color:'+h[y]+';"></div></div></div>';if(u+="</div></div>",c.advance&&d("body").ColorPicker&&(u+='<div class="faiColorPicker-coloradvance"><a class="coloradvance-btn" href="javascript:;">更多颜色</a></div>'),u+="</div>",d("body").append(u),d(".faiColorPicker-colorcol>.col").last().addClass("col-last"),d(".faiColorPicker-colornormal>.colornormal-color>.col").last().addClass("col-last"),d(".faiColorPicker-colorhistory>.colorhistory-color>.col").last().addClass("col-last"),c.showInTop)if(d(".formDialog").offset()){var w=d(".formDialog:last").offset();g=c.left+w.left+c.base.offset().left+c.base.width()/2,v=c.top+w.top+c.base.offset().top+c.base.height()/2+27}else g=c.left+c.base.offset().left+c.base.width()/2,v=c.top+c.base.offset().top+c.base.height()/2;else g=c.left+c.base.offset().left+c.base.width()/2,v=c.top+c.base.offset().top+c.base.height()/2,t(window).height()-v<272&&(v-=272),t(window).width()-g<206&&(g-=206);d(".faiColorPicker").css({left:g,top:v,"z-index":9999}).show(),d(".faiColorPicker").click(function(t){t.stopPropagation()}),d(".faiColorPicker").find("#faiColorPicker-hidden").focus(),function(e){var d=e.$$,c=d(".original-color"),h=e.target.css(e.targetattr);p(h)&&c.addClass("original-transparentIco");if(c.css("background-color",h),d(".col-color").unbind("click",i).bind("click",{$$:d,elm:e.target,targetattr:e.targetattr,onchange:e.onchange,onclick:e.onclick},i),d(".col-color").unbind("mouseenter",s).bind("mouseenter",{$$:d,elm:e.target,targetattr:e.targetattr,onmousein:e.onmousein,onchange:e.onchange},s).unbind("mouseleave",n).bind("mouseleave",{$$:d,elm:e.target,targetattr:e.targetattr,onchange:e.onchange},n),d(".faiColorPicker").unbind("mouseleave",n).bind("mouseleave",{$$:d,elm:e.target,targetattr:e.targetattr,onchange:e.onchange},n),d(".original-clear").unbind("click",o).bind("click",{$$:d,elm:e.target,targetattr:e.targetattr,onchange:e.onchange,onreset:e.onreset,onclick:e.onclick},o),d(".original-clear").unbind("mouseenter",a).bind("mouseenter",{$$:d,elm:e.target,targetattr:e.targetattr,onchange:e.onchange,onreset:e.onreset},a),d(".coloradvance-btn").unbind("click",l).bind("click",{$$:d,elm:e.target,targetattr:e.targetattr,base:e.base,baseattr:e.baseattr,onchange:e.onchange,mobiFrame:e.mobiFrame},l),d("body").unbind("click",r).bind("click",{$$:d,elm:e.target,targetattr:e.targetattr,onchange:e.onchange},r),e.showInTop){t("body").unbind("click",r).bind("click",{$$:d,elm:e.target,targetattr:e.targetattr,onchange:e.onchange},r);var u=d(".faiColorPicker");u.mouseout(function(){u.attr("mouseIn",0)}).mouseover(function(){u.attr("mouseIn",1)}).focusout(function(){1!=u.attr("mouseIn")?u.remove():u.find("#faiColorPicker-hidden").focus()})}}(c)}function i(t){t.stopPropagation();var e=t.data.$$,i=e(this).find("div").css("background-color");h(i=d(i)),t.data.elm.css(t.data.targetattr,i).removeClass("faiColorPicker-transparentIco"),e(".original-color").css("background-color",i),e(".faiColorPicker").remove(),t.data.onchange.apply(t.data.elm,[i,c(i)]),t.data.onclick.apply(t.data.elm,[i,c(i)])}function o(t){t.stopPropagation();var e=t.data.$$;t.data.elm.css(t.data.targetattr,"transparent").addClass("faiColorPicker-transparentIco"),e(".original-color").css("background-color","transparent").addClass("original-transparentIco"),e(".faiColorPicker").remove(),t.data.onchange.apply(t.data.elm,["transparent","transparent"]),t.data.onclick.apply(t.data.elm,["transparent","transparent"]),t.data.onreset.apply(t.data.elm,[this])}function a(t){(0,t.data.$$)(".original-color").css("background-color","transparent").addClass("original-transparentIco"),t.data.onchange.apply(t.data.elm,["transparent","transparent"]),t.data.onreset.apply(t.data.elm,[this])}function s(e){var i=e.data.$$,o=t(this).find("div").css("background-color");o=d(o),i(".original-color").css("background-color",o).removeClass("original-transparentIco"),e.data.onmousein.apply(e.data.elm,[o,c(o)]),e.data.onchange.apply(e.data.elm,[o,c(o)])}function n(t){var e=t.data.elm.css(t.data.targetattr),i=(0,t.data.$$)(".original-color");e&&(t.data.onchange.apply(t.data.elm,[e,c(e)]),i.css("background-color",e).removeClass("original-transparentIco"),p(e)&&i.addClass("original-transparentIco"))}function r(t){var e=t.data.$$;if(e(".faiColorPicker").length>0){var i=t.data.elm.css(t.data.targetattr);i&&t.data.onchange.apply(t.data.elm,[i,c(i)])}e(".faiColorPicker").remove()}function l(t){t.stopPropagation();var e=t.data.$$,i=t.data.mobiFrame?Fai.top.$:t.data.$$,o=t.data.elm.css(t.data.targetattr);o&&t.data.onchange.apply(t.data.elm,[o,c(o)]),e(".faiColorPicker").remove();var a=Fai.popupWindow({title:"高级颜色选项",width:470,height:260,divId:"AdvanceFaiColorPicker",divContent:'<div class="AdvanceColorPicker"><script type="text/javascript">$(".AdvanceColorPicker").ColorPicker({flat: true , color:"'+d(t.data.elm.css(t.data.targetattr))+'"});<\/script></div>'});return i("#popupWindow"+a).find(".colorpicker_cancel").unbind("click").bind("click",function(){Fai.closePopupWindow(a)}),i("#popupWindow"+a).find(".colorpicker_submit").unbind("click").bind("click",{base:t.data.base,baseattr:t.data.baseattr,elm:t.data.elm,onchange:t.data.onchange},function(e){var o="#"+i(".colorpicker_hex>input").val();e.data.elm.removeClass("faiColorPicker-transparentIco"),e.data.elm.css(t.data.targetattr,o),e.data.base.css(e.data.baseattr,o),e.data.onchange.apply(e.data.elm,[o,c(o)]),h(o),Fai.closePopupWindow(a)}),!1}function d(t){if(/#/g.test(t))return t;t=t.replace(/[rgba\(\)]/g,"").split(",");for(var e,i=["#"],o=0;o<3;o++)1===(e=parseInt(t[o]).toString(16)).length&&(e="0"+e),i.push(e);return i.join("")}function c(t){return/rgb/gi.test(t)?t:["rgb(",(t=parseInt(t.substring(1),16))>>16,",",(65280&t)>>8,",",255&t,")"].join("")}function h(t){var e=Fai.top.$.cookie("colorpicker_history"),i=e?decodeURIComponent(e).split(","):[],o=i.join();new RegExp(t,"gi").test(o)||(i.length>8?(i.pop(),i.unshift(t),Fai.top.$.cookie("colorpicker_history",encodeURIComponent(i))):(i.unshift(t),Fai.top.$.cookie("colorpicker_history",encodeURIComponent(i))))}function p(t){return!!(t&&"rgba(0,0,0,0)"==t.replace(/\s/g,"")||"transparent"==t)}t.fn.faiColorPicker=function(i){var o={base:this,target:this,baseattr:"background-color",targetattr:"background-color",defaultcolor:null,col1:["#ffffff","#dbdbdb","#9b9b9b","#4d4d4d","#161616","#000000"],col2:["#cbdeff","#69a1ff","#0f67ff","#0042b3","#01296e","#001e4d"],col3:["#c0b6ff","#6b55ff","#1f00fc","#1200a0","#0a015e","#08004b"],col4:["#d7b5ff","#9f56ff","#7000fc","#4800a0","#2b005c","#210049"],col5:["#f0bfdd","#e16cb3","#dd158f","#9c0061","#570035","#410028"],col6:["#ffcfc1","#ff835f","#ff3e07","#ac0000","#661500","#501100"],col7:["#ffe9c4","#ffc265","#ff9d0b","#b06900","#683f00","#4f2f00"],col8:["#fff6d5","#fee370","#ffd119","#bb9600","#765d00","#594601"],col9:["#e2efc3","#c0e073","#a4db1d","#719f00","#405a00","#314500"],colnormal:["#c00000","#ff0000","#ffc000","#ffff00","#94d152","#00af50","#01b0f1","#0172c2","#012060"],historyCookie:Fai.top.$.cookie,advance:!0,showInTop:!1,mobiFrame:!1,onreset:t.noop,onchange:t.noop,onclick:t.noop,onmousein:t.noop,id:this.selector,top:0,left:0};(i=t.extend({},o,i)).defaultcolor&&i.baseattr&&(i.base.css(i.baseattr,i.defaultcolor),p(i.defaultcolor)&&i.target.addClass("faiColorPicker-transparentIco")),i.showInTop?i.$$=Fai.top.$:i.$$=t,i.base.bind("click",{options:i,$$:i.$$},e)}}(jQuery),function(t){var e,i,o,a,s,n,r,l,d,c,h,p,u,f,m,v,g,b,y,_,w,C,k,x,P,S,F,I,D,T,E,N,M,L,$,A,O,B,j,z,H,R=(e=65,i=['<div class="colorpicker">','<div class="colorpicker_color">',"<div>","<div></div>","</div>","</div>",'<div class="colorpicker_hue">',"<div></div>","</div>",'<div class="colorpicker_new_color_title">新增</div>','<div class="colorpicker_current_color_title">当前</div>','<div class="colorpicker_new_color"></div>','<div class="colorpicker_current_color"></div>','<div class="colorpicker_hex">','<span> #</span><input type="text" maxlength="6" size="6" />',"</div>",'<div class="colorpicker_rgb_r colorpicker_field">','<i class="colorpicker_field_title">红(R):</i> ','<input type="text" maxlength="3" size="3" class="numeric" />','<span><i class="colorpicker_rgbnum_add"></i><i class="colorpicker_rgbnum_reduce"></i></span>',"</div>",'<div class="colorpicker_rgb_g colorpicker_field">','<i class="colorpicker_field_title">绿(G):</i>','<input type="text" maxlength="3" size="3" class="numeric" />','<span><i class="colorpicker_rgbnum_add"></i><i class="colorpicker_rgbnum_reduce"></i></span>',"</div>",'<div class="colorpicker_rgb_b colorpicker_field">','<i class="colorpicker_field_title">蓝(B):</i>','<input type="text" maxlength="3" size="3" class="numeric" />','<span><i class="colorpicker_rgbnum_add"></i><i class="colorpicker_rgbnum_reduce"></i></span>',"</div>",'<div class="colorpicker_hsb_h colorpicker_field">','<i class="colorpicker_field_title">色相(H):</i>','<input type="text" maxlength="3" size="3" class="numeric"/>','<span><i class="colorpicker_hsbnum_add"></i><i class="colorpicker_hsbnum_reduce"></i></span>',"</div>",'<div class="colorpicker_hsb_s colorpicker_field">','<i class="colorpicker_field_title">饱和度(S):</i>','<input type="text" maxlength="3" size="3" class="numeric"/>','<span><i class="colorpicker_hsbnum_add"></i><i class="colorpicker_hsbnum_reduce"></i></span>',"</div>",'<div class="colorpicker_hsb_b colorpicker_field">','<i class="colorpicker_field_title">亮度(B):</i>','<input type="text" maxlength="3" size="3" class="numeric"/>','<span><i class="colorpicker_hsbnum_add"></i><i class="colorpicker_hsbnum_reduce"></i></span>',"</div>",'<div class="colorpicker_submit abutton faiButton saveButton">确定</div>','<div class="colorpicker_cancel abutton faiButton cancelButton ">取消</div>',"</div>"].join(""),o={eventName:"click",onShow:t.noop,onBeforeShow:t.noop,onHide:t.noop,color:"ff0000",livePreview:!0,flat:!1},a=function(e,i){var o=j(e);t(i).data("colorpicker").fields.eq(1).val(o.r).end().eq(2).val(o.g).end().eq(3).val(o.b).end()},s=function(e,i){t(i).data("colorpicker").fields.eq(4).val(e.h.toFixed(0)).end().eq(5).val(e.s.toFixed(0)).end().eq(6).val(e.b.toFixed(0)).end()},n=function(e,i){t(i).data("colorpicker").fields.eq(0).val(z(e)).end()},r=function(e,i){t(i).data("colorpicker").selector.css("backgroundColor","#"+z({h:e.h,s:100,b:100})),t(i).data("colorpicker").selectorIndic.css({left:parseInt(150*e.s/100,10),top:parseInt(150*(100-e.b)/100,10)})},l=function(e,i){t(i).data("colorpicker").hue.css("top",parseInt(150-150*e.h/360,10))},d=function(e,i){t(i).data("colorpicker").currentColor.css("backgroundColor","#"+z(e))},c=function(e,i){t(i).data("colorpicker").newColor.css("backgroundColor","#"+z(e))},h=function(i){var o=i.charCode||i.keyCode||-1;if(o>e&&o<=90||32==o)return!1;!0===t(this).parent().parent().data("colorpicker").livePreview&&p.apply(this)},p=function(e){var i,o=t(this).parent().parent();this.parentNode.className.indexOf("_hex")>0?o.data("colorpicker").color=i=O(A(this.value)):this.parentNode.className.indexOf("_hsb")>0?o.data("colorpicker").color=i=L({h:o.data("colorpicker").fields.eq(4).val(),s:o.data("colorpicker").fields.eq(5).val(),b:o.data("colorpicker").fields.eq(6).val()}):o.data("colorpicker").color=i=B($({r:o.data("colorpicker").fields.eq(1).val(),g:o.data("colorpicker").fields.eq(2).val(),b:o.data("colorpicker").fields.eq(3).val()})),e&&(a(i,o.get(0)),n(i,o.get(0)),s(i,o.get(0))),r(i,o.get(0)),l(i,o.get(0)),c(i,o.get(0))},u=function(e){var i=t(this).parent().parent(),o=o=i.data("colorpicker").color;i.data("colorpicker").fields.parent().removeClass("colorpicker_focus"),a(o,i.get(0)),s(o,i.get(0)),n(o,i.get(0)),l(o,i.get(0)),r(o,i.get(0)),c(o,i.get(0))},f=function(){e=this.parentNode.className.indexOf("_hex")>0?70:65,t(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus"),t(this).parent().addClass("colorpicker_focus")},m=function(e){e.stopPropagation();var i=t(this).parent().parent().find("input").focus();i.val(parseInt(i.val())+3),p.apply(t(this).parent().get(0),[!0])},v=function(e){e.stopPropagation();var i=t(this).parent().parent().find("input").focus();i.val(parseInt(i.val())-3),p.apply(t(this).parent().get(0),[!0])},g=function(e){e.stopPropagation();var i=t(this).parent().parent().find("input").focus();i.val(parseInt(i.val())+1),p.apply(t(this).parent().get(0),[!0])},b=function(e){e.stopPropagation();var i=t(this).parent().parent().find("input").focus();i.val(parseInt(i.val())-1),p.apply(t(this).parent().get(0),[!0])},y=function(e){e.stopPropagation();var i={cal:t(this).parent(),y:t(this).offset().top};i.preview=i.cal.data("colorpicker").livePreview,p.apply(i.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,e.pageY-i.y)))/150,10)).get(0),[!0]),t(document).bind("mouseup",i,w),t(document).bind("mousemove",i,_)},_=function(t){return p.apply(t.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,t.pageY-t.data.y)))/150,10)).get(0),[t.data.preview]),!1},w=function e(i){return a(i.data.cal.data("colorpicker").color,i.data.cal.get(0)),n(i.data.cal.data("colorpicker").color,i.data.cal.get(0)),t(document).unbind("mouseup",e),t(document).unbind("mousemove",_),!1},C=function(e){e.stopPropagation();var i={cal:t(this).parent(),pos:t(this).offset()};i.preview=i.cal.data("colorpicker").livePreview,p.apply(i.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,e.pageY-i.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,e.pageX-i.pos.left))/150,10)).get(0),[!0]),t(document).bind("mouseup",i,x),t(document).bind("mousemove",i,k)},k=function(t){return p.apply(t.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,t.pageY-t.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,t.pageX-t.data.pos.left))/150,10)).get(0),[t.data.preview]),!1},x=function e(i){return a(i.data.cal.data("colorpicker").color,i.data.cal.get(0)),n(i.data.cal.data("colorpicker").color,i.data.cal.get(0)),t(document).unbind("mouseup",e),t(document).unbind("mousemove",k),!1},P=function(e){t(this).addClass("saveButton-hover")},S=function(e){t(this).removeClass("saveButton-hover")},F=function(e){var i=t(this).parent(),o=i.data("colorpicker").color;i.data("colorpicker").origColor=o,d(o,i.get(0))},I=function(e){t(this).addClass("cancelButton-hover")},D=function(e){t(this).removeClass("cancelButton-hover")},T=function(e){var i=t("#"+t(this).data("colorpickerId"));i.data("colorpicker").onBeforeShow.apply(this,[i.get(0)]);var o=t(this).offset(),a=M(),s=o.top+this.offsetHeight,n=o.left;return s+176>a.t+a.h&&(s-=this.offsetHeight+176),n+356>a.l+a.w&&(n-=356),i.css({left:n+"px",top:s+"px"}),0!=i.data("colorpicker").onShow.apply(this,[i.get(0)])&&i.show(),t(document).bind("mousedown",{cal:i},E),!1},E=function e(i){N(i.data.cal.get(0),i.target,i.data.cal.get(0))||(0!=i.data.cal.data("colorpicker").onHide.apply(this,[i.data.cal.get(0)])&&i.data.cal.hide(),t(document).unbind("mousedown",e))},N=function(t,e,i){if(t==e)return!0;if(t.contains)return t.contains(e);if(t.compareDocumentPosition)return!!(16&t.compareDocumentPosition(e));for(var o=e.parentNode;o&&o!=i;){if(o==t)return!0;o=o.parentNode}return!1},M=function(){var t="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(t?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(t?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(t?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(t?document.documentElement.clientHeight:document.body.clientHeight)}},L=function(t){return{h:Math.min(360,Math.max(0,t.h)),s:Math.min(100,Math.max(0,t.s)),b:Math.min(100,Math.max(0,t.b))}},$=function(t){return{r:Math.min(255,Math.max(0,t.r)),g:Math.min(255,Math.max(0,t.g)),b:Math.min(255,Math.max(0,t.b))}},A=function(t){var e=6-t.length;if(e>0){for(var i=[],o=e;o--;)i.push("0");i.push(t),t=i.join("")}return t},O=function(t){return B(function(t){return{r:(t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16))>>16,g:(65280&t)>>8,b:255&t}}(t))},B=function(t){var e={h:0,s:0,b:0},i=Math.min(t.r,t.g,t.b),o=Math.max(t.r,t.g,t.b),a=o-i;return e.b=o,e.s=0!=o?255*a/o:0,0!=e.s?t.r==o?e.h=(t.g-t.b)/a:t.g==o?e.h=2+(t.b-t.r)/a:e.h=4+(t.r-t.g)/a:e.h=-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.b*=100/255,{h:parseFloat(e.h,2),s:e.s,b:e.b}},j=function(t){var e={},i=Math.round(t.h),o=Math.round(255*t.s/100),a=Math.round(255*t.b/100);if(0==o)e.r=e.g=e.b=a;else{var s=a,n=(255-o)*a/255,r=i%60*(s-n)/60;360==i&&(i=0),i<60?(e.r=s,e.b=n,e.g=n+r):i<120?(e.g=s,e.b=n,e.r=s-r):i<180?(e.g=s,e.r=n,e.b=n+r):i<240?(e.b=s,e.r=n,e.g=s-r):i<300?(e.b=s,e.g=n,e.r=n+r):i<360?(e.r=s,e.g=n,e.b=s-r):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}},z=function(e){return i=j(e),o=[i.r.toString(16),i.g.toString(16),i.b.toString(16)],t.each(o,function(t,e){1==e.length&&(o[t]="0"+e)}),o.join("");var i,o},H=function(){var e=t(this).parent(),i=e.data("colorpicker").origColor;e.data("colorpicker").color=i,a(i,e.get(0)),n(i,e.get(0)),s(i,e.get(0)),r(i,e.get(0)),l(i,e.get(0)),c(i,e.get(0))},{init:function(e){if("string"==typeof(e=t.extend({},o,e||{})).color)e.color=O(e.color);else if(null!=e.color.r&&null!=e.color.g&&null!=e.color.b)e.color=B(e.color);else{if(null==e.color.h||null==e.color.s||null==e.color.b)return this;e.color=L(e.color)}return this.each(function(){if(!t(this).data("colorpickerId")){var o=t.extend({},e);o.origColor=e.color;var _="colorpicker_"+parseInt(1e3*Math.random());t(this).data("colorpickerId",_);var w=t(i).attr("id",_);o.flat?w.appendTo(this).show():w.appendTo(document.body),o.fields=w.find("input").bind("keyup",h).bind("change",p).bind("blur",u).bind("focus",f),o=t.extend({},o,{el:this,selector:w.find("div.colorpicker_color").bind("mousedown",C),selectorIndic:w.find("div.colorpicker_color").find("div div"),hue:w.find("div.colorpicker_hue div"),newColor:w.find("div.colorpicker_new_color"),currentColor:w.find("div.colorpicker_current_color")}),w.find("div.colorpicker_hue").bind("mousedown",y),w.find("i.colorpicker_hsbnum_add").bind("click",g),w.find("i.colorpicker_hsbnum_reduce").bind("click",b),w.find("i.colorpicker_rgbnum_add").bind("click",m),w.find("i.colorpicker_rgbnum_reduce").bind("click",v),w.find(">div.colorpicker_current_color").bind("click",H),w.data("colorpicker",o),w.find(".numeric").numeric({negative:!1}),w.find("div.colorpicker_submit").bind("mouseenter",P).bind("mouseleave",S).bind("click",F),w.find("div.colorpicker_cancel").bind("mouseenter",I).bind("mouseleave",D),a(o.color,w.get(0)),s(o.color,w.get(0)),n(o.color,w.get(0)),l(o.color,w.get(0)),r(o.color,w.get(0)),d(o.color,w.get(0)),c(o.color,w.get(0)),o.flat?w.css({position:"relative",display:"block"}):t(this).bind(o.eventName,T)}})},showPicker:function(){return this.each(function(){t(this).data("colorpickerId")&&T.apply(this)})},hidePicker:function(){return this.each(function(){t(this).data("colorpickerId")&&t("#"+t(this).data("colorpickerId")).hide()})},setColor:function(e){if("string"==typeof e)e=O(e);else if(null!=e.r&&null!=e.g&&null!=e.b)e=B(e);else{if(null==e.h||null==e.s||null==e.b)return this;e=L(e)}return this.each(function(){if(t(this).data("colorpickerId")){var i=t("#"+t(this).data("colorpickerId"));i.data("colorpicker").color=e,i.data("colorpicker").origColor=e,a(e,i.get(0)),s(e,i.get(0)),n(e,i.get(0)),l(e,i.get(0)),r(e,i.get(0)),d(e,i.get(0)),c(e,i.get(0))}})}});t.fn.extend({ColorPicker:R.init,ColorPickerHide:R.hidePicker,ColorPickerShow:R.showPicker,ColorPickerSetColor:R.setColor})}(jQuery),function(t){t.fn.initSlider=function(e){if(this){var i={initStartIndex:100,initStart:0,endStart:100,unit:"%",refreshFn:null,saveValueFn:null,styleChangeFn:null};t.extend(i,e);0===t(this).find(".slider_outside").length?t(this).append('<div class="slider_outside"><div class="slider_stay"><div class="slider_move" style="position:absolute;"></div></div><div class="slider_value">100%</div></div>'):n(i.refreshFn)&&i.refreshFn(i.initStartIndex);var o=parseInt(t(".slider_stay").width())-parseInt(t(".slider_move").width()),a=!1,s=o/(i.endStart-i.initStart);t(".slider_value").text(i.initStartIndex+i.unit),i.initStartIndex===i.initStart?t(".slider_move").css("left","0px"):i.initStartIndex===i.endStart?t(".slider_move").css("left",o+"px"):t(".slider_move").css("left",(i.initStartIndex-i.initStart)*s+"px"),t(".slider_move").draggable({handler:".slider_move",axis:"x",containment:"parent",stop:function(){},drag:function(){var e=parseInt(this.style.left),o=Math.ceil(e/s)+i.initStart;o<i.initStart&&(o=i.initStart),o>i.endStart&&(o=i.endStart),t(".slider_value").text(o+i.unit),n(i.refreshFn)&&i.refreshFn(o),!a&&n(i.styleChangeFn)&&(i.styleChangeFn(),a=!0),n(i.saveValueFn)&&i.saveValueFn(o)}})}function n(t){return"[object Function]"===Object.prototype.toString.call(t)}}}(jQuery),function(t){var e=[{first:"SimSun",second:"宋体"},{first:"PMingLiU",second:"新细明体"},{first:"FangSong_GB2312",second:"仿宋_GB2312"},{first:"微软雅黑",second:"微软雅黑"},{first:"隶书",second:"隶书"},{first:"幼圆",second:"幼圆"},{first:"STKaiti",second:"华文楷体"},{first:"方正舒体",second:"方正舒体"},{first:"华文彩云",second:"华文彩云"},{first:"华文行楷",second:"华文行楷"},{first:"华文宋体",second:"华文宋体"},{first:"Arial",second:"Arial"},{first:"Tahoma",second:"Tahoma"},{first:"impact",second:"impact"},{first:"Arial Serif",second:"Arial Serif"},{first:"Georgia",second:"Georgia"},{first:"Garamond",second:"Garamond"},{first:"Times New Roman",second:"Times New Roman"}];function i(t){return"[object Function]"===Object.prototype.toString.call(t)}t.fn.fontFamilySelect=function(o){var a={type:0,defaultValue:"SimSun",defaultValueIndex:0,refreshFn:null,styleChangeFn:null,fontfamily:null};t.extend(a,o),a.fontfamily=a.fontfamily||e;var s,n=['<div id="f_family_select',a.type,'" class="f_family_select">','<div class="f_family_body"></div>','<div class="f_family_button"></div>',"</div>"];if(n=n.join(""),0===t("#f_family_select"+a.type).length){t(this).append(n),n=t("#f_family_select"+a.type),s=['<div id="f_family_menu',a.type,'" class="f_family_menu" style="display:none;">','<div id="f_family_content" class="f_family_content">'];var r="";t.each(a.fontfamily,function(t,e){e.first===a.defaultValue&&(a.defaultValueIndex=t,r=" f_selected"),s.push("<div class='f_family_option"+r+"' style='font-family:"+e.first+"' _value='"+e.first+"' title='"+e.second+"'>"+e.second+"</div>"),r=""}),s.push("</div></div>"),s=s.join(""),0===t("body").find("#f_family_menu"+a.type).length&&t("body").append(s)}else n=t("#f_family_select"+a.type),i(a.refreshFn)&&a.refreshFn(a.defaultValue),n.find(".f_family_button").removeClass("f_b_selected"),t("#f_family_menu"+a.type).hide(),t("#f_family_menu"+a.type).find(".f_selected").removeClass("f_selected");s=t("#f_family_menu"+a.type),f_family_button=n.find(".f_family_button"),n.find(".f_family_body").html(a.fontfamily[a.defaultValueIndex].second),n.find(".f_family_body").attr("title",a.fontfamily[a.defaultValueIndex].second),f_family_button.mousemove(function(){t(this).addClass("f_b_hover")}).mouseleave(function(){t(this).removeClass("f_b_hover")}),n.unbind("click").bind("click",function(){if(!s.attr("_isPos")){var e=n.offset();s.offset({top:e.top+21,left:e.left}),s.attr("_isPos",1)}var i=t(this).find(".f_family_button");i.hasClass("f_b_selected")?(s.hide(),i.removeClass("f_b_selected")):(s.show(),i.addClass("f_b_selected"))}),t(document).bind("click",function(e){0==t(e.target).closest(".f_family_body, .f_family_button").length&&(s.hide(),n.find(".f_family_button").removeClass("f_b_selected")),e.stopPropagation()});var l=t(".ui-tabs").find(".ui-state-default a");l.length>0&&l.on("click",function(){s.hide(),n.find(".f_family_button").removeClass("f_b_selected")});var d=s.find(".f_family_content").children();t(d).mousemove(function(){t(this).addClass("f_hover")}).mouseleave(function(){t(this).removeClass("f_hover")}).click(function(){n.find(".f_family_body").html(t(this).html()),n.find(".f_family_body").attr("title",t(this).html()),s.find(".f_selected").removeClass("f_selected"),t(this).addClass("f_selected"),i(a.refreshFn)&&a.refreshFn(t(this).attr("_value")),i(a.styleChangeFn)&&a.styleChangeFn()})},t.fn.fontSzieSlider=function(e){var o={type:0,initStartIndex:12,initStart:12,endStart:60,space:1,refreshFn:null,styleChangeFn:null,needInput:!1,sliderEnd:60};t.extend(o,e);var a=[];o.needInput?(a.push('<div id="f_size_select'+o.type+'" class="f_size_select f_size_select_input" >'),a.push('<input type="text" maxlength="3" class="f_size_body f_size_body_input"/>'),a.push('<div class="f_size_button f_size_button_input"></div>')):(a.push('<div id="f_size_select'+o.type+'" class="f_size_select">'),a.push('<div class="f_size_body"></div>'),a.push('<div class="f_size_button"></div>')),a.push("</div>"),a=a.join(""),0===t(this).find("#f_size_select"+o.type).length?t(this).append(a):(i(o.refreshFn)&&o.refreshFn(o.initStartIndex),t("#f_size_menu"+o.type).hide(),t("#f_size_select"+o.type).find(".f_size_button").removeClass("f_b_selected")),a=t("#f_size_select"+o.type);var s,n=['<div id="f_size_menu',o.type,'" class="f_size_menu" style="display:none;" >','<div class="f_slider_stay">','<div class="f_slider_strip"></div>','<div class="f_slider_move"></div>',"</div>","</div>"];n=n.join(""),0===t("body").find("#f_size_menu"+o.type).length&&t("body").append(n),n=t("#f_size_menu"+o.type),s=a.find(".f_size_body"),o.needInput?s.val(o.initStartIndex):s.html(o.initStartIndex+"px"),a.find(".f_size_button").mousemove(function(){t(this).addClass("f_b_hover")}).mouseleave(function(){t(this).removeClass("f_b_hover")}),a.unbind("click").bind("click",function(){if(!n.attr("_isPos")){var t=a.offset();n.offset({top:t.top+22,left:t.left}),n.attr("_isPos",1)}var e=a.find(".f_size_button");e.hasClass("f_b_selected")?(n.hide(),e.removeClass("f_b_selected")):(n.show(),e.addClass("f_b_selected"))}),t(document).bind("click",function(e){0==t(e.target).closest(".f_size_body, .f_size_button, #f_size_menu"+o.type).length&&(n.hide(),a.find(".f_size_button").removeClass("f_b_selected")),e.stopPropagation()});var r=t(".ui-tabs").find(".ui-state-default a");r.length>0&&r.on("click",function(){n.hide(),a.find(".f_size_button").removeClass("f_b_selected")});var l=parseInt(n.find(".f_slider_stay").height())-parseInt(n.find(".f_slider_move").height()),d=Math.floor(l/(o.endStart-o.initStart)*10)/10,c=n.find(".f_slider_move");o.initStartIndex<o.sliderEnd+1?c.text(o.initStartIndex+"px"):c.text(o.sliderEnd+"px"),o.initStartIndex===o.initStart?c.css("top","0px"):o.initStartIndex>=o.endStart?c.css("top",l+"px"):c.css("top",(o.initStartIndex-o.initStart)*d+"px"),n.find(".f_slider_strip").click(function(e){var a=c.height()/2,n=Math.ceil((e.offsetY-a)/d)+o.initStart,r=t(this).height();e.offsetY>r-a?c.css("top",r-a+"px"):e.offsetY<a?c.css("top","auto"):c.css("top",e.offsetY-a+"px"),n<o.initStart&&(n=o.initStart),n>o.endStart&&(n=o.endStart),n%o.space&&(n+=1),c.text(n+"px"),o.needInput?s.val(n):s.html(n+"px"),i(o.refreshFn)&&o.refreshFn(n),i(o.styleChangeFn)&&o.styleChangeFn()}),c.draggable({handler:".f_slider_move",axis:"y",containment:"parent",drag:function(){var e=parseInt(this.style.top),a=Math.floor(e/d)+o.initStart;a<o.initStart&&(a=o.initStart),a>o.endStart&&(a=o.endStart),a%o.space||(t(this).text(a+"px"),o.needInput?s.val(a):s.html(a+"px"),i(o.refreshFn)&&o.refreshFn(a),i(o.styleChangeFn)&&o.styleChangeFn())}}),o.needInput&&(s.off("keyup.fontsize").on("keyup.fontsize",function(e){var a=t(this).val(),s=a;t.isNumeric(a)&&a>11&&a<1e3&&(a<o.sliderEnd+1?c.css("top",(1*a-1*o.initStart)*d+"px"):(c.css("top",(o.sliderEnd-1*o.initStart)*d+"px"),s=o.sliderEnd),a>11&&(a>o.sliderEnd?n.hide():n.show()),c.text(s+"px"),i(o.refreshFn)&&o.refreshFn(a),i(o.styleChangeFn)&&o.styleChangeFn())}),s.off("keypress.fontsize").on("keypress.fontsize",function(t){return Fai.isNumberKey(t)}),s.off("focusout.fontsize").on("focusout.fontsize",function(e){var i=t(this).val();t.isNumeric(i)?(i<12||i>999)&&(Fai.ing("字号范围在12-999之间",!0),i<12?t(this).val(12):t(this).val(999),t(this).trigger("keyup")):(Fai.ing("字号范围在12-999之间",!0),t(this).val(12),t(this).trigger("keyup"))}))},t.fn.fontStyleEditor=function(e){var o={id:0,toolbars:[{name:"fontfamily",defaultValue:"",refreshFn:null},{name:"fontsize",defaultValue:12,refreshFn:null},{name:"bold",defaultValue:0,refreshFn:null},{name:"italic",defaultValue:0,refreshFn:null},{name:"underline",defaultValue:0,refreshFn:null},{name:"fontcolor",defaultValue:"",refreshFn:null,removeCssFn:null}],styleChangeFn:null,fontfamily:null};t.extend(o,e);var a='<div id="f_editor'+o.id+'" class="f_editor"></div>';0===t("#f_editor"+o.id).length&&t(this).append(a),a=t("#f_editor"+o.id);t.each(o.toolbars,function(e,s){switch(s.name){case"fontfamily":a.fontFamilySelect({type:o.id,defaultValue:s.defaultValue,defaultValueIndex:3,refreshFn:s.refreshFn,styleChangeFn:o.styleChangeFn,fontfamily:o.fontfamily});break;case"fontsize":a.fontSzieSlider({type:o.id,initStartIndex:s.defaultValue,initStart:s.initStart,endStart:s.endStart,space:s.space,refreshFn:s.refreshFn,styleChangeFn:o.styleChangeFn,needInput:!0});break;case"bold":!function(e){var s={defaultValue:0,refreshFn:null,styleChangeFn:null};t.extend(s,e);var n="<div id='f_b_bold"+o.id+"' class='f_button f_b_bold "+(s.defaultValue?"f_bold_select":"")+"'></div>";0===t("#f_b_bold"+o.id).length?a.append(n):(i(s.refreshFn)&&s.refreshFn(s.defaultValue),t("#f_b_bold"+o.id).removeClass("f_bold_select")),t("#f_b_bold"+o.id).mousemove(function(){t(this).addClass("f_bold_hover")}).mouseleave(function(){t(this).removeClass("f_bold_hover")}).unbind("click").bind("click",function(){t(this).hasClass("f_bold_select")?(t(this).removeClass("f_bold_select"),s.defaultValue=0):(t(this).addClass("f_bold_select"),s.defaultValue=1),i(s.refreshFn)&&s.refreshFn(s.defaultValue),i(s.styleChangeFn)&&s.styleChangeFn()})}({defaultValue:s.defaultValue,refreshFn:s.refreshFn,styleChangeFn:o.styleChangeFn});break;case"italic":!function(e){var s={defaultValue:0,refreshFn:null,styleChangeFn:null};t.extend(s,e);var n="<div id='f_b_italic"+o.id+"' class='f_button f_b_italic "+(s.defaultValue?"f_italic_select":"")+"'></div>";0===t("#f_b_italic"+o.id).length?a.append(n):(i(s.refreshFn)&&s.refreshFn(s.defaultValue),t("#f_b_italic"+o.id).removeClass("f_italic_select")),t("#f_b_italic"+o.id).mousemove(function(){t(this).addClass("f_italic_hover")}).mouseleave(function(){t(this).removeClass("f_italic_hover")}).unbind("click").bind("click",function(){t(this).hasClass("f_italic_select")?(t(this).removeClass("f_italic_select"),s.defaultValue=0):(t(this).addClass("f_italic_select"),s.defaultValue=1),i(s.refreshFn)&&s.refreshFn(s.defaultValue),i(s.styleChangeFn)&&s.styleChangeFn()})}({defaultValue:s.defaultValue,refreshFn:s.refreshFn,styleChangeFn:o.styleChangeFn});break;case"underline":!function(e){var s={defaultValue:0,refreshFn:null,styleChangeFn:null};t.extend(s,e);var n="<div id='f_b_underline"+o.id+"' class='f_button f_b_underline "+(s.defaultValue?"f_unline_select":"")+"'></div>";0===t("#f_b_underline"+o.id).length?a.append(n):(i(s.refreshFn)&&s.refreshFn(s.defaultValue),t("#f_b_underline"+o.id).removeClass("f_unline_select")),t("#f_b_underline"+o.id).mousemove(function(){t(this).addClass("f_unline_hover")}).mouseleave(function(){t(this).removeClass("f_unline_hover")}).unbind("click").bind("click",function(){t(this).hasClass("f_unline_select")?(t(this).removeClass("f_unline_select"),s.defaultValue=0):(t(this).addClass("f_unline_select"),s.defaultValue=1),i(s.refreshFn)&&s.refreshFn(s.defaultValue),i(s.styleChangeFn)&&s.styleChangeFn()})}({defaultValue:s.defaultValue,refreshFn:s.refreshFn,styleChangeFn:o.styleChangeFn});break;case"fontcolor":!function(e){var s={defaultValue:"",refreshFn:null,removeCssFn:null};t.extend(s,e);var n=["<div id='f_color",o.id,"' class='f_button f_b_color'>","<div id='f_b_color",o.id,"' class='f_color_edit'",s.defaultValue?' style="border:1px solid #aab3bb;"':"","></div>","</div>"];n=n.join(""),0===t("#f_color"+o.id).length&&(a.append(n),t("#f_b_color"+o.id).faiColorPicker({defaultcolor:s.defaultValue,onchange:s.refreshFn,showInTop:!0})),i(s.removeCssFn)&&(s.removeCssFn(),i(s.refreshFn)&&s.refreshFn(s.defaultValue),t("#f_b_color"+o.id).removeAttr("style")),s.defaultValue||t("#f_color"+o.id).bind("mousemove",function(){t(this).children().attr("style")?t(this).unbind("mousemove"):t(this).addClass("f_color_hover")}).bind("mouseleave",function(){t(this).children().attr("style")?t(this).unbind("mouseleave"):t(this).removeClass("f_color_hover")})}({defaultValue:s.defaultValue,refreshFn:s.refreshFn,removeCssFn:s.removeCssFn})}})}}(jQuery),function(t,e){function i(t,e){e?t.addClass("ui-radioBtnSelected"):t.removeClass("ui-radioBtnSelected")}jQuery.widget("ui.radiobox",{_create:function(){var t=this,e=this.element;e.addClass("ui-radioBtn").append("<div class='ui-radioBtnCtl'></div>"),i(e,!!t.options.initVal),e.click(function(){if(!t.options.disabled){var o=!e.hasClass("ui-radioBtnSelected");i(e,o)}"function"==typeof t.options.click&&t.options.click(o)})},getVal:function(){return this.element.hasClass("ui-radioBtnSelected")},setVal:function(t){i(this.element,!!t)}})}(),function(t,e){t.widget("ui.combobox",{_create:function(){var e=this,i=this.element,o=i.width(),a=t("<input>").appendTo(i).attr("placeholder",e.options.placeholder).autocomplete({source:e.options.source,delay:0,minLength:0,open:function(i,s){if(e.options.maxlength)t(this).autocomplete("widget").width(e.options.maxlength);else{t(this).autocomplete("widget").width();var n=t(this).outerWidth()-6;a.width()!=o-Fai.getCssInt(a,"border-left-width")&&(n=t(this).outerWidth(),e.options.readonly||(n=t(this).outerWidth()-6)),t(this).autocomplete("widget").width(n)}e.options.maxHeight&&t(this).autocomplete("widget").css("max-height",e.options.maxHeight);var r=t(this).autocomplete("widget").find("li");if(1==r.length&&0==t(this).attr("readonly")){var l=t(this).val(),d=!1;t(r).each(function(e,i){var o=t.trim(t(i).text());l==o&&(d=!0)}),d&&t(this).autocomplete("close")}},select:function(i,o){t(e).data("key",o.item.key),e.options.select&&e.options.select(o.item),e.options.change&&e.options.change(o.item.label),e.options.finish&&setTimeout(function(){e.options.finish(o.item)},0)}});a.change(function(){e.options.change&&e.options.change(t(this).val())}),a.keyup(function(i){e.options.change&&e.options.change(t(this).val()),e.options.keyup&&e.options.keyup(t(this).val())}),e.options.readonly&&a.click(function(t){return a.autocomplete("widget").is(":visible")?(a.autocomplete("close"),!1):(a.autocomplete("search",""),!1)}),e.options.id&&a.attr("id",e.options.id),e.options.readonly&&a.attr("readonly","readonly"),a.width(o-Fai.getCssInt(a,"border-left-width")),i.width(o+Fai.getCssInt(a,"border-left-width")+Fai.getCssInt(a,"border-right-width")),e.options.name?a.attr("name",e.options.name):a.attr("name",e.options.id),void 0!==e.options.initVal&&a.val(e.options.initVal),void 0!==e.options.initKey?t(e).data("key",e.options.initKey):t(e).data("key","");var s=t("<div>&nbsp;</div>").attr("tabIndex",-1).css("outline","none").insertAfter(a).addClass("autoCompleteButton").hover(function(){t(this).addClass("autoCompleteButtonHover")},function(){t(this).removeClass("autoCompleteButtonHover"),t(this).removeClass("autoCompleteButtonDown")}).mouseup(function(){}).mousedown(function(){t(this).removeClass("autoCompleteButtonHover"),t(this).addClass("autoCompleteButtonDown")}).click(function(){return a.autocomplete("widget").is(":visible")?(a.autocomplete("close"),!1):(a.autocomplete("search",""),a.focus(),!1)}),n=a.outerHeight();i.css("position","relative"),i.css("height",n);var r=o-s.width()-(e.options.readonly?0:1),l=a.position().top+(n-s.height())/2;s.css("position","absolute"),s.css("left",r+"px"),s.css("top",l+"px"),e.options.readonly||(a.width(o-Fai.getCssInt(a,"border-left-width")-20),a.css("padding-right","20px"),s.css("background-color","#ffffff").css("*width","17px")),e.options.readonly?s.show():a.focus(function(){s.show()})},addSource:function(e){var i=this.element.find("input"),o=i.autocomplete("option","source"),a=!1;t.each(o,function(t,i){i.key==e.key&&(a=!0,o.splice(t,1,e))}),a||o.push(e),i.autocomplete("option","source",o)},setSource:function(t){this.element.find("input").autocomplete("option","source",t)},getSource:function(){return this.element.find("input").autocomplete("option","source")},setInitVal:function(e,i){this.element.find("input").val(e),t(this).data("key",i)},setInitKey:function(e){var i=this.element.find("input"),o=i.autocomplete("option","source"),a="";t.each(o,function(t,i){i.key==e&&(a=i.label)}),i.val(a),t(this).data("key",e)},getVal:function(){return this.element.find("input").val()},getKey:function(){return t(this).data("key")},setKey:function(e){t(this).data("key",e)}})}(jQuery),function(t){var e=[],i=/^url\(["']?([^"'\)]*)["']?\);?$/i,o=/\.png$/i,a=t.browser.msie&&6==t.browser.version;t.Poshytip=function(e,i){this.$elm=t(e),this.opts=t.extend({},t.fn.poshytip.defaults,i),this.$tip=t(['<div id="',this.opts.id,'" class="',this.opts.className,'" ',""!=this.opts.cusStyle?"style='"+this.opts.cusStyle+"'":"",">",'<div class="tip-inner tip-bg-image"></div>','<div class="tip-arrow tip-arrow-top tip-arrow-right tip-arrow-bottom tip-arrow-left"></div>',"</div>"].join("")),this.$arrow=this.$tip.find("div.tip-arrow"),this.$inner=this.$tip.find("div.tip-inner"),this.disabled=!1,this.init()},t.Poshytip.prototype={init:function(){switch(e.push(this),this.$elm.data("title.poshytip",this.$elm.attr("title")),this.$elm.data("poshytip",this),this.opts.showOn){case"hover":this.$elm.bind({"mouseenter.poshytip":t.proxy(this.mouseenter,this),"mouseleave.poshytip":t.proxy(this.mouseleave,this)}),"cursor"==this.opts.alignTo&&this.$elm.bind("mousemove.poshytip",t.proxy(this.mousemove,this)),this.opts.allowTipHover&&this.$tip.hover(t.proxy(this.clearTimeouts,this),t.proxy(this.hide,this));break;case"focus":this.$elm.bind({"focus.poshytip":t.proxy(this.show,this),"blur.poshytip":t.proxy(this.hide,this)})}if(this.opts.autoLocation){var i=this,o=i.$elm.offset().top,a=i.$elm.offset().left;this.interval=setInterval(function(){var t=i.$elm.offset().top,e=i.$elm.offset().left;o==t&&a==e||(i.update(),i.display(),o=t,a=e)},300)}},mouseenter:function(e){if(this.disabled)return!0;this.clearTimeouts(),this.$elm.attr("title",""),this.showTimeout=setTimeout(t.proxy(this.show,this),this.opts.showTimeout)},mouseleave:function(){if(this.disabled)return!0;this.clearTimeouts(),this.$elm.attr("title",this.$elm.data("title.poshytip")),this.hideTimeout=setTimeout(t.proxy(this.hide,this),this.opts.hideTimeout)},mousemove:function(t){if(this.disabled)return!0;this.eventX=t.pageX,this.eventY=t.pageY,this.opts.followCursor&&this.$tip.data("active")&&(this.calcPos(),this.$tip.css({left:this.pos.l,top:this.pos.t}),this.pos.arrow&&(this.$arrow[0].className="tip-arrow tip-arrow-"+this.pos.arrow))},show:function(){this.disabled||this.$tip.data("active")||(this.reset(),this.update(),this.display())},hide:function(){!this.disabled&&this.$tip.data("active")&&this.display(!0)},reset:function(){this.$tip.queue([]).detach().css("visibility","hidden").data("active",!1),this.$inner.find("*").poshytip("hide"),this.opts.fade&&this.$tip.css("opacity",this.opacity),this.$arrow[0].className="tip-arrow tip-arrow-top tip-arrow-right tip-arrow-bottom tip-arrow-left"},update:function(t){if(!this.disabled){var e=void 0!==t;if(e){if(!this.$tip.data("active"))return}else t=this.opts.content;this.$inner.contents().detach();var i=this;this.$inner.append("function"==typeof t?t.call(this.$elm[0],function(t){i.update(t)}):"[title]"==t?this.$elm.data("title.poshytip"):t),this.refresh(e)}},refresh:function(e){if(!this.disabled){if(e){if(!this.$tip.data("active"))return;this.$tip.css("left"),this.$tip.css("top")}this.$tip.css({left:0,top:0}).appendTo(this.opts.appendToId?t(this.opts.appendToId):document.body),void 0===this.opacity&&(this.opacity=this.$tip.css("opacity"));var s=this.$tip.css("background-image").match(i),n=this.$arrow.css("background-image").match(i);if(s){var r=o.test(s[1]);a&&r?(this.$tip.css("background-image","none"),this.$inner.css({margin:0,border:0,padding:0}),s=r=!1):this.$tip.prepend('<table border="0" cellpadding="0" cellspacing="0"><tr><td class="tip-top tip-bg-image" colspan="2"><span></span></td><td class="tip-right tip-bg-image" rowspan="2"><span></span></td></tr><tr><td class="tip-left tip-bg-image" rowspan="2"><span></span></td><td></td></tr><tr><td class="tip-bottom tip-bg-image" colspan="2"><span></span></td></tr></table>').css({border:0,padding:0,"background-image":"none","background-color":"transparent"}).find(".tip-bg-image").css("background-image",'url("'+s[1]+'")').end().find("td").eq(3).append(this.$inner),r&&!t.support.opacity&&(this.opts.fade=!1)}n&&!t.support.opacity&&(a&&o.test(n[1])&&(n=!1,this.$arrow.css("background-image","none")),this.opts.fade=!1);var l=this.$tip.find("table");if(a){this.$tip[0].style.width="",l.width("auto").find("td").eq(3).width("auto");var d=this.$tip.width(),c=parseInt(this.$tip.css("min-width")),h=parseInt(this.$tip.css("max-width"));!isNaN(c)&&d<c?d=c:!isNaN(h)&&d>h&&(d=h),this.$tip.add(l).width(d).eq(0).find("td").eq(3).width("100%")}else l[0]&&l.width("auto").find("td").eq(3).width("auto").end().end().width(this.$tip.width()).find("td").eq(3).width("100%");if(this.tipOuterW=this.$tip.outerWidth(),this.tipOuterH=this.$tip.outerHeight(),this.calcPos(),n&&this.pos.arrow&&(this.$arrow[0].className="tip-arrow tip-arrow-"+this.pos.arrow,this.$arrow.css("visibility","inherit")),this.$tip.css({left:this.pos.l,top:this.pos.t}),"top"==this.pos.arrow)Math.round(this.$arrow.offset().left+this.$arrow.width()-this.$arrow.width()/2)!=(p=Math.round(this.$elm.offset().left+this.$elm.width()-this.$elm.width()/2))&&this.$arrow.offset({top:this.$tip.offset().top-(this.$arrow.height()-1),left:p});else if("bottom"==this.pos.arrow){var p;Math.round(this.$arrow.offset().left+this.$arrow.width()-this.$arrow.width()/2)!=(p=Math.round(this.$elm.offset().left+this.$elm.width()-this.$elm.width()/2))&&this.$arrow.offset({top:this.$tip.offset().top+this.$tip.height()+this.$arrow.height()+5+1,left:p})}}},display:function(e){var i=this.$tip.data("active");if(!(i&&!e||!i&&e)){if(this.$tip.stop(),(this.opts.slide&&this.pos.arrow||this.opts.fade)&&(e&&this.opts.hideAniDuration||!e&&this.opts.showAniDuration)){var o={},a={};if(this.opts.slide&&this.pos.arrow){var s,n;if("bottom"==this.pos.arrow||"top"==this.pos.arrow){if(s="top",n="bottom","top"==this.pos.arrow)Math.round(this.$arrow.offset().left+this.$arrow.width()-this.$arrow.width()/2)!=(r=Math.round(this.$elm.offset().left+this.$elm.width()-this.$elm.width()/2))&&this.$arrow.offset({top:this.$tip.offset().top-(this.$arrow.height()-1),left:r});else if("bottom"==this.pos.arrow){var r;Math.round(this.$arrow.offset().left+this.$arrow.width()-this.$arrow.width()/2)!=(r=Math.round(this.$elm.offset().left+this.$elm.width()-this.$elm.width()/2))&&this.$arrow.offset({top:this.$tip.offset().top+this.$tip.height()+this.$arrow.height()+5+1,left:r})}}else s="left",n="right";var l=parseInt(this.$tip.css(s));o[s]=l+(e?0:this.opts.slideOffset*(this.pos.arrow==n?-1:1)),a[s]=l+(e?this.opts.slideOffset*(this.pos.arrow==n?1:-1):0)}this.opts.fade&&(o.opacity=e?this.$tip.css("opacity"):0,a.opacity=e?0:this.opacity),this.$tip.css(o).animate(a,this.opts[e?"hideAniDuration":"showAniDuration"])}e?this.$tip.queue(t.proxy(this.reset,this)):this.$tip.css("visibility","inherit"),this.$tip.data("active",!i)}},disable:function(){this.reset(),this.disabled=!0},enable:function(){this.disabled=!1},destroy:function(){this.reset(),this.$tip.remove(),this.$elm.unbind("poshytip").removeData("title.poshytip").removeData("poshytip"),e.splice(t.inArray(this,e),1),this.opts.autoLocation&&clearInterval(this.interval)},clearTimeouts:function(){this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=0),this.hideTimeout&&(clearTimeout(this.hideTimeout),this.hideTimeout=0)},calcPos:function(){var e,i,o,a,s,n,r={l:0,t:0,arrow:""},l=t(window),d={l:l.scrollLeft(),t:l.scrollTop(),w:l.width(),h:l.height()};if("cursor"==this.opts.alignTo)e=i=o=this.eventX,a=s=n=this.eventY;else{var c=this.$elm.offset(),h={l:c.left,t:this.opts.appendToId?c.top-t(this.opts.appendToId).offset().top:c.top,w:this.$elm.outerWidth(),h:this.$elm.outerHeight()};i=(e=h.l+("inner-right"!=this.opts.alignX?0:h.w))+Math.floor(h.w/2),o=e+("inner-left"!=this.opts.alignX?h.w:0),s=(a=h.t+("inner-bottom"!=this.opts.alignY?0:h.h))+Math.floor(h.h/2),n=a+("inner-top"!=this.opts.alignY?h.h:0)}switch(this.opts.alignX){case"right":case"inner-left":r.l=o+this.opts.offsetX,r.l+this.tipOuterW>d.l+d.w&&(r.l=d.l+d.w-this.tipOuterW),"right"!=this.opts.alignX&&"center"!=this.opts.alignY||(r.arrow="left");break;case"center":r.l=i-Math.floor(this.tipOuterW/2),r.l+this.tipOuterW>d.l+d.w?r.l=d.l+d.w-this.tipOuterW:r.l<d.l&&(r.l=d.l);break;default:r.l=e-this.tipOuterW-this.opts.offsetX,r.l<d.l&&(r.l=d.l),"left"!=this.opts.alignX&&"center"!=this.opts.alignY||(r.arrow="right")}switch(this.opts.alignY){case"bottom":case"inner-top":r.t=n+this.opts.offsetY,r.arrow&&"cursor"!=this.opts.alignTo||(r.arrow="top"),r.t+this.tipOuterH>d.t+d.h&&(r.t=a-this.tipOuterH-this.opts.offsetY,"top"==r.arrow&&(r.arrow="bottom"));break;case"center":r.t=s-Math.floor(this.tipOuterH/2),r.t+this.tipOuterH>d.t+d.h?r.t=d.t+d.h-this.tipOuterH:r.t<d.t&&(r.t=d.t);break;default:r.t=a-this.tipOuterH-this.opts.offsetY,r.arrow&&"cursor"!=this.opts.alignTo||(r.arrow="bottom"),r.t<d.t&&(r.t=n+this.opts.offsetY,"bottom"==r.arrow&&(r.arrow="top"))}this.pos=r}},t.fn.poshytip=function(e){if("string"==typeof e)return this.each(function(){var i=t(this).data("poshytip");i&&i[e]&&i[e]()});var i=t.extend({},t.fn.poshytip.defaults,e);return t("#poshytip-css-"+i.className)[0]||t(['<style id="poshytip-css-',i.className,'" type="text/css">',"div.",i.className,"{visibility:hidden;position:absolute;top:0;left:0;}","div.",i.className," table, div.",i.className," td{margin:0;font-family:inherit;font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;}","div.",i.className," td.tip-bg-image span{display:block;font:1px/1px sans-serif;height:",i.bgImageFrameSize,"px;width:",i.bgImageFrameSize,"px;overflow:hidden;}","div.",i.className," td.tip-right{background-position:100% 0;}","div.",i.className," td.tip-bottom{background-position:100% 100%;}","div.",i.className," td.tip-left{background-position:0 100%;}","div.",i.className," div.tip-inner{background-position:-",i.bgImageFrameSize,"px -",i.bgImageFrameSize,"px;}","div.",i.className," div.tip-arrow{visibility:hidden;position:absolute;overflow:hidden;font:1px/1px sans-serif;}","</style>"].join("")).appendTo("head"),this.each(function(){new t.Poshytip(this,i)})},t.fn.poshytip.defaults={content:"[title]",className:"tip-yellow",cusStyle:"",bgImageFrameSize:10,showTimeout:500,hideTimeout:100,showOn:"hover",alignTo:"cursor",alignX:"right",alignY:"top",offsetX:-22,offsetY:18,allowTipHover:!0,followCursor:!1,fade:!0,slide:!0,slideOffset:8,showAniDuration:300,hideAniDuration:300}}(jQuery),function(t,e){t.widget("ui.slider",t.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var e=this,i=this.options,o=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),a=i.values&&i.values.length||1,s=[];this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(i.disabled?" ui-slider-disabled ui-disabled":"")),this.range=t([]),i.range&&(!0===i.range&&(i.values||(i.values=[this._valueMin(),this._valueMin()]),i.values.length&&2!==i.values.length&&(i.values=[i.values[0],i.values[0]])),this.range=t("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===i.range||"max"===i.range?" ui-slider-range-"+i.range:"")));for(var n=o.length;n<a;n+=1)s.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");this.handles=o.add(t(s.join("")).appendTo(e.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(t){t.preventDefault()}).hover(function(){i.disabled||t(this).addClass("ui-state-hover")},function(){t(this).removeClass("ui-state-hover")}).focus(function(){i.disabled?t(this).blur():(t(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),t(this).addClass("ui-state-focus"))}).blur(function(){t(this).removeClass("ui-state-focus")}),this.handles.each(function(e){t(this).data("index.ui-slider-handle",e)}),this.handles.keydown(function(i){var o,a,s,n=t(this).data("index.ui-slider-handle");if(!e.options.disabled){switch(i.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(i.preventDefault(),!e._keySliding&&(e._keySliding=!0,t(this).addClass("ui-state-active"),!1===e._start(i,n)))return}switch(s=e.options.step,o=a=e.options.values&&e.options.values.length?e.values(n):e.value(),i.keyCode){case t.ui.keyCode.HOME:a=e._valueMin();break;case t.ui.keyCode.END:a=e._valueMax();break;case t.ui.keyCode.PAGE_UP:a=e._trimAlignValue(o+(e._valueMax()-e._valueMin())/5);break;case t.ui.keyCode.PAGE_DOWN:a=e._trimAlignValue(o-(e._valueMax()-e._valueMin())/5);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(o===e._valueMax())return;a=e._trimAlignValue(o+s);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(o===e._valueMin())return;a=e._trimAlignValue(o-s)}e._slide(i,n,a)}}).keyup(function(i){var o=t(this).data("index.ui-slider-handle");e._keySliding&&(e._keySliding=!1,e._stop(i,o),e._change(i,o),t(this).removeClass("ui-state-active"))}),this._refreshValue(),this._animateOff=!1},destroy:function(){return this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider"),this._mouseDestroy(),this},_mouseCapture:function(e){var i,o,a,s,n,r,l,d,c=this.options;return!c.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),i={x:e.pageX,y:e.pageY},o=this._normValueFromMouse(i),a=this._valueMax()-this._valueMin()+1,n=this,this.handles.each(function(e){var i=Math.abs(o-n.values(e));a>i&&(a=i,s=t(this),r=e)}),!0===c.range&&this.values(1)===c.min&&(r+=1,s=t(this.handles[r])),!1!==this._start(e,r)&&(this._mouseSliding=!0,n._handleIndex=r,s.addClass("ui-state-active").focus(),l=s.offset(),d=!t(e.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=d?{left:0,top:0}:{left:e.pageX-l.left-s.width()/2,top:e.pageY-l.top-s.height()/2-(parseInt(s.css("borderTopWidth"),10)||0)-(parseInt(s.css("borderBottomWidth"),10)||0)+(parseInt(s.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,r,o),this._animateOff=!0,!0))},_mouseStart:function(t){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,i),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,i,o,a,s;return"horizontal"===this.orientation?(e=this.elementSize.width,i=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,i=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),(o=i/e)>1&&(o=1),o<0&&(o=0),"vertical"===this.orientation&&(o=1-o),a=this._valueMax()-this._valueMin(),s=this._valueMin()+o*a,this._trimAlignValue(s)},_start:function(t,e){var i={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("start",t,i)},_slide:function(t,e,i){var o,a,s;this.options.values&&this.options.values.length?(o=this.values(e?0:1),2===this.options.values.length&&!0===this.options.range&&(0===e&&i>o||1===e&&i<o)&&(i=o),i!==this.values(e)&&((a=this.values())[e]=i,s=this._trigger("slide",t,{handle:this.handles[e],value:i,values:a}),o=this.values(e?0:1),!1!==s&&this.values(e,i,!0))):i!==this.value()&&!1!==(s=this._trigger("slide",t,{handle:this.handles[e],value:i}))&&this.value(i)},_stop:function(t,e){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("stop",t,i)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var i={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(i.value=this.values(e),i.values=this.values()),this._trigger("change",t,i)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,i){var o,a,s;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(i),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(o=this.options.values,a=arguments[0],s=0;s<o.length;s+=1)o[s]=this._trimAlignValue(a[s]),this._change(null,s);this._refreshValue()},_setOption:function(e,i){var o,a=0;switch(t.isArray(this.options.values)&&(a=this.options.values.length),t.Widget.prototype._setOption.apply(this,arguments),e){case"disabled":i?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),o=0;o<a;o+=1)this._change(null,o);this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,i,o;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);for(i=this.options.values.slice(),o=0;o<i.length;o+=1)i[o]=this._trimAlignValue(i[o]);return i},_trimAlignValue:function(t){if(t<=this._valueMin())return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,i=(t-this._valueMin())%e,o=t-i;return 2*Math.abs(i)>=e&&(o+=i>0?e:-e),parseFloat(o.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var e,i,o,a,s,n=this.options.range,r=this.options,l=this,d=!this._animateOff&&r.animate,c={};this.options.values&&this.options.values.length?this.handles.each(function(o,a){e=(l.values(o)-l._valueMin())/(l._valueMax()-l._valueMin())*100,c["horizontal"===l.orientation?"left":"bottom"]=e+"%",t(this).stop(1,1)[d?"animate":"css"](c,r.animate),!0===l.options.range&&("horizontal"===l.orientation?(0===o&&l.range.stop(1,1)[d?"animate":"css"]({left:e+"%"},r.animate),1===o&&l.range[d?"animate":"css"]({width:e-i+"%"},{queue:!1,duration:r.animate})):(0===o&&l.range.stop(1,1)[d?"animate":"css"]({bottom:e+"%"},r.animate),1===o&&l.range[d?"animate":"css"]({height:e-i+"%"},{queue:!1,duration:r.animate}))),i=e}):(o=this.value(),a=this._valueMin(),s=this._valueMax(),e=s!==a?(o-a)/(s-a)*100:0,c["horizontal"===l.orientation?"left":"bottom"]=e+"%",this.handle.stop(1,1)[d?"animate":"css"](c,r.animate),"min"===n&&"horizontal"===this.orientation&&this.range.stop(1,1)[d?"animate":"css"]({width:e+"%"},r.animate),"max"===n&&"horizontal"===this.orientation&&this.range[d?"animate":"css"]({width:100-e+"%"},{queue:!1,duration:r.animate}),"min"===n&&"vertical"===this.orientation&&this.range.stop(1,1)[d?"animate":"css"]({height:e+"%"},r.animate),"max"===n&&"vertical"===this.orientation&&this.range[d?"animate":"css"]({height:100-e+"%"},{queue:!1,duration:r.animate}))}}),t.extend(t.ui.slider,{version:"@VERSION"})}(jQuery),function(t){var e=function(e,i){if("[object object]"!=Object.prototype.toString.call(i).toLowerCase())throw new Error("faiImageAdd parameter error");if(this.$elm=t(e),this.mouseInHandle=0,this.opts=t.extend({entry:"Site",_resRoot:"",_cssResource:"",moduleId:0,popupID:0,allPhotoList:[],groupId:0,photoGroupList:[],photoGroup:!1,addPhotoWay:0,dataStructure:[],fileUpload2_settings:{},imagesLimit:50,backUrl:"",refreshHoverImageCallback:function(){},editPhotoCallback:function(){},deletePhotoCallback:function(){},addPhotoWayCallback:function(){}},i),""==this.opts._cssResource)throw new Error("faiImageAddCss is not existed");var o=document.createElement("link");if(o.rel="stylesheet",o.type="text/css",o.href=this.opts._cssResource,t("head").append(o),0==this.opts.dataStructure.length)throw new Error("faiImageAdd dataStructure error");if(void 0===this.opts.linkType)throw new Error("faiImageAdd linkType error");this.isSite="Site"==this.opts.entry,this.isMobi="Mobi"==this.opts.entry,this.init(),this.checkPhotoGroup(),this.sortable(),this.movePhotoEvent(),this.fileUpload()};t.extend(e.prototype,{init:function(){var e=this.opts.allPhotoList;if(t('<div class="photo-add-panel"><div class="upload-panel"><div class="photoList"><ul id="fk-imgContainer" class="img-container"><li style="float: left;" class="J_imgPanel J_moreImgPanel" id="fk-add-photo"><div class="add-photo fk-uploadButton"><div class="add-photo-picture">+</div><div class="add-photo-text">添加图片</div></div></li></ul></div></div></div><div class="add-photo-prompt"><div class="add-photo-btn fk-uploadButton"><div class="add-photo-btn-picture">+</div><div class="add-photo-btn-text">继续添加</div></div><div class="show-photo-list"><div class="add-photo-btn-text" style="display:inline;">图片已上传</div><div id="fk-photoNumber" class="add-photo-btn-text" style="display:inline;">0</div><div class="add-photo-btn-text" style="display:inline;">张</div></div></div>').appendTo(this.$elm),e.length>0)for(var i=0;i<e.length;i++){for(var o=e[i],a=this.opts.dataStructure,s=[],n=0;n<a.length;n++)s.push(o[a[n]]);this.addImage.apply(this,s)}t("#fk-imgContainer").disableSelection(),t("#fk-imgContainer").find(".photo-border").first().click()},addImage:function(){var e=this,i=e.opts.dataStructure,o=arguments[0],a=arguments[1],s="<li id="+o+" class='img-panel J_imgPanel' title=''><div class='photo-border'><div class='photoHover'><div class='sortableHandle' id='sortableHandle'></div><a class='editBut J_photoHandle' title='编辑图片'></a><a class='deleteBut J_photoHandle' title='删除图片'></a></div><table width='100%' height='100%' cellpadding='0' cellspacing='0'><tr><td valign='middle'><img style='display:none;margin:0 auto;' data-origkinal='"+e.opts._resRoot+"/image/template/preview/loadingTmpl.gif' src="+a+" style='display:block; margin:auto;' class='Js_lazyloadimg' onload='Fai.Img.optimize(this, {width:90, height:76, display:0, mode:Fai.Img.MODE_SCALE_DEFLATE_FILL});'/></td></tr></table></div></li>";t("#fk-add-photo").before(s);for(var n=0;n<i.length;n++)0!=n&&t("#"+arguments[0]).data(i[n],arguments[n]);e.photoIdList=[],t("#fk-imgContainer").find(".img-panel").each(function(){e.photoIdList.push(t(this).attr("id"))}),t("#"+o+" .editBut").unbind("click").bind("click",function(){e.editPhoto(o)}),t("#"+o+" .deleteBut").unbind("click").bind("click",function(){e.deletePhoto(o)}),t("#"+o).unbind("dblclick").bind("dblclick",function(){e.editPhoto(o)});var r=e.photoCount();t("#fk-imgContainer").css("width",100*(r+1)).css("max-width",100*(r+1)),t("#fk-photoNumber").text(r)},checkPhotoGroup:function(){var e,i,o,a,s=this,n=(s.opts.imagesLimit,s.opts.photoGroupList),r=s.opts.groupId,l=(s.opts.fileUpload2_settings,s.opts.addPhotoWay);if(s.opts.photoGroup){if('<div id="moduleAddPhotoPanel" class="clearPanel"><div class="clearTitle">添加图片：</div><div class="clearCtrl radioPanel"><input id="addDirectly" name="addPhotoRadio" type="radio"><label for="addDirectly">直接添加</label><input id="bindPhotoGroup" name="addPhotoRadio" type="radio"><label for="bindPhotoGroup">绑定图册</label></div></div>','<div class="managePhotoGroup"><div class="manageHeader"><div class="manageTitle">选择图册：</div><div class="manageBtn J_addPhotoGroup"><input type="button" class="faiButton" value="创建图册" /></div></div><div id="photoGroupList" class="photoGroupList"></div></div>',t(".photo-add-panel").before('<div id="moduleAddPhotoPanel" class="clearPanel"><div class="clearTitle">添加图片：</div><div class="clearCtrl radioPanel"><input id="addDirectly" name="addPhotoRadio" type="radio"><label for="addDirectly">直接添加</label><input id="bindPhotoGroup" name="addPhotoRadio" type="radio"><label for="bindPhotoGroup">绑定图册</label></div></div>'),(o=t("#moduleAddPhotoPanel")).after('<div class="managePhotoGroup"><div class="manageHeader"><div class="manageTitle">选择图册：</div><div class="manageBtn J_addPhotoGroup"><input type="button" class="faiButton" value="创建图册" /></div></div><div id="photoGroupList" class="photoGroupList"></div></div>'),a=t("#photoGroupList"),e=o.find("#addDirectly"),i=o.find("#bindPhotoGroup"),n.length>0){for(var d="",c=0;c<n.length;c++){var h=n[c].id,p=n[c].name;d+='<div id="photoGroup'+h+'" class="photoGroup">',d+='<table class="photoGroupTable" cellpadding="0" cellspacing="0"><tr>',d+='<td class="width-35 ta-c"><input value="'+h+'" id="pgRadio'+h+'" '+(r==h?"checked='checked'":"")+' name="pgRadio" type="radio" /><label for="pgRadio'+h+'"></label></td>',d+='<td><div class="photoGroupName" id="groupName'+h+'">'+Fai.encodeHtml(p)+"</div></td>",d+='<td><a class="editPhotoGroup" id="editPhotoGroup'+h+'">编辑</a>&nbsp;&nbsp;</td>',d+="</tr></table>",d+="</div>"}a[0].innerHTML=d}else a[0].innerHTML="<div class='empty-list'>您尚未创建图册</div>";i.unbind("click").bind("click",function(){t(".photo-add-panel, .add-photo-prompt").hide(),t(".managePhotoGroup").show(),s.refreshHoverImageList(),s.refreshClickPhoto();var e=Fai.top._aid;void 0===Fai.top._aid&&(e=Fai.top._cid),!Fai.top._oem&&e>1424e4&&(t("#photoDetail").hide(),t("label[for='photoDetail']").hide(),t("#openTypePanel").hide(),t("#pictureLink")[0].checked&&t("#slideLink").click(),t("#pictureLink").hide(),t("label[for='pictureLink']").hide(),t("#openTypePanel").hide())}),e.unbind("click").bind("click",function(){t(".photo-add-panel, .add-photo-prompt").show(),t(".managePhotoGroup").hide(),s.refreshHoverImageList(),s.refreshClickPhoto(),t("#photoDetail").show(),t("label[for='photoDetail']").show(),t("#pictureLink").show(),t("label[for='pictureLink']").show()}),0==l?e[0].click():1==l&&i[0].click(),s.choicePhotoGroup(),s.editPhotoGroup(),s.addPhotoGroup()}},addPhotoGroup:function(){var e=this,i=e.opts.backUrl,o=t(".J_addPhotoGroup"),a=t("#photoGroupList"),s=e.opts.version||1;function n(i){if(!Fai.isNull(i)){var o=[],s=t.parseJSON(i),n=(s.photoList,s.id);o+="<div id='photoGroup"+n+"' class='photoGroup' >",o+="<table class='photoGroupTable' cellpadding='0' celspacing='0'>",o+="<tr>",o+="<td class='width-35 ta-c'><input id='pgRadio"+n+"' value='"+n+"' name='pgRadio' type='radio' /><label for='pgRadio"+n+"'></label></td>",o+="<td><div class='photoGroupName' id=groupName"+n+">"+Fai.encodeHtml(s.name)+"</div></td>",o+="<td><a class='editPhotoGroup' id='editPhotoGroup"+n+"'>编辑</a>&nbsp;&nbsp;</td>",o+="</tr>",o+="</table>",o+="</div>";var r=a.children("div.empty-list");r.length&&r.remove(),a.append(o);var l=t("#pgRadio"+n);l.length&&(l[0].click(),a.scrollTop(0),a.scrollTop(t("#photoGroup"+n).offset().top),e.choicePhotoGroup(),e.editPhotoGroup(),e.setPageChange())}}o.unbind("click").bind("click",function(){var t,o=i.charAt(i.length-1),a=!1,r=2==s?"manage_v2":"manage";""!=o&&"/"!=o&&(a=!0),e.isSite?t=a?i+"/"+r+"/photoGroupEdit.jsp":""+i+r+"/photoGroupEdit.jsp":e.isMobi&&(t=a?i+"/"+r+"/photoGroupEdit.jsp?mobiSettingState=1&crossiframe="+Fai.encodeUrl(Mobi.getPreviewWindow().Mobi.getSiteMultiLanguageUrl()):""+i+r+"/photoGroupEdit.jsp?mobiSettingState=1&crossiframe="+Fai.encodeUrl(Mobi.getPreviewWindow().Mobi.getSiteMultiLanguageUrl())),1==s?Fai.popupWindow({title:"创建图册",frameSrcUrl:t,width:750,height:560,closeFunc:n}):2==s&&Fai.popupWindowVersionTwo.createPopupWindow({title:"创建图册",frameSrcUrl:t,width:860,height:682,closeFunc:n})})},choicePhotoGroup:function(){var e=this;t("#photoGroupList").off("click.choicePhotoGroup").on("click.choicePhotoGroup",".photoGroup",function(i){t(this).length>0&&t(this).find("input")[0].click(),e.refreshHoverImageList(),i.target!=t(this).find("input")[0]&&i.target!=t(this).find(".editPhotoGroup")[0]&&(e.isSite?Site&&Site.logDog&&Site.logDog(200383,1):e.isMobi&&Mobi&&Mobi.logDog&&Mobi.logDog(200383,1))})},editPhotoGroup:function(){var e=this,i=e.opts.backUrl,o=t("#photoGroupList"),a=(document.URL.split("/",4).pop(),e.opts.version||1);function s(i){if(i){var o=t.parseJSON(i),a=o.id,s=o.photoList;t("#groupName"+a).text(o.name),s.length&&e.refreshHoverImageList()}}o.off("click.editPhotoGroup").on("click.editPhotoGroup",".editPhotoGroup",function(){var o,n=t(this).attr("id").replace("editPhotoGroup",""),r=i.charAt(i.length-1),l=!1,d=2==a?"manage_v2":"manage";""!=r&&"/"!=r&&(l=!0),e.isSite?o=l?i+"/"+d+"/photoGroupEdit.jsp?id="+n+"&ram="+Math.random():""+i+d+"/photoGroupEdit.jsp?id="+n+"&ram="+Math.random():e.isMobi&&(o=l?i+"/"+d+"/photoGroupEdit.jsp?mobiSettingState=1&crossiframe="+Fai.encodeUrl(Mobi.getPreviewWindow().Mobi.getSiteMultiLanguageUrl())+"&id="+n+"&ram="+Math.random():""+i+d+"/photoGroupEdit.jsp?mobiSettingState=1&crossiframe="+Fai.encodeUrl(Mobi.getPreviewWindow().Mobi.getSiteMultiLanguageUrl())+"&id="+n+"&ram="+Math.random()),1==a?Fai.popupWindow({title:"编辑图册",frameSrcUrl:o,width:750,height:560,frameScrolling:"auto",closeFunc:s}):2==a&&Fai.popupWindowVersionTwo.createPopupWindow({title:"编辑图册",frameSrcUrl:o,width:860,height:682,frameScrolling:"auto",closeFunc:s}),e.isSite?Site&&Site.logDog&&Site.logDog(200383,2):e.isMobi&&Mobi&&Mobi.logDog&&Mobi.logDog(200383,2)})},editPhoto:function(e){var i=this;i.opts.editPhotoCallback(e),i.photoIdList=[],t("#fk-imgContainer").find(".img-panel").each(function(){i.photoIdList.push(t(this).attr("id"))}),i.setPageChange()},deletePhoto:function(e){var i=this;t("#"+e).remove();var o=i.photoCount();i.opts.fileUpload2_settings.maxChoiceList++,0==o&&t("#fk-add-photo").show(),t("#fk-photoNumber").text(o),i.photoIdList=[],t("#fk-imgContainer").find(".img-panel").each(function(){i.photoIdList.push(t(this).attr("id"))}),i.opts.deletePhotoCallback(e),i.setPageChange()},sortable:function(){var e=this;t("#fk-imgContainer").sortable({items:"li",handle:".photoHover",distance:1,axis:"x",change:function(){e.setPageChange()},stop:function(){t(".tool4edit-container").remove(),t(".imgDiv table").removeClass("hoverTableClass"),t(".coverLayer").remove(),t(".J_imgPanel:last").hasClass("J_moreImgPanel")||t("#fk-imgContainer").sortable("cancel")},tolerance:"intersect",sort:function(e,i){var o=t("#fk-imgContainer").parent().width()-50,a=t("#fk-imgContainer").parent(),s=i.offset.left,n=i.position.left,r=t("#fk-imgContainer").width();s>o&&n<r-90&&(a.scrollLeft(a.scrollLeft()+10),t("#fk-imgContainer").sortable("refreshPositions")),s<0&&n>0&&(a.scrollLeft(a.scrollLeft()-10),t("#fk-imgContainer").sortable("refreshPositions"))},placeholder:"photo-placeholder"})},movePhotoEvent:function(){var e=this;t(".J_imgPanel").on("mousedown.imgSortable",function(){0==e.mouseInHandle&&(t(this).find("#sortableHandle").show(),t(this).find(".J_photoHandle").hide())}).on("mouseup.imgSortable",function(){t(this).find(".J_photoHandle").show(),t(this).find("#sortableHandle").hide()}),t(".J_photoHandle").on("mouseover.imgSortable",function(){e.mouseInHandle=1}).on("mouseout.imgSortable",function(){e.mouseInHandle=0})},fileUpload:function(){var e=this,i=e.opts.fileUpload2_settings,o=e.opts.imagesLimit;function a(s){if(s){var n=t.parseJSON(s),r=n.data,l=n.data.length,d=[],c=[];if(e.photoCount()+l>o)return void Fai.ing("最大文件数为"+o+"个。",!0);for(var h=0;h<r.length;h++)e.isSite&&(r[h].skipMobiColId=0,r[h].mobiDetail=0),t.inArray(r[h].fileId,e.photoIdList)>-1?(i.maxChoiceList++,Fai.ing("重复的文件已自动覆盖。",!0)):(d.push(r[h].filePath),c.push(r[h].fileId));e.drawImgList(d,c),t("#fk-photoNumber").text(e.photoCount()),i.maxChoiceList=i.maxChoiceList-l,e.isSite?Site.fileUpload2(".fk-uploadButton",i,a):e.isMobi&&Mobi.fileUpload2(".fk-uploadButton",i,a),e.setPageChange()}}e.isSite?Site.fileUpload2(".fk-uploadButton",i,a):e.isMobi&&Mobi.fileUpload2(".fk-uploadButton",i,a)},drawImgList:function(e,i,o){for(var a=this,s=a.opts.dataStructure,n=(s.length,0);n<e.length;n++){var r="<li id="+i[n]+" class='img-panel J_imgPanel' title=''><div class='photo-border'><div class='photoHover'><div class='sortableHandle' id='sortableHandle'></div><a class='editBut J_photoHandle' title='编辑图片'></a><a class='deleteBut J_photoHandle' title='删除图片'></a></div><table width='100%' height='100%' cellpadding='0' cellspacing='0'><tr><td valign='middle'><img style='display:none;margin:0 auto;' data-origkinal='"+this.opts._resRoot+"/image/template/preview/loadingTmpl.gif' src="+e[n]+"  class='Js_lazyloadimg' onload='Fai.Img.optimize(this, {width:90, height:76, display:0, mode:Fai.Img.MODE_SCALE_DEFLATE_FILL});'/></td></tr></table>   </div></li>";t("#fk-add-photo").before(r);for(var l=0;l<s.length;l++)0!=l&&(1==l?t("#"+i[n]).data(s[l],e[n]):2==l?t("#"+i[n]).data(s[l],o?o[n]:""):3==l?t("#"+i[n]).data(s[l],a.opts.linkType):t("#"+i[n]).data(s[l],""))}t.each(i,function(e,i){t("#"+i+" .editBut").unbind("click").bind("click",function(){a.editPhoto(i)}),t("#"+i+" .deleteBut").unbind("click").bind("click",function(){a.deletePhoto(i)}),t("#"+i).unbind("dblclick").bind("dblclick",function(){a.editPhoto(i)})});var d=a.photoCount();t("#fk-imgContainer").css({overflow:"hidden",width:100*(d+1),"max-width":100*(d+1)}),a.photoIdList=[],t("#fk-imgContainer").find(".img-panel").each(function(){a.photoIdList.push(t(this).attr("id"))}),a.refreshHoverImageList(),a.setPageChange()},refreshHoverImageList:function(){this.opts.refreshHoverImageCallback()},refreshClickPhoto:function(){this.opts.addPhotoWayCallback()},photoCount:function(){return t("#fk-imgContainer").find(".img-panel").length},setPageChange:function(){this.isSite?Site.setPageChange(!0,this.opts.popupID):this.isMobi&&Mobi.setPageChange(!0,this.opts.popupID)}}),t.fn.extend({faiImageAdd:function(i){i=i||{};return t(this).each(function(){new e(t(this),i);var o=t(this);o.photoIdList=[],t.fn.faiImageAdd.deletePhoto=function(e){t("#"+e).remove();var i=t("#fk-imgContainer").find(".img-panel").length;0==i&&t("#add-photo").show(),t("#photoNumber").text(i),o.photoIdList=[],t("#fk-imgContainer").find(".img-panel").each(function(){o.photoIdList.push(t(this).attr("id"))})}})}})}(jQuery),function(t,e){"function"==typeof define&&define.amd?define(e):"object"===("undefined"==typeof module?"undefined":_typeof(module))&&module.exports?module.exports=e():t.Popper=e()}(this,function(){"use strict";var t=window,e={placement:"bottom",gpuAcceleration:!0,offset:0,boundariesElement:"viewport",boundariesPadding:5,preventOverflowOrder:["left","right","top","bottom"],flipBehavior:"flip",arrowElement:"[x-arrow]",modifiers:["shift","offset","preventOverflow","keepTogether","arrow","flip","applyStyle"],modifiersIgnored:[],forceAbsolute:!1,forceFixed:!1};function i(t,i,o){this._reference=t.jquery?t[0]:t,this.state={};var a=null==i,s=i&&"[object Object]"===Object.prototype.toString.call(i);return this._popper=a||s?this.parse(s?i:{}):i.jquery?i[0]:i,this._options=Object.assign({},e,o),this._options.modifiers=this._options.modifiers.map(function(t){if(-1===this._options.modifiersIgnored.indexOf(t))return"applyStyle"===t&&this._popper.setAttribute("x-placement",this._options.placement),this.modifiers[t]||t}.bind(this)),this.state.position=this._getPosition(this._popper,this._reference),c(this._popper,{position:this.state.position,top:0}),this.update(),this._setupEventListeners(),this}function o(e){var i=e.style.display,o=e.style.visibility;e.style.display="block",e.style.visibility="hidden";e.offsetWidth;var a=t.getComputedStyle(e),s=parseFloat(a.marginTop)+parseFloat(a.marginBottom),n=parseFloat(a.marginLeft)+parseFloat(a.marginRight),r={width:e.offsetWidth+n,height:e.offsetHeight+s};return e.style.display=i,e.style.visibility=o,r}function a(t){var e={left:"right",right:"left",bottom:"top",top:"bottom"};return t.replace(/left|right|bottom|top/g,function(t){return e[t]})}function s(t){var e=Object.assign({},t);return e.right=e.left+e.width,e.bottom=e.top+e.height,e}function n(t,e){var i,o=0;for(i in t){if(t[i]===e)return o;o++}return null}function r(e,i){return t.getComputedStyle(e,null)[i]}function l(e){var i=e.offsetParent;return i!==t.document.body&&i?i:t.document.documentElement}function d(e){var i=e.parentNode;return i?i===t.document?t.document.body.scrollTop?t.document.body:t.document.documentElement:-1!==["scroll","auto"].indexOf(r(i,"overflow"))||-1!==["scroll","auto"].indexOf(r(i,"overflow-x"))||-1!==["scroll","auto"].indexOf(r(i,"overflow-y"))?i:d(e.parentNode):e}function c(t,e){Object.keys(e).forEach(function(i){var o,a="";-1!==["width","height","top","right","bottom","left"].indexOf(i)&&(""!==(o=e[i])&&!isNaN(parseFloat(o))&&isFinite(o))&&(a="px"),t.style[i]=e[i]+a})}function h(t){var e={width:t.offsetWidth,height:t.offsetHeight,left:t.offsetLeft,top:t.offsetTop};return e.right=e.left+e.width,e.bottom=e.top+e.height,e}function p(t){var e=t.getBoundingClientRect(),i=-1!=navigator.userAgent.indexOf("MSIE")&&"HTML"===t.tagName?-t.scrollTop:e.top;return{left:e.left,top:i,right:e.right,bottom:e.bottom,width:e.right-e.left,height:e.bottom-i}}function u(e){for(var i=["","ms","webkit","moz","o"],o=0;o<i.length;o++){var a=i[o]?i[o]+e.charAt(0).toUpperCase()+e.slice(1):e;if(void 0!==t.document.body.style[a])return a}return null}return i.prototype.destroy=function(){return this._popper.removeAttribute("x-placement"),this._popper.style.left="",this._popper.style.position="",this._popper.style.top="",this._popper.style[u("transform")]="",this._removeEventListeners(),this._options.removeOnDestroy&&this._popper.remove(),this},i.prototype.update=function(){var t={instance:this,styles:{}};t.placement=this._options.placement,t._originalPlacement=this._options.placement,t.offsets=this._getOffsets(this._popper,this._reference,t.placement),t.boundaries=this._getBoundaries(t,this._options.boundariesPadding,this._options.boundariesElement),t=this.runModifiers(t,this._options.modifiers),"function"==typeof this.state.updateCallback&&this.state.updateCallback(t)},i.prototype.onCreate=function(t){return t(this),this},i.prototype.onUpdate=function(t){return this.state.updateCallback=t,this},i.prototype.parse=function(e){var i={tagName:"div",classNames:["popper"],attributes:[],parent:t.document.body,content:"",contentType:"text",arrowTagName:"div",arrowClassNames:["popper__arrow"],arrowAttributes:["x-arrow"]};e=Object.assign({},i,e);var o=t.document,a=o.createElement(e.tagName);if(r(a,e.classNames),l(a,e.attributes),"node"===e.contentType?a.appendChild(e.content.jquery?e.content[0]:e.content):"html"===e.contentType?a.innerHTML=e.content:a.textContent=e.content,e.arrowTagName){var s=o.createElement(e.arrowTagName);r(s,e.arrowClassNames),l(s,e.arrowAttributes),a.appendChild(s)}var n=e.parent.jquery?e.parent[0]:e.parent;if("string"==typeof n){if((n=o.querySelectorAll(e.parent)).length>1&&console.warn("WARNING: the given `parent` query("+e.parent+") matched more than one element, the first one will be used"),0===n.length)throw"ERROR: the given `parent` doesn't exists!";n=n[0]}return n.length>1&&n instanceof Element==!1&&(console.warn("WARNING: you have passed as parent a list of elements, the first one will be used"),n=n[0]),n.appendChild(a),a;function r(t,e){e.forEach(function(e){t.classList.add(e)})}function l(t,e){e.forEach(function(e){t.setAttribute(e.split(":")[0],e.split(":")[1]||"")})}},i.prototype._getPosition=function(e,i){l(i);return this._options.forceAbsolute?"absolute":this._options.forceFixed?"fixed":function e(i){if(i===t.document.body)return!1;if("fixed"===r(i,"position"))return!0;return i.parentNode?e(i.parentNode):i}(i)?"fixed":"absolute"},i.prototype._getOffsets=function(t,e,i){i=i.split("-")[0];var a={};a.position=this.state.position;var s="fixed"===a.position,n=function(t,e,i){var o=p(t),a=p(e);if(i){var s=d(e);a.top+=s.scrollTop,a.bottom+=s.scrollTop,a.left+=s.scrollLeft,a.right+=s.scrollLeft}return{top:o.top-a.top,left:o.left-a.left,bottom:o.top-a.top+o.height,right:o.left-a.left+o.width,width:o.width,height:o.height}}(e,l(t),s),r=o(t);return-1!==["right","left"].indexOf(i)?(a.top=n.top+n.height/2-r.height/2,a.left="left"===i?n.left-r.width:n.right):(a.left=n.left+n.width/2-r.width/2,a.top="top"===i?n.top-r.height:n.bottom),a.width=r.width,a.height=r.height,{popper:a,reference:n}},i.prototype._setupEventListeners=function(){if(this.state.updateBound=this.update.bind(this),t.addEventListener("resize",this.state.updateBound),"window"!==this._options.boundariesElement){var e=d(this._reference);e!==t.document.body&&e!==t.document.documentElement||(e=t),e.addEventListener("scroll",this.state.updateBound)}},i.prototype._removeEventListeners=function(){if(t.removeEventListener("resize",this.state.updateBound),"window"!==this._options.boundariesElement){var e=d(this._reference);e!==t.document.body&&e!==t.document.documentElement||(e=t),e.removeEventListener("scroll",this.state.updateBound)}this.state.updateBound=null},i.prototype._getBoundaries=function(e,i,o){var a,s,n={};if("window"===o){var r=t.document.body,c=t.document.documentElement;a=Math.max(r.scrollHeight,r.offsetHeight,c.clientHeight,c.scrollHeight,c.offsetHeight),n={top:0,right:Math.max(r.scrollWidth,r.offsetWidth,c.clientWidth,c.scrollWidth,c.offsetWidth),bottom:a,left:0}}else if("viewport"===o){var p=l(this._popper),u=d(this._popper),f=h(p),m="fixed"===e.offsets.popper.position?0:(s=u)==document.body?Math.max(document.documentElement.scrollTop,document.body.scrollTop):s.scrollTop,v="fixed"===e.offsets.popper.position?0:function(t){return t==document.body?Math.max(document.documentElement.scrollLeft,document.body.scrollLeft):t.scrollLeft}(u);n={top:0-(f.top-m),right:t.document.documentElement.clientWidth-(f.left-v),bottom:t.document.documentElement.clientHeight-(f.top-m),left:0-(f.left-v)}}else n=l(this._popper)===o?{top:0,left:0,right:o.clientWidth,bottom:o.clientHeight}:h(o);return n.left+=i,n.right-=i,n.top=n.top+i,n.bottom=n.bottom-i,n},i.prototype.runModifiers=function(t,e,i){var o=e.slice();return void 0!==i&&(o=this._options.modifiers.slice(0,n(this._options.modifiers,i))),o.forEach(function(e){var i;(i=e)&&"[object Function]"==={}.toString.call(i)&&(t=e.call(this,t))}.bind(this)),t},i.prototype.isModifierRequired=function(t,e){var i=n(this._options.modifiers,t);return!!this._options.modifiers.slice(0,i).filter(function(t){return t===e}).length},i.prototype.modifiers={},i.prototype.modifiers.applyStyle=function(t){var e,i={position:t.offsets.popper.position},o=Math.round(t.offsets.popper.left),a=Math.round(t.offsets.popper.top);return this._options.gpuAcceleration&&(e=u("transform"))?(i[e]="translate3d("+o+"px, "+a+"px, 0)",i.top=0,i.left=0):(i.left=o,i.top=a),Object.assign(i,t.styles),c(this._popper,i),this._popper.setAttribute("x-placement",t.placement),this.isModifierRequired(this.modifiers.applyStyle,this.modifiers.arrow)&&t.offsets.arrow&&c(t.arrowElement,t.offsets.arrow),t},i.prototype.modifiers.shift=function(t){var e=t.placement,i=e.split("-")[0],o=e.split("-")[1];if(o){var a=t.offsets.reference,n=s(t.offsets.popper),r={y:{start:{top:a.top},end:{top:a.top+a.height-n.height}},x:{start:{left:a.left},end:{left:a.left+a.width-n.width}}},l=-1!==["bottom","top"].indexOf(i)?"x":"y";t.offsets.popper=Object.assign(n,r[l][o])}return t},i.prototype.modifiers.preventOverflow=function(t){var e=this._options.preventOverflowOrder,i=s(t.offsets.popper),o={left:function(){var e=i.left;return i.left<t.boundaries.left&&(e=Math.max(i.left,t.boundaries.left)),{left:e}},right:function(){var e=i.left;return i.right>t.boundaries.right&&(e=Math.min(i.left,t.boundaries.right-i.width)),{left:e}},top:function(){var e=i.top;return i.top<t.boundaries.top&&(e=Math.max(i.top,t.boundaries.top)),{top:e}},bottom:function(){var e=i.top;return i.bottom>t.boundaries.bottom&&(e=Math.min(i.top,t.boundaries.bottom-i.height)),{top:e}}};return e.forEach(function(e){t.offsets.popper=Object.assign(i,o[e]())}),t},i.prototype.modifiers.keepTogether=function(t){var e=s(t.offsets.popper),i=t.offsets.reference,o=Math.floor;return e.right<o(i.left)&&(t.offsets.popper.left=o(i.left)-e.width),e.left>o(i.right)&&(t.offsets.popper.left=o(i.right)),e.bottom<o(i.top)&&(t.offsets.popper.top=o(i.top)-e.height),e.top>o(i.bottom)&&(t.offsets.popper.top=o(i.bottom)),t},i.prototype.modifiers.flip=function(t){if(!this.isModifierRequired(this.modifiers.flip,this.modifiers.preventOverflow))return console.warn("WARNING: preventOverflow modifier is required by flip modifier in order to work, be sure to include it before flip!"),t;if(t.flipped&&t.placement===t._originalPlacement)return t;var e=t.placement.split("-")[0],i=a(e),o=t.placement.split("-")[1]||"",n=[];return(n="flip"===this._options.flipBehavior?[e,i]:this._options.flipBehavior).forEach(function(r,l){if(e===r&&n.length!==l+1){e=t.placement.split("-")[0],i=a(e);var d=s(t.offsets.popper),c=-1!==["right","bottom"].indexOf(e);(c&&Math.floor(t.offsets.reference[e])>Math.floor(d[i])||!c&&Math.floor(t.offsets.reference[e])<Math.floor(d[i]))&&(t.flipped=!0,t.placement=n[l+1],o&&(t.placement+="-"+o),t.offsets.popper=this._getOffsets(this._popper,this._reference,t.placement).popper,t=this.runModifiers(t,this._options.modifiers,this._flip))}}.bind(this)),t},i.prototype.modifiers.offset=function(t){var e=this._options.offset,i=t.offsets.popper;return-1!==t.placement.indexOf("left")?i.top-=e:-1!==t.placement.indexOf("right")?i.top+=e:-1!==t.placement.indexOf("top")?i.left-=e:-1!==t.placement.indexOf("bottom")&&(i.left+=e),t},i.prototype.modifiers.arrow=function(t){var e=this._options.arrowElement;if("string"==typeof e&&(e=this._popper.querySelector(e)),!e)return t;if(!this._popper.contains(e))return console.warn("WARNING: `arrowElement` must be child of its popper element!"),t;if(!this.isModifierRequired(this.modifiers.arrow,this.modifiers.keepTogether))return console.warn("WARNING: keepTogether modifier is required by arrow modifier in order to work, be sure to include it before arrow!"),t;var i={},a=t.placement.split("-")[0],n=s(t.offsets.popper),r=t.offsets.reference,l=-1!==["left","right"].indexOf(a),d=l?"height":"width",c=l?"top":"left",h=l?"left":"top",p=l?"bottom":"right",u=o(e)[d];r[p]-u<n[c]&&(t.offsets.popper[c]-=n[c]-(r[p]-u)),r[c]+u>n[p]&&(t.offsets.popper[c]+=r[c]+u-n[p]);var f=r[c]+r[d]/2-u/2-n[c];return f=Math.max(Math.min(n[d]-u-3,f),3),i[c]=f,i[h]="",t.offsets.arrow=i,t.arrowElement=e,t},Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(t){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var e=Object(t),i=1;i<arguments.length;i++){var o=arguments[i];if(null!=o){o=Object(o);for(var a=Object.keys(o),s=0,n=a.length;s<n;s++){var r=a[s],l=Object.getOwnPropertyDescriptor(o,r);void 0!==l&&l.enumerable&&(e[r]=o[r])}}}return e}}),i}),function(t){"use strict";"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&void 0!==module.exports?module.exports=t():window.Sortable=t()}(function(){"use strict";if("undefined"==typeof window||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var t,e,i,o,a,s,n,r,l,d,c,h,p,u,f,m,v,g,b,y,_,w={},C=/\s+/g,k=/left|right|inline/,x="Sortable"+(new Date).getTime(),P=window,S=P.document,F=P.parseInt,I=P.setTimeout,D=P.jQuery||P.Zepto,T=P.Polymer,E=!1,N=!1,M="draggable"in S.createElement("div"),L=!navigator.userAgent.match(/(?:Trident.*rv[ :]?11\.|msie)/i)&&((_=S.createElement("x")).style.cssText="pointer-events:auto","auto"===_.style.pointerEvents),$=!1,A=Math.abs,O=Math.min,B=[],j=[],z=at(function(t,e,i){if(i&&e.scroll){var o,a,s,n,c,h,p=i[x],u=e.scrollSensitivity,f=e.scrollSpeed,m=t.clientX,v=t.clientY,g=window.innerWidth,b=window.innerHeight;if(l!==i&&(r=e.scroll,l=i,d=e.scrollFn,!0===r)){r=i;do{if(r.offsetWidth<r.scrollWidth||r.offsetHeight<r.scrollHeight)break}while(r=r.parentNode)}r&&(o=r,a=r.getBoundingClientRect(),s=(A(a.right-m)<=u)-(A(a.left-m)<=u),n=(A(a.bottom-v)<=u)-(A(a.top-v)<=u)),s||n||(n=(b-v<=u)-(v<=u),((s=(g-m<=u)-(m<=u))||n)&&(o=P)),w.vx===s&&w.vy===n&&w.el===o||(w.el=o,w.vx=s,w.vy=n,clearInterval(w.pid),o&&(w.pid=setInterval(function(){if(h=n?n*f:0,c=s?s*f:0,"function"==typeof d)return d.call(p,c,h,t);o===P?P.scrollTo(P.pageXOffset+c,P.pageYOffset+h):(o.scrollTop+=h,o.scrollLeft+=c)},24)))}},30),H=function(t){function e(t,e){return void 0!==t&&!0!==t||(t=i.name),"function"==typeof t?t:function(i,o){var a=o.options.group.name;return e?t:t&&(t.join?t.indexOf(a)>-1:a==t)}}var i={},o=t.group;o&&"object"==_typeof(o)||(o={name:o}),i.name=o.name,i.checkPull=e(o.pull,!0),i.checkPut=e(o.put),i.revertClone=o.revertClone,t.group=i};try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){E={capture:!1,passive:N=!0}}}))}catch(t){}function R(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(t);this.el=t,this.options=e=st({},e),t[x]=this;var i={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(t.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==R.supportPointer};for(var o in i)!(o in e)&&(e[o]=i[o]);for(var a in H(e),this)"_"===a.charAt(0)&&"function"==typeof this[a]&&(this[a]=this[a].bind(this));this.nativeDraggable=!e.forceFallback&&M,X(t,"mousedown",this._onTapStart),X(t,"touchstart",this._onTapStart),e.supportPointer&&X(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(X(t,"dragover",this),X(t,"dragenter",this)),j.push(this._onDragOver),e.store&&this.sort(e.store.get(this))}function W(e,i){"clone"!==e.lastPullMode&&(i=!0),o&&o.state!==i&&(q(o,"display",i?"none":""),i||o.state&&(e.options.group.revertClone?(a.insertBefore(o,s),e._animate(t,o)):a.insertBefore(o,t)),o.state=i)}function Y(t,e,i){if(t){i=i||S;do{if(">*"===e&&t.parentNode===i||ot(t,e))return t}while(t=V(t))}return null}function V(t){var e=t.host;return e&&e.nodeType?e:t.parentNode}function X(t,e,i){t.addEventListener(e,i,E)}function G(t,e,i){t.removeEventListener(e,i,E)}function K(t,e,i){if(t)if(t.classList)t.classList[i?"add":"remove"](e);else{var o=(" "+t.className+" ").replace(C," ").replace(" "+e+" "," ");t.className=(o+(i?" "+e:"")).replace(C," ")}}function q(t,e,i){var o=t&&t.style;if(o){if(void 0===i)return S.defaultView&&S.defaultView.getComputedStyle?i=S.defaultView.getComputedStyle(t,""):t.currentStyle&&(i=t.currentStyle),void 0===e?i:i[e];e in o||(e="-webkit-"+e),o[e]=i+("string"==typeof i?"":"px")}}function U(t,e,i){if(t){var o=t.getElementsByTagName(e),a=0,s=o.length;if(i)for(;a<s;a++)i(o[a],a);return o}return[]}function J(t,e,i,a,s,n,r,l){t=t||e[x];var d=S.createEvent("Event"),c=t.options,h="on"+i.charAt(0).toUpperCase()+i.substr(1);d.initEvent(i,!0,!0),d.to=s||e,d.from=n||e,d.item=a||e,d.clone=o,d.oldIndex=r,d.newIndex=l,e.dispatchEvent(d),c[h]&&c[h].call(t,d)}function Q(t,e,i,o,a,s,n,r){var l,d,c=t[x],h=c.options.onMove;return(l=S.createEvent("Event")).initEvent("move",!0,!0),l.to=e,l.from=t,l.dragged=i,l.draggedRect=o,l.related=a||e,l.relatedRect=s||e.getBoundingClientRect(),l.willInsertAfter=r,t.dispatchEvent(l),h&&(d=h.call(c,l,n)),d}function Z(t){t.draggable=!1}function tt(){$=!1}function et(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,i=e.length,o=0;i--;)o+=e.charCodeAt(i);return o.toString(36)}function it(t,e){var i=0;if(!t||!t.parentNode)return-1;for(;t&&(t=t.previousElementSibling);)"TEMPLATE"===t.nodeName.toUpperCase()||">*"!==e&&!ot(t,e)||i++;return i}function ot(t,e){if(t){var i=(e=e.split(".")).shift().toUpperCase(),o=new RegExp("\\s("+e.join("|")+")(?=\\s)","g");return!(""!==i&&t.nodeName.toUpperCase()!=i||e.length&&((" "+t.className+" ").match(o)||[]).length!=e.length)}return!1}function at(t,e){var i,o;return function(){void 0===i&&(i=arguments,o=this,I(function(){1===i.length?t.call(o,i[0]):t.apply(o,i),i=void 0},e))}}function st(t,e){if(t&&e)for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function nt(t){return T&&T.dom?T.dom(t).cloneNode(!0):D?D(t).clone(!0)[0]:t.cloneNode(!0)}function rt(t){return I(t,0)}function lt(t){return clearTimeout(t)}return R.prototype={constructor:R,_onTapStart:function(e){var i,o=this,a=this.el,s=this.options,r=s.preventOnFilter,l=e.type,d=e.touches&&e.touches[0],c=(d||e).target,h=e.target.shadowRoot&&e.path&&e.path[0]||c,p=s.filter;if(function(t){var e=t.getElementsByTagName("input"),i=e.length;for(;i--;){var o=e[i];o.checked&&B.push(o)}}(a),!t&&!(/mousedown|pointerdown/.test(l)&&0!==e.button||s.disabled)&&!h.isContentEditable&&(c=Y(c,s.draggable,a))&&n!==c){if(i=it(c,s.draggable),"function"==typeof p){if(p.call(this,e,c,this))return J(o,h,"filter",c,a,a,i),void(r&&e.preventDefault())}else if(p&&(p=p.split(",").some(function(t){if(t=Y(h,t.trim(),a))return J(o,t,"filter",c,a,a,i),!0})))return void(r&&e.preventDefault());s.handle&&!Y(h,s.handle,a)||this._prepareDragStart(e,d,c,i)}},_prepareDragStart:function(i,o,r,l){var d,c=this,h=c.el,p=c.options,f=h.ownerDocument;r&&!t&&r.parentNode===h&&(g=i,a=h,e=(t=r).parentNode,s=t.nextSibling,n=r,m=p.group,u=l,this._lastX=(o||i).clientX,this._lastY=(o||i).clientY,t.style["will-change"]="all",d=function(){c._disableDelayedDrag(),t.draggable=c.nativeDraggable,K(t,p.chosenClass,!0),c._triggerDragStart(i,o),J(c,a,"choose",t,a,a,u)},p.ignore.split(",").forEach(function(e){U(t,e.trim(),Z)}),X(f,"mouseup",c._onDrop),X(f,"touchend",c._onDrop),X(f,"touchcancel",c._onDrop),X(f,"selectstart",c),p.supportPointer&&X(f,"pointercancel",c._onDrop),p.delay?(X(f,"mouseup",c._disableDelayedDrag),X(f,"touchend",c._disableDelayedDrag),X(f,"touchcancel",c._disableDelayedDrag),X(f,"mousemove",c._disableDelayedDrag),X(f,"touchmove",c._disableDelayedDrag),p.supportPointer&&X(f,"pointermove",c._disableDelayedDrag),c._dragStartTimer=I(d,p.delay)):d())},_disableDelayedDrag:function(){var t=this.el.ownerDocument;clearTimeout(this._dragStartTimer),G(t,"mouseup",this._disableDelayedDrag),G(t,"touchend",this._disableDelayedDrag),G(t,"touchcancel",this._disableDelayedDrag),G(t,"mousemove",this._disableDelayedDrag),G(t,"touchmove",this._disableDelayedDrag),G(t,"pointermove",this._disableDelayedDrag)},_triggerDragStart:function(e,i){(i=i||("touch"==e.pointerType?e:null))?(g={target:t,clientX:i.clientX,clientY:i.clientY},this._onDragStart(g,"touch")):this.nativeDraggable?(X(t,"dragend",this),X(a,"dragstart",this._onDragStart)):this._onDragStart(g,!0);try{S.selection?rt(function(){S.selection.empty()}):window.getSelection().removeAllRanges()}catch(t){}},_dragStarted:function(){if(a&&t){var e=this.options;K(t,e.ghostClass,!0),K(t,e.dragClass,!1),R.active=this,J(this,a,"start",t,a,a,u)}else this._nulling()},_emulateDragOver:function(){if(b){if(this._lastX===b.clientX&&this._lastY===b.clientY)return;this._lastX=b.clientX,this._lastY=b.clientY,L||q(i,"display","none");var t=S.elementFromPoint(b.clientX,b.clientY),e=t,o=j.length;if(t&&t.shadowRoot&&(e=t=t.shadowRoot.elementFromPoint(b.clientX,b.clientY)),e)do{if(e[x]){for(;o--;)j[o]({clientX:b.clientX,clientY:b.clientY,target:t,rootEl:e});break}t=e}while(e=e.parentNode);L||q(i,"display","")}},_onTouchMove:function(t){if(g){var e=this.options,o=e.fallbackTolerance,a=e.fallbackOffset,s=t.touches?t.touches[0]:t,n=s.clientX-g.clientX+a.x,r=s.clientY-g.clientY+a.y,l=t.touches?"translate3d("+n+"px,"+r+"px,0)":"translate("+n+"px,"+r+"px)";if(!R.active){if(o&&O(A(s.clientX-this._lastX),A(s.clientY-this._lastY))<o)return;this._dragStarted()}this._appendGhost(),y=!0,b=s,q(i,"webkitTransform",l),q(i,"mozTransform",l),q(i,"msTransform",l),q(i,"transform",l)}},_appendGhost:function(){if(!i){var e,o=t.getBoundingClientRect(),s=q(t),n=this.options;K(i=t.cloneNode(!0),n.ghostClass,!1),K(i,n.fallbackClass,!0),K(i,n.dragClass,!0),q(i,"top",o.top-F(s.marginTop,10)),q(i,"left",o.left-F(s.marginLeft,10)),q(i,"width",o.width),q(i,"height",o.height),q(i,"opacity","0.8"),q(i,"position","fixed"),q(i,"zIndex","100000"),q(i,"pointerEvents","none"),n.fallbackOnBody&&S.body.appendChild(i)||a.appendChild(i),e=i.getBoundingClientRect(),q(i,"width",2*o.width-e.width),q(i,"height",2*o.height-e.height)}},_onDragStart:function(e,i){var s=this,n=e.dataTransfer,r=s.options;s._offUpEvents(),m.checkPull(s,s,t,e)&&((o=nt(t)).draggable=!1,o.style["will-change"]="",q(o,"display","none"),K(o,s.options.chosenClass,!1),s._cloneId=rt(function(){a.insertBefore(o,t),J(s,a,"clone",t)})),K(t,r.dragClass,!0),i?("touch"===i?(X(S,"touchmove",s._onTouchMove),X(S,"touchend",s._onDrop),X(S,"touchcancel",s._onDrop),r.supportPointer&&(X(S,"pointermove",s._onTouchMove),X(S,"pointerup",s._onDrop))):(X(S,"mousemove",s._onTouchMove),X(S,"mouseup",s._onDrop)),s._loopId=setInterval(s._emulateDragOver,50)):(n&&(n.effectAllowed="move",r.setData&&r.setData.call(s,n,t)),X(S,"drop",s),s._dragStartId=rt(s._dragStarted))},_onDragOver:function(n){var r,l,d,u,f=this.el,g=this.options,b=g.group,_=R.active,w=m===b,C=!1,P=g.sort;if(void 0!==n.preventDefault&&(!N&&n.preventDefault(),!g.dragoverBubble&&n.stopPropagation()),!t.animated&&(y=!0,_&&!g.disabled&&(w?P||(u=!a.contains(t)):v===this||(_.lastPullMode=m.checkPull(this,_,t,n))&&b.checkPut(this,_,t,n))&&(void 0===n.rootEl||n.rootEl===this.el))){if(z(n,g,this.el),$)return;if(r=Y(n.target,g.draggable,f),l=t.getBoundingClientRect(),v!==this&&(v=this,C=!0),u)return W(_,!0),e=a,void(o||s?a.insertBefore(t,o||s):P||a.appendChild(t));if(0===f.children.length||f.children[0]===i||f===n.target&&function(t,e){var i=t.lastElementChild.getBoundingClientRect();return e.clientY-(i.top+i.height)>5||e.clientX-(i.left+i.width)>5}(f,n)){if(0!==f.children.length&&f.children[0]!==i&&f===n.target&&(r=f.lastElementChild),r){if(r.animated)return;d=r.getBoundingClientRect()}W(_,w),!1!==Q(a,f,t,l,r,d,n)&&(t.contains(f)||(f.appendChild(t),e=f),this._animate(l,t),r&&this._animate(d,r))}else if(r&&!r.animated&&r!==t&&void 0!==r.parentNode[x]){c!==r&&(c=r,h=q(r),p=q(r.parentNode));var S=(d=r.getBoundingClientRect()).right-d.left,F=d.bottom-d.top,D=k.test(h.cssFloat+h.display)||"flex"==p.display&&0===p["flex-direction"].indexOf("row"),T=r.offsetWidth>t.offsetWidth,E=r.offsetHeight>t.offsetHeight,M=(D?(n.clientX-d.left)/S:(n.clientY-d.top)/F)>.5,L=r.nextElementSibling,A=!1;if(D){var O=t.offsetTop,B=r.offsetTop;A=O===B?r.previousElementSibling===t&&!T||M&&T:r.previousElementSibling===t||t.previousElementSibling===r?(n.clientY-d.top)/F>.5:B>O}else C||(A=L!==t&&!E||M&&E);var j=Q(a,f,t,l,r,d,n,A);!1!==j&&(1!==j&&-1!==j||(A=1===j),$=!0,I(tt,30),W(_,w),t.contains(f)||(A&&!L?f.appendChild(t):r.parentNode.insertBefore(t,A?L:r)),e=t.parentNode,this._animate(l,t),this._animate(d,r))}}},_animate:function(t,e){var i=this.options.animation;if(i){var o=e.getBoundingClientRect();1===t.nodeType&&(t=t.getBoundingClientRect()),q(e,"transition","none"),q(e,"transform","translate3d("+(t.left-o.left)+"px,"+(t.top-o.top)+"px,0)"),e.offsetWidth,q(e,"transition","all "+i+"ms"),q(e,"transform","translate3d(0,0,0)"),clearTimeout(e.animated),e.animated=I(function(){q(e,"transition",""),q(e,"transform",""),e.animated=!1},i)}},_offUpEvents:function(){var t=this.el.ownerDocument;G(S,"touchmove",this._onTouchMove),G(S,"pointermove",this._onTouchMove),G(t,"mouseup",this._onDrop),G(t,"touchend",this._onDrop),G(t,"pointerup",this._onDrop),G(t,"touchcancel",this._onDrop),G(t,"pointercancel",this._onDrop),G(t,"selectstart",this)},_onDrop:function(n){var r=this.el,l=this.options;clearInterval(this._loopId),clearInterval(w.pid),clearTimeout(this._dragStartTimer),lt(this._cloneId),lt(this._dragStartId),G(S,"mouseover",this),G(S,"mousemove",this._onTouchMove),this.nativeDraggable&&(G(S,"drop",this),G(r,"dragstart",this._onDragStart)),this._offUpEvents(),n&&(y&&(!N&&n.preventDefault(),!l.dropBubble&&n.stopPropagation()),i&&i.parentNode&&i.parentNode.removeChild(i),a!==e&&"clone"===R.active.lastPullMode||o&&o.parentNode&&o.parentNode.removeChild(o),t&&(this.nativeDraggable&&G(t,"dragend",this),Z(t),t.style["will-change"]="",K(t,this.options.ghostClass,!1),K(t,this.options.chosenClass,!1),J(this,a,"unchoose",t,e,a,u),a!==e?(f=it(t,l.draggable))>=0&&(J(null,e,"add",t,e,a,u,f),J(this,a,"remove",t,e,a,u,f),J(null,e,"sort",t,e,a,u,f),J(this,a,"sort",t,e,a,u,f)):t.nextSibling!==s&&(f=it(t,l.draggable))>=0&&(J(this,a,"update",t,e,a,u,f),J(this,a,"sort",t,e,a,u,f)),R.active&&(null!=f&&-1!==f||(f=u),J(this,a,"end",t,e,a,u,f),this.save()))),this._nulling()},_nulling:function(){a=t=e=i=s=o=n=r=l=g=b=y=f=c=h=v=m=R.active=null,B.forEach(function(t){t.checked=!0}),B.length=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragover":case"dragenter":t&&(this._onDragOver(e),function(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move");!N&&t.preventDefault()}(e));break;case"mouseover":this._onDrop(e);break;case"selectstart":e.preventDefault()}},toArray:function(){for(var t,e=[],i=this.el.children,o=0,a=i.length,s=this.options;o<a;o++)Y(t=i[o],s.draggable,this.el)&&e.push(t.getAttribute(s.dataIdAttr)||et(t));return e},sort:function(t){var e={},i=this.el;this.toArray().forEach(function(t,o){var a=i.children[o];Y(a,this.options.draggable,i)&&(e[t]=a)},this),t.forEach(function(t){e[t]&&(i.removeChild(e[t]),i.appendChild(e[t]))})},save:function(){var t=this.options.store;t&&t.set(this)},closest:function(t,e){return Y(t,e||this.options.draggable,this.el)},option:function(t,e){var i=this.options;if(void 0===e)return i[t];i[t]=e,"group"===t&&H(i)},destroy:function(){var t=this.el;t[x]=null,G(t,"mousedown",this._onTapStart),G(t,"touchstart",this._onTapStart),G(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(G(t,"dragover",this),G(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),j.splice(j.indexOf(this._onDragOver),1),this._onDrop(),this.el=t=null}},X(S,"touchmove",function(t){R.active&&t.preventDefault()}),R.utils={on:X,off:G,css:q,find:U,is:function(t,e){return!!Y(t,e,t)},extend:st,throttle:at,closest:Y,toggleClass:K,clone:nt,index:it,nextTick:rt,cancelNextTick:lt},R.create=function(t,e){return new R(t,e)},R.version="1.6.1",R}),function(t,e){"function"==typeof define&&define.amd?define(e):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=e():t.ResizeSensor=e()}("undefined"!=typeof window?window:this,function(){if("undefined"==typeof window)return null;var t=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){return window.setTimeout(t,20)};function e(t,e){var i=Object.prototype.toString.call(t),o="[object Array]"===i||"[object NodeList]"===i||"[object HTMLCollection]"===i||"[object Object]"===i||"undefined"!=typeof jQuery&&t instanceof jQuery||"undefined"!=typeof Elements&&t instanceof Elements,a=0,s=t.length;if(o)for(;a<s;a++)e(t[a]);else e(t)}function i(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var e=t.getBoundingClientRect();return{width:Math.round(e.width),height:Math.round(e.height)}}var o=function o(a,s){function n(){var t,e,i=[];this.add=function(t){i.push(t)},this.call=function(){for(t=0,e=i.length;t<e;t++)i[t].call()},this.remove=function(o){var a=[];for(t=0,e=i.length;t<e;t++)i[t]!==o&&a.push(i[t]);i=a},this.length=function(){return i.length}}e(a,function(e){!function(e,o){if(e)if(e.resizedAttached)e.resizedAttached.add(o);else{e.resizedAttached=new n,e.resizedAttached.add(o),e.resizeSensor=document.createElement("div"),e.resizeSensor.dir="ltr",e.resizeSensor.className="resize-sensor";var a="position: absolute; left: -10px; top: -10px; right: 0; bottom: 0; overflow: hidden; z-index: -1; visibility: hidden;",s="position: absolute; left: 0; top: 0; transition: 0s;";e.resizeSensor.style.cssText=a,e.resizeSensor.innerHTML='<div class="resize-sensor-expand" style="'+a+'"><div style="'+s+'"></div></div><div class="resize-sensor-shrink" style="'+a+'"><div style="'+s+' width: 200%; height: 200%"></div></div>',e.appendChild(e.resizeSensor);var r=window.getComputedStyle(e).getPropertyValue("position");"absolute"!==r&&"relative"!==r&&"fixed"!==r&&(e.style.position="relative");var l,d,c=e.resizeSensor.childNodes[0],h=c.childNodes[0],p=e.resizeSensor.childNodes[1],u=i(e),f=u.width,m=u.height,v=function(){var t=0===e.offsetWidth&&0===e.offsetHeight;if(t){var i=e.style.display;e.style.display="block"}h.style.width="100000px",h.style.height="100000px",c.scrollLeft=1e5,c.scrollTop=1e5,p.scrollLeft=1e5,p.scrollTop=1e5,t&&(e.style.display=i)};e.resizeSensor.resetSensor=v;var g=function(){d=0,l&&(f=void 0,m=void 0,e.resizedAttached&&e.resizedAttached.call())},b=function(){var o=i(e),a=o.width,s=o.height;(l=a!=f||s!=m)&&!d&&(d=t(g)),v()},y=function(t,e,i){t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener(e,i)};y(c,"scroll",b),y(p,"scroll",b),t(v)}}(e,s)}),this.detach=function(t){o.detach(a,t)},this.reset=function(){a.resizeSensor.resetSensor()}};return o.reset=function(t,i){e(t,function(t){t.resizeSensor.resetSensor()})},o.detach=function(t,i){e(t,function(t){t&&(t.resizedAttached&&"function"==typeof i&&(t.resizedAttached.remove(i),t.resizedAttached.length())||t.resizeSensor&&(t.contains(t.resizeSensor)&&t.removeChild(t.resizeSensor),delete t.resizeSensor,delete t.resizedAttached))})},o}),function(t,e,i,o){var a,s,n,r,l="ontouchstart"in i,d=function(){var t=i.createElement("div"),o=i.documentElement;if(!("pointerEvents"in t.style))return!1;t.style.pointerEvents="auto",t.style.pointerEvents="x",o.appendChild(t);var a=e.getComputedStyle&&"auto"===e.getComputedStyle(t,"").pointerEvents;return o.removeChild(t),!!a}(),c={listNodeName:"ol",itemNodeName:"li",rootClass:"dd",listClass:"dd-list",itemClass:"dd-item",dragClass:"dd-dragel",handleClass:"dd-handle",collapsedClass:"dd-collapsed",placeClass:"dd-placeholder",noDragClass:"dd-nodrag",emptyClass:"dd-empty",dragDisableClass:"dd-drag-disabled",dropDisableClass:"dd-drop-disabled",expandBtnHTML:'<button class="dd-expand" data-action="expand" type="button">Expand</button>',collapseBtnHTML:'<button class="dd-collapse" data-action="collapse" type="button">Collapse</button>',group:0,maxDepth:5,threshold:20,dragSortable:!0},h={};function p(e,o){this.w=t(i),this.el=t(e),this.options=t.extend({},c,o),this.init()}_autoScroll=(a=function(t,i,o){if(o){var a,s,n,r,l,d,c,p=t.clientX,u=t.clientY,f=e.innerWidth,m=e.innerHeight;if(!(c=(a=o).parentsUntil(".jz-table",".scrollbar-wrap")).length)return;s=c[0].getBoundingClientRect(),n=(Math.abs(s.right-p)<=30)-(Math.abs(s.left-p)<=30),r=(Math.abs(s.bottom-u)<=30)-(Math.abs(s.top-u)<=30),n||r||(r=(m-u<=30)-(u<=30),((n=(f-p<=30)-(p<=30))||r)&&(a=e)),h.vx===n&&h.vy===r&&h.el===a||(h.el=a,h.vx=n,h.vy=r,clearInterval(h.pid),a&&(h.pid=setInterval(function(){d=r?3*r:0,l=n?3*n:0,a===e?e.scrollTo(e.pageXOffset+l,e.pageYOffset+d):(c[0].scrollTop+=d,c[0].scrollLeft+=l)},24)))}},s=30,function(){void 0===n&&(n=arguments,r=this,setTimeout(function(){1===n.length?a.call(r,n[0]):a.apply(r,n),n=void 0},s))}),p.prototype={init:function(){var i=this;i.reset(),i.el.data("nestable-group",this.options.group),i.placeEl=t('<div class="'+i.options.placeClass+'"/>'),i.el.on("click","button",function(e){if(!i.dragEl){var o=t(e.currentTarget),a=o.data("action"),s=o.parent(i.options.itemNodeName);"collapse"===a&&i.collapseItem(s),"expand"===a&&i.expandItem(s)}});var o=function(e){var o=t(e.target),a=o.attr("class");if(void 0!==a&&!(a.indexOf("jz-sort")>-1||a.indexOf("jz-checkbox")>-1||a.indexOf("jz-radio")>-1||a.indexOf("jz-input")>-1||a.indexOf("jz-table-event-initial")>-1||a.indexOf("jz-select")>-1||a.indexOf("tag-delete")>-1)){if(!o.hasClass(i.options.handleClass)){if(o.closest("."+i.options.noDragClass).length)return;o=o.closest("."+i.options.handleClass)}o.length&&!i.dragEl&&(o.parent("."+i.options.itemClass).hasClass(i.options.dragDisableClass)||(i.isTouch=/^touch/.test(e.type),i.isTouch&&1!==e.touches.length||(e.preventDefault(),i.dragStart(e.touches?e.touches[0]:e))))}},a=function(t){i.dragEl&&(t.preventDefault(),i.dragMove(t.touches?t.touches[0]:t))},s=function(t){i.dragEl&&(t.preventDefault(),i.dragStop(t.touches?t.touches[0]:t))};i.options.dragSortable&&(l&&(i.el[0].addEventListener("touchstart",o,!1),e.addEventListener("touchmove",a,!1),e.addEventListener("touchend",s,!1),e.addEventListener("touchcancel",s,!1)),i.el.off("mousedown.nestable-d").on("mousedown.nestable-d",o),i.w.off("mousedown.nestable-m").on("mousemove.nestable-m",a),i.w.off("mousedown.nestable-u").on("mouseup.nestable-u",s))},serialize:function(){var e=this;return step=function(t){function e(e,i){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(i,o){var a=[];return i.children(e.options.itemNodeName+":not(.J-expand-row)").each(function(){var i=t(this),s=t.extend({},JSON.parse(i.attr("data-id"))),n=i.children(e.options.listNodeName);n.length&&(s.children=step(n,o+1)),a.push(s)}),a}),step(e.el.find(e.options.listNodeName).first(),0)},serialise:function(){return this.serialize()},reset:function(){this.mouse={offsetX:0,offsetY:0,startX:0,startY:0,lastX:0,lastY:0,nowX:0,nowY:0,distX:0,distY:0,dirAx:0,dirX:0,dirY:0,lastDirX:0,lastDirY:0,distAxX:0,distAxY:0},this.isTouch=!1,this.moving=!1,this.dragEl=null,this.dragRootEl=null,this.dragDepth=0,this.hasNewRoot=!1,this.pointEl=null,this._collapsed=!1,clearInterval(h.pid)},expandItem:function(t){t.removeClass(this.options.collapsedClass),t.children('[data-action="expand"]').hide(),t.children('[data-action="collapse"]').show(),t.children(this.options.listNodeName).show()},collapseItem:function(t){t.children(this.options.listNodeName).length&&(t.addClass(this.options.collapsedClass),t.children('[data-action="collapse"]').hide(),t.children('[data-action="expand"]').show(),t.children(this.options.listNodeName).hide())},expandAll:function(){var e=this;e.el.find(e.options.itemNodeName).each(function(){e.expandItem(t(this))})},collapseAll:function(){var e=this;e.el.find(e.options.itemNodeName).each(function(){e.collapseItem(t(this))})},setParent:function(e){!e.children(this.options.listNodeName).length||e.children(".dd-expand").length||e.children(".dd-collapse").length||(e.prepend(t(this.options.expandBtnHTML)),e.prepend(t(this.options.collapseBtnHTML))),e.children('[data-action="expand"]').hide()},unsetParent:function(t){t.removeClass(this.options.collapsedClass),t.children("[data-action]").remove(),t.children(this.options.listNodeName).remove()},dragStart:function(e){var o=this.mouse,a=t(e.target),s=a.closest(this.options.itemNodeName);s.find(".dd-collapse").is(":hidden")&&(this._collapsed=!0),this.collapseItem(s),this.placeEl.css("height",s.height()),o.offsetX=void 0!==e.offsetX?e.offsetX:e.pageX-a.offset().left,o.offsetY=void 0!==e.offsetY?e.offsetY:e.pageY-a.offset().top,o.startX=o.lastX=e.pageX,o.startY=o.lastY=e.pageY,this.dragRootEl=this.el,this.dragEl=t(i.createElement(this.options.listNodeName)).addClass(this.options.listClass+" "+this.options.dragClass),this.dragEl.css("width",s.width()),s.after(this.placeEl),s[0].parentNode.removeChild(s[0]),s.appendTo(this.dragEl),t(i.body).append(this.dragEl),this.dragEl.css({left:e.pageX-o.offsetX,top:e.pageY-o.offsetY});var n,r,l=this.dragEl.find(this.options.itemNodeName);for(n=0;n<l.length;n++)(r=t(l[n]).parents(this.options.listNodeName).length)>this.dragDepth&&(this.dragDepth=r);r>1&&this.dragEl.addClass("dd-multiShadow")},dragStop:function(t){var e=this.dragEl.children(this.options.itemNodeName).first();e[0].parentNode.removeChild(e[0]),this.placeEl.replaceWith(e),this.dragEl.remove(),this.el.trigger("drag-change"),this.hasNewRoot&&this.dragRootEl.trigger("drag-change"),this._collapsed||this.expandItem(e),this.reset(),e.removeClass("dd-multiShadow")},dragMove:function(o){var a,s,n,r=this.options,l=this.mouse;this.dragEl.css({left:o.pageX-l.offsetX,top:o.pageY-l.offsetY}),l.lastX=l.nowX,l.lastY=l.nowY,l.nowX=o.pageX,l.nowY=o.pageY,l.distX=l.nowX-l.lastX,l.distY=l.nowY-l.lastY,l.lastDirX=l.dirX,l.lastDirY=l.dirY,l.dirX=0===l.distX?0:l.distX>0?1:-1,l.dirY=0===l.distY?0:l.distY>0?1:-1;var c=Math.abs(l.distX)>Math.abs(l.distY)?1:0;if(!l.moving)return l.dirAx=c,void(l.moving=!0);_autoScroll(o,r,this.el),l.dirAx!==c?(l.distAxX=0,l.distAxY=0):(l.distAxX+=Math.abs(l.distX),0!==l.dirX&&l.dirX!==l.lastDirX&&(l.distAxX=0),l.distAxY+=Math.abs(l.distY),0!==l.dirY&&l.dirY!==l.lastDirY&&(l.distAxY=0)),l.dirAx=c,l.dirAx&&l.distAxX>=r.threshold&&(l.distAxX=0,n=this.placeEl.prev(r.itemNodeName),l.distX>0&&n.length&&!n.hasClass(r.collapsedClass)&&(a=n.find(r.listNodeName).last(),this.placeEl.parents(r.listNodeName).length+this.dragDepth<=r.maxDepth&&(a.length?(a=n.children(r.listNodeName).last()).append(this.placeEl):((a=t("<"+r.listNodeName+"/>").addClass(r.listClass)).append(this.placeEl),n.append(a),this.setParent(n)))),l.distX<0&&(this.placeEl.next(r.itemNodeName),s=this.placeEl.parent(),this.placeEl.closest(r.itemNodeName).after(this.placeEl),s.children().length||this.unsetParent(s.parent())));var h=!1;if(d||(this.dragEl[0].style.visibility="hidden"),this.pointEl=t(i.elementFromPoint(o.pageX-i.body.scrollLeft,o.pageY-(e.pageYOffset||i.documentElement.scrollTop))),d||(this.dragEl[0].style.visibility="visible"),this.pointEl.hasClass(r.handleClass)&&(this.pointEl=this.pointEl.parent(r.itemNodeName)),this.pointEl.hasClass(r.emptyClass))h=!0;else if(!this.pointEl.length||!this.pointEl.hasClass(r.itemClass))return;var p=this.pointEl.closest("."+r.rootClass),u=this.dragRootEl.data("nestable-id")!==p.data("nestable-id");if(!l.dirAx||u||h){if(u&&r.group!==p.data("nestable-group"))return;if(this.pointEl.hasClass(r.dropDisableClass))return;if(this.dragDepth-1+this.pointEl.parents(r.listNodeName).length>r.maxDepth)return;var f=o.pageY<this.pointEl.offset().top+this.pointEl.height()/2;s=this.placeEl.parent(),h?((a=t(i.createElement(r.listNodeName)).addClass(r.listClass)).append(this.placeEl),this.pointEl.replaceWith(a)):f?this.pointEl.before(this.placeEl):this.pointEl.after(this.placeEl),s.children().length||this.unsetParent(s.parent()),this.dragRootEl.find(r.itemNodeName).length||this.dragRootEl.append('<div class="'+r.emptyClass+'"/>'),u&&(this.dragRootEl=p,this.hasNewRoot=this.el[0]!==this.dragRootEl[0])}}},t.fn.nestable=function(e){var i=this;return this.each(function(){var o=t(this).data("nestable");o?"string"==typeof e&&"function"==typeof o[e]&&(i=o[e]()):(t(this).data("nestable",new p(this,e)),t(this).data("nestable-id",(new Date).getTime()))}),i||this}}(window.jQuery,window,document);