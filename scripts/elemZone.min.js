!function(e,t,o,i,a){function n(n){var l,r=".elemZoneModule:visible:not(.J_popupZoneContent):not(.jz_elem_zone_no_connect), .J_moduleZone:visible, .column:visible, .J_packContent:visible, .formTabButtonList,.formTabButtonYList,.formStyle29 .formTabContent,.fullmeasureContent:visible,.J_placeholderStyle",d=".form:not(.moduleSortableHelper, .tmpForm):visible, #fk-webHeaderZone, #localer, #corpTitle, #nav2, .J_tabPackContent",u=!1,m=n.hasClass("jz_elem_zone_no_connect");(m||n.hasClass("J_popupZoneContent")||n.hasClass("J_subNavPack"))&&(r=!1),n.sortable("destroy"),n.sortable({items:'.form:not(".fk_form_unsortable"), .J_tmp_form',cancel:'.formLockEdit, input, textarea, select, .fk_form_unsortable, embed[type="application/x-shockwave-flash"], object[type="application/x-shockwave-flash"], .addNewModule, .siteFormMiddle, .msgPanel_N, .msgAddText_N, .msgCaptcha_N, .msgAddButton_N, .J_panoramaViewer',connectWith:r,distance:3,tolerance:"pointer",dropOnEmpty:!0,scrollSensitivity:5,placeholder:"J_placeholder",zIndex:0,scroll:!m,smartguides:d,containment:a,create:function(e,t){},beforeStart:function(o,i){Site.checkNestModule(e(i.item));n.sortable("option","smartguides",d),"drag"==t.getFrom()?function(t,o,i){e(o.item).addClass("J_floatDragModuleHelper")}(0,i):Fai.top.dragToAddModule?(n.sortable("option","smartguides",""),function(o,i,a){var n=e(i.item);Fai.top.$("#g_main").find(".J_placeholder").remove(),Site.disableEditLayer(),Fai.stopInterval(null),Fai.top.$("body").disableSelection(),Fai.top.dragInSortable=!0,t.setOriginalParent(n)}(0,i)):function(o,i,a){var n=e(i.item),l=Site.checkNestModule(n),r=e(a),s=r.attr("id");n.append("<div class='J_moduleOverlay fk-moduleOverlay'></div>"),Site.disableEditLayer(),Fai.stopInterval(null),Fai.top.$("body").disableSelection(),Fai.top.$("#g_main").find(".J_placeholder").remove(),Fai.top.$(".fillContentRelative").css("z-index","10"),n.hasClass("formStyle32")&&n.attr("_width",n.width());e(".formTabCntId").sortable("option","disabled",!0),e(".formTabCntId").children(".form").addClass("fk_form_unsortable"),e(".formTab").sortable("option","disabled",!0),(i.item.hasClass("formStyle29")||i.item.hasClass("formStyle110"))&&(e(".formTabButtonList").sortable("option","disabled",!0),e(".formTabButtonYList").sortable("option","disabled",!0),e(".formTabContent").sortable("option","disabled",!0),e(".formTab").sortable("option","disabled",!0));e(".column .form, .floatForms .form, .absForms .form").each(function(){e(this).hasClass("formStyle35")&&e(this).find(".form .formTab").removeClass("column")}),l.parentId>0&&Site.setModuleAttrDataChange(l.parentId);t.setOriginalParentId(s),t.setOriginalParent(r),t.setCloneHelper(Site.sortableHelper.cloneHelper(i,o)),t.setReceiveId(s),t.setReceiveParent(r),t.setOverParentId(s),t.setOverParent(r),t.setPrevModule(n.prevAll(".form").first()),t.setFrom("elemZone"),t.setWidth(n.width()),t.setHeight(n.height());n.parent().append("<div class='jz_placeholder_stay_at_home J_placeholder_stay_at_home' style = 'width:100%;height:100%;'></div>"),r.addClass("jz_placeholder_wrap_original")}(o,i,this),u=!0,l=Site.undoGetElemInfo(e(i.item),"sort")},start:function(o,i){e(i.item).hasClass("formStyle97")||Site.isCartModule(e(i.item))?e(i.item).hasClass("formStyle97")?n.sortable("option","connectWith",".J_moduleZone:visible:not(.fk-inBannerListZone), .J_packContent:visible, .elemZone:visible:not(.fk-inBannerListZone)"):n.sortable("option","connectWith",".J_moduleZone:visible, .J_packContent:visible, .elemZone:visible"):n.sortable("option","connectWith",r),"drag"==t.getFrom()||(Fai.top.dragToAddModule?function(e,t,o){h("over",o,t.item)}(0,i,this):function(o,i,a){var n;t.getOriginalParentId()==e(a).attr("id")?(e(i.helper).show(),t.getCloneHelper().hide()):(e(i.helper).hide(),t.getCloneHelper().show());e(a).sortable("refresh"),e(i.item).hasClass("formStyle79")&&Site.removeHoverEftDialog&&(n=e(i.item).attr("id"))&&Site.removeHoverEftDialog(n.replace("module",""))}(0,i,this)),m&&e(i.item).hasClass("form")&&Site.boundary.init(e(i.item))},over:function(o,i){"drag"==t.getFrom()||(Fai.top.dragToAddModule?function(t,o,i){e(i).hasClass("J_bottomFloatLayerContent")&&c(".J_bottomFloatLayerContent");e(i).hasClass("J_topAdvContent")&&c(".J_topAdvContent");h("over",i,o.item);var a=e(i);if(a.hasClass("J_packContent")){var n=e("#module"+a.attr("id").replace("fk-packContent",""));n.parent().hasClass("column")&&n.parent().children(".form").last().is(n)&&(e(".J_tmp_form").remove(),n.after(e('<div class="f_tmp_form J_tmp_form"></div>')))}}(0,i,this):function(o,i,a){var n,l=(n=e(a)).attr("id");t.getOverParent();if(t.setOverParentId(l),t.setOverParent(n),h("over",a,i.item),(n=e(a)).hasClass("J_packContent")){var r=e("#module"+n.attr("id").replace("fk-packContent",""));r.parent().hasClass("column")&&r.parent().children(".form").last().is(r)&&(e(".J_tmp_form").remove(),r.after(e('<div class="f_tmp_form J_tmp_form"></div>')))}}(0,i,this))},out:function(o,i){"drag"==t.getFrom()?function(t,o,i){h("out",i),e(o.helper).removeClass("fk-dragInZone"),Site.floatData.reset()}(0,i,this):Fai.top.dragToAddModule?function(t,o,i){e(i).hasClass("J_bottomFloatLayerContent")&&p();e(i).hasClass("J_topAdvContent")&&p();h("out",i);var a=e(i);if(a.hasClass("J_packContent")){var n=e("#module"+a.attr("id").replace("fk-packContent",""));n.parent().hasClass("column")&&n.parent().children(".form").last().is(n)&&e(".J_tmp_form").remove()}}(0,0,this):function(o,i,a){h("out",a),s(a),t.getOriginalParentId()!=e(a).attr("id")?(e(i.helper).hide(),t.getCloneHelper()&&t.getCloneHelper().show(),h("originZoneOut",a)):(e(i.helper).show(),t.getCloneHelper()&&t.getCloneHelper().hide());var n=e(a);if(n.hasClass("J_packContent")){var l=e("#module"+n.attr("id").replace("fk-packContent",""));l.parent().hasClass("column")&&l.parent().children(".form").last().is(l)&&e(".J_tmp_form").remove()}}(0,i,this)},sort:function(o,i){"drag"==t.getFrom()?function(t,o,i){var a=e(o.item);if(a.hasClass("formStyle87")||a.hasClass("formStyle35")||a.hasClass("formStyle29")||a.hasClass("formStyle110")||a.hasClass("formStyle80"))return;h("over",i,o.item),e(o.helper).addClass("fk-dragInZone"),Site.floatData.setDragIn("elemZone")}(0,i,this):Fai.top.dragToAddModule?function(t,o,i){h("sort",i,o.item),e(o.placeholder).show()}(0,i,this):function(o,i,a){e(".moduleSortableHelperWrap").show(),Site.sortableHelper.cloneHelperMove(i);var n=e(i.placeholder).show();if(e(".J_placeholder_wrap").removeClass("J_placeholder_wrap jz_placeholder_wrap"),n.parent().addClass("J_placeholder_wrap jz_placeholder_wrap"),e(".J_placeholder").removeClass("jz_placeholder jz_placeholder_disabled"),n.addClass("jz_placeholder"),Site.resizeModule.showHandles(e(i.item)),e(i.helper).hasClass("formStyle97")||Site.isCartModule(e(i.helper))){var l=e(i.item),r=l.width(),s=l.height(),d=t.getOriginalParent(),c=d.width(),p=d.height(),f=d.offset().left,u=d.offset().top,m=i.offset.left,g=i.offset.top,b=Site.checkNestModule(l);if(moduleMoveOffset=i.offset,t.getOriginalParentId()==t.getOverParentId()){if(m+r<f||m>f+c||g+s<u||g>u+p)return t.getCloneHelper()&&t.getCloneHelper().show(),void(b.inPopupZone||h("originZoneOut",a));e(i.helper).show(),t.getCloneHelper()&&t.getCloneHelper().hide()}else e(i.helper).hide(),t.getCloneHelper()&&t.getCloneHelper().show(),h("originZoneOut",a)}else t.getOriginalParentId()==t.getOverParentId()?(e(i.helper).show(),t.getCloneHelper()&&t.getCloneHelper().hide()):(e(i.helper).hide(),t.getCloneHelper()&&t.getCloneHelper().show(),h("originZoneOut",a));h("sort",i.placeholder.parentsUntil(".form"),i.item),function(t){var o=null,i=null;if(e(t.placeholder).parent().hasClass("formTabButtonList")||e(t.placeholder).parent().hasClass("formTabButtonYList")){var a=e("#module"+e(t.placeholder).parents(".form").attr("_moduleid"));a.hasClass("formStyle110")||(o=(o=e("#formTabContent"+e(t.placeholder).parents(".form").attr("_moduleid"))).find(".jz_placeholder_stay_at_home").length>0?o.find(".jz_placeholder_stay_at_home"):o)}else e(t.placeholder).parent().hasClass("formTabContent")&&(o=e("#formTabButtonList"+e(t.placeholder).parents(".form").attr("_moduleid")));o?(o.addClass("J_placeholder_wrap jz_placeholder_wrap"),(i=o.children(".J_placeholder__clone")).length||(e(".J_placeholder__clone").remove(),i=e(t.placeholder).clone().addClass("J_placeholder__clone").appendTo(o)),i.addClass("jz_placeholder")):e(".J_placeholder__clone").length&&(e(".J_placeholder__clone").parent().removeClass("J_placeholder_wrap jz_placeholder_wrap"),e(".J_placeholder__clone").remove())}(i),e(container).sortable("refreshPositions"),Site.move_formStyle97(e(i.helper),!1),e(i.item).find(".ui-resizable-handle").show(),Fai.top.$(".J_fkEditor_tool").hide()}(0,i,this),m&&e(i.item).hasClass("form")&&Site.boundary.refresh(e(i.item))},receive:function(o,a){if(i.isZoneDisableModule(a.item,e(this)))return Fai.top.dragToAddModule?(f(o,a,this),Fai.ing("添加失败，容器内无法添加排版模块，请移动到其他位置",200)):Fai.ing("移动失败，容器内无法添加排版模块，请移动到其他位置",200),a.sender.sortable("cancel"),s(this),void(Fai.top._cancelAdd=!0);if(Fai.top._cancelAdd=!1,"drag"==t.getFrom())n=e(this),l=n.attr("id"),t.setReceiveId(l),t.setReceiveParent(n),t.setReceive("elemZone"),n.hasClass("J_moduleZone")?t.setReceiveDetail("moduleZone"):n.hasClass("J_packContent")&&t.setReceiveDetail("pack");else{if(!a.placeholder)return;Fai.top.dragToAddModule?f(o,a,this):function(o,i,a){var n=e(a),l=n.attr("id");t.setReceiveId(l),t.setReceiveParent(n),t.setReceive("elemZone"),n.hasClass("J_moduleZone")?t.setReceiveDetail("moduleZone"):n.hasClass("J_packContent")&&t.setReceiveDetail("pack");var r=t.getOriginalParent(),s=r.hasClass("J_packContent"),d=r.hasClass("J_moduleZone"),h=r.hasClass("elemZone"),c=n.hasClass("J_fullmeasurePackContent"),p=n.hasClass("J_packContent"),f=e(i.item);if(s||d||h||c||p&&f.hasClass("formStyle110"));else{var u=f.attr("_modulestyle"),m=Site.dragToAddModuleData.getWidth(u);t.setWidth(m)}}(0,a,this)}var n,l},update:function(e,o){if("drag"==t.getFrom());else if(!o.placeholder)return},beforeStop:function(o,i){"drag"==t.getFrom()||(Fai.top.dragToAddModule?function(e,o,i){t.setStopOffset(o.offset)}(0,i):function(e,o,i){var a=t.getCloneHelper();t.setStopOffset(a.offset()),Site.sortableHelper.resetSortableHelper(o)}(0,i)),e(".J_placeholder_stay_at_home").remove()},stop:function(n,r){var d=Fai.top.$(".J_zoneEditTip:visible");if(d.length>0&&!d.parent().is(e(this)))return!1;var c=e("#bottomFloatLayerForms");if(!c.find(".J_zoneEditTip:visible").length||c.is(e(this))){var p=e("#topAdvForms");if(!p.find(".J_zoneEditTip:visible").length||p.is(e(this))){t.getReceiveParent(),t.getReceiveId();var f,g,b,v,C=t.getOriginalParent(),_=!1;if("drag"==t.getFrom())b=function(t,o,i){h("reset",i),e(o.item).remove(),Site.moduleChangeParentCallback()}(0,r,this);else{if(!r.placeholder)return;if(Fai.top.dragToAddModule)return function(i,a,n){var l,r,s;if(h("reset",n),!a.placeholder)return;if(e(".fullmeasureContent").each(function(t,o){l=e(o),r=l.data("_sortabletmpForm"),s=l.data("_sortabletmpForm2"),r&&r.remove(),s&&s.remove()}),Site.enableEditLayer(),Fai.top.$("body").enableSelection(),Fai.startInterval(null),e(".elemZoneModule").sortable("option","disabled",!1),"elemZone"!=t.getReceive())return;Fai.top.addModule_insertBefore=!1,Fai.top._appendModule=-1,Fai.top._cancelAdd?Fai.top._appendArea="":Fai.top._appendArea=e(n).attr("id");Fai.top.draggableDiv_enable=!1;var d=t.getStopOffset(),c=t.getReceiveParent().offset(),p=t.getReceiveParent().scrollTop(),f=d.top-c.top+p,u=d.left-c.left;o.setPosition({top:f,left:u}),t.reset()}(0,r,this);_=!0,Site.logDog(200084,1),C.hasClass("J_packContent")?Site.logDog(200084,4):C.hasClass("J_fullmeasurePackContent")?Site.logDog(200084,5):C.hasClass("J_tabPackContent")?Site.logDog(200084,6):C.hasClass("fk-webHeaderZone")||C.hasClass("fk-webFooterZone")?Site.logDog(200084,7):C.hasClass("J_topAdvContent")||C.hasClass("J_bottomFloatLayerContent")?Site.logDog(200084,8):C.hasClass("fk-inBannerListZone")&&Site.logDog(200084,9),b=function(o,n,l){var r,d,c,p,f,u=e(n.item),m=u.parent(),g=parseInt(u.attr("id").replace("module","")),b=parseInt(u.attr("id").replace("module","")),v=Site.checkNestModule(u),C=0,_=0,S=u.width(),y=u.height(),F=t.getOriginalParent(),M=F.width(),k=F.height(),w=F.offset().left,T=F.offset().top,A=t.getReceiveParent(),Z=t.getOriginalParentId(),J=t.getReceiveId(),z=(A.width(),A.height(),t.getPrevModule()),I=!1,L="formTabButtonList",P=Site.checkNestModule(u),x=n.offset;if(u.children(".J_moduleOverlay").remove(),e(".J_placeholderContainer").removeClass("fk_placeholderContainer J_placeholderContainer"),e(".J_placeholder_wrap").removeClass("J_placeholder_wrap jz_placeholder_wrap"),e(".jz_placeholder_wrap_original").removeClass("jz_placeholder_wrap_original"),Fai.removeAllIng(),Site.isModule(u,[97,82])&&t.getOriginalParentId()==t.getOverParentId()&&(p=t.getStopOffset().left||x.left,f=t.getStopOffset().top||x.top,p+S<w||p>w+M||f+y<T||f>T+k))return u.attr("id")&&Site.floatOut2(u.attr("id"),{dragBtn:a,notScroll:!0}),u.offset(t.getStopOffset()),u.children(".J_moduleOverlay").remove(),t.setOriginalParentId(),h("reset",l),Site.move_formStyle97(u),Site.enableEditLayer(),Fai.top.$("body").enableSelection(),Fai.startInterval(null),Site.refreshForms(),e(".mulMColList").sortable("option","disabled",!1),e(".mulMColList").addClass("column"),e(".formTabCntId").sortable("option","disabled",!1),e(".form").removeClass("fk_form_unsortable"),e(".formTabButtonList").sortable("option","disabled",!1),e(".formTabButtonYList").sortable("option","disabled",!1),e(".formTabContent").sortable("option","disabled",!1),e(".formTab").sortable("option","disabled",!1),Fai.top.$(".fillContentRelative").css("z-index","-1"),void(P.inPopupZone&&Site.protectZoneElemView(u));if(e(".fullmeasureContent").each(function(t,o){e(o).find(".tmpForm").remove()}),h("reset",l),Site.enableEditLayer(),Fai.top.$("body").enableSelection(),Fai.startInterval(null),"moduleZone"==t.getReceiveDetail()&&Site.isSystemModule(u))return Fai.top.sortSysModuleFail=!0,Fai.ing("系统模块不能拖入当前区域",!0),u.show(),t.reset(),!1;if("true"==u.attr("_global")&&t.getReceiveParent().hasClass("fk-inBannerListZone"))return Fai.top.sortSysModuleFail=!0,Fai.ing("全站模块不支持拖进独立横幅内，可右键取消模块的全站设置后，再拖进横幅内。",!0),u.show(),t.reset(),e(".mulMColList").sortable("option","disabled",!1),e(".mulMColList").addClass("column"),e(".formTabCntId").sortable("option","disabled",!1),e(".form").removeClass("fk_form_unsortable"),e(".formTabButtonList").sortable("option","disabled",!1),e(".formTabButtonYList").sortable("option","disabled",!1),e(".formTabContent").sortable("option","disabled",!1),e(".formTab").sortable("option","disabled",!1),Fai.top.$(".fillContentRelative").css("z-index","-1"),e(".elemZoneModule").sortable("option","disabled",!1),!1;"pack"==t.getReceiveDetail()&&s(A);"elemZone"==t.getFrom()&&s(F);"moduleZone"==t.getReceiveDetail()&&A.append(u);m.hasClass("formTabButtonYList")&&(L="formTabButtonYList",I=!0);Site.refreshForms(),r=Site.checkNestModule(u),d=Fai.top.$("#module"+r.parentId);var $=n.item;(oe=$.parents(".form")).length>0&&(oe=oe.eq(0));var B=oe.attr("id");if(oe.hasClass("formStyle29")&&(r.inTab||m.hasClass(L))&&!m.hasClass("formTabContent")){Site.logDog(200691,1),t.setReceive("column");var H=u.index(),R=m.children(".formTabButton").length;H>R&&(H=R-1),m.hasClass(L)&&(c=parseInt(m.attr("id").replace("formTabButtonList",""))||c,u.attr("_intab",c),u.attr("_inmulmcol",0),u.attr("_infullmeasure",0),u.attr("_infullmeasurePack",0),u.attr("_inpack",0),H>0?Fai.top.$("#formTabContent"+c).children().eq(H-1).after(u):Fai.top.$("#formTabContent"+c).prepend(u));var D=Site.getModuleTitle(u).replace(/<br\/>/,""),E=u.attr("class").split(" "),O=Site.isModule(u,[3,16,86]);for(var W in E)/formStyle*/.test(E[W])&&E[W].substring(9);Fai.top.$("#formTabButton"+b).remove();var j=[];j.push("<div class='formTabButton' id='formTabButton"+b+"' tabModuleId='"+b+"' onclick='Site.changeLiCnt("+b+", "+O+", 29)'>"),j.push("<div class='formTabLeft'></div>"),j.push("<div class='formTabMiddle'>"),I&&j.push("<span class='tabButtonText'>"),j.push(D),I&&j.push("</span>"),j.push("</div>"),j.push("<div class='formTabRight'></div>"),(Fai.top._uiMode||Fai.top._isTemplateVersion2)&&j.push("<div class='tabItemTriangle'></div>"),j.push("</div>");var N=Fai.top.$("#formTabButtonList"+c);H>0?((Fai.top._uiMode||Fai.top._isTemplateVersion2)&&j.unshift("<div class='tabItemSep'><div class='commonTabItemSep'></div></div>"),N.children(".formTabButton").eq(H-1).after(j.join(""))):((Fai.top._uiMode||Fai.top._isTemplateVersion2)&&N.find(".formTabButton").length>0&&!N.children().first().hasClass("tabItemSep")&&j.push("<div class='tabItemSep'><div class='commonTabItemSep'></div></div>"),N.prepend(j.join(""))),N.hasClass("formTabButtonYList")&&N.find(".tabYListPlaceholder").length<1&&N.append(e("<td class='tabYListPlaceholder'></td>"));var V=200,G=top.$("#formTabContent"+b).children(".formTabCntId");G.length>0&&(V=G.first().height());var Y="";V&&(Y=" style='height:"+V+"px !important;'"),Fai.top.$("#module"+b).parent().hasClass("formTabCntId")||Fai.top.$("#module"+b).hasClass("formTabCntId")||Fai.top.$("#module"+b).wrap("<div class='formTabCntId' id='formTabCntId"+b+"'"+Y+"></div>"),Fai.top.Site.bindInTabSwitch(),r=Site.checkNestModule(u),d=Fai.top.$("#module"+r.parentId)}var U=!0,q=!1;if(oe.hasClass("formStyle110")&&(r.inTabPack>0||e(n.item).parent().hasClass(L))&&!e(n.item).parent().hasClass("J_tabPackContent")){var X=Fai.top.$("#module"+b).prevAll(".formTabButton");X.length&&X.first().attr("tabmoduleid");H=X.length,q=!0,Fai.top.$("#formTabButton"+b).remove();var Q=e(n.item).find(".mainTitle"+ +e(n.item).attr("_moduleid")).eq(0).text(),K=Site.addNewTabPackTabItem(B.replace("module",""),H,Q),ee=e("#tabPackContent"+B.replace("module","")+"-"+K);ee.append($),$.css({position:"absolute",left:0,top:0}),U=!1,Site.refreshFormIndexClassInTabPack(oe),Site.triggerGobalEvent("changeParentModuleHeightToAuto",{id:b}),r=Site.checkNestModule(u)}if(r.inTab){var te=Site.getModuleAttrPattern(b).border;te&&(te.y=1,Site.hideModuleBorder(b))}t.getOriginalParentId()==t.getReceiveId()?(C=n.position.top,_=n.position.left):(le=t.getStopOffset(),re=t.getReceiveParent().offset(),C=le.top-re.top,_=le.left-re.left);if("column"==t.getReceive()||"fullmeasure"==t.getReceive()){U&&u.removeAttr("style"),Site.dockModuleResize(u),u.attr("_autoheight")>0&&Site.autoModuleHeight(g),r.inTab?(u.removeClass("formInMulMCol formInZone").addClass("formInTab"),Site.dockModuleResize(d)):r.inCol?(u.removeClass("formInTab formInZone").addClass("formInMulMCol"),Site.dockModuleResize(d)):r.inFullmeasure?(u.removeClass("formInTab formInMulMCol formInZone"),Site.inFullmeasueAnimation.refFillRelativeDivHeight(r.parentId)):r.inPack&&u.removeClass("formInTab formInMulMCol formInZone");var $=n.item,oe=$.parents(".form");oe.length>0&&(oe=oe.eq(0));var B=oe.attr("id");if(oe.hasClass("formStyle35")&&$.hasClass("formStyle35"))return Fai.ing("多列排版模块不能插入多列排版模块之中",!0),t.reset(),!1;if(oe.hasClass("formStyle29")||oe.hasClass("formStyle110")){if($.hasClass("formStyle35"))return Fai.ing("多列排版模块不能插入标签模块之中",!0),t.reset(),!1;if($.hasClass("formStyle29")||$.hasClass("formStyle110"))return Fai.ing("标签模块不能插入标签模块之中",!0),t.reset(),!1}if($.hasClass("formStyle86")&&Site.refreshSimpleEditor($,$),$.hasClass("formStyle32")&&$.width()!=parseInt($.attr("_width"))){$.find(".resize").each(function(){e(this).css({width:""}),e(this).removeAttr("_width")});var ie=Site.getModuleAttr(b);ie.data.changed=!0,Site.styleChanged()}if($.hasClass("formStyle75")&&Site.fixMsgSubmitStyle(b),$.hasClass("formStyle50")&&Site.fixMsgBoardStyle(b),$.hasClass("formStyle32")&&Site.fixSiteFormDateRangeStyle(b),e(n.item).parent().hasClass("formTabContent")){var ae=e(n.item).parent().attr("id"),ne=parseInt(ae.replace("formTabContent",""));Site.getModuleAttrData(ne).changed=!0,Site.addModuleCallBackForTab(b,1,null,ae,[],0,200),Fai.top.Site.bindInTabSwitch()}r.inTab&&Fai.top.$("#module"+r.parentId).attr("_autoHeight")>0&&Site.autoModuleHeight(r.parentId)}else if("moduleZone"==t.getReceiveDetail()){var le=t.getStopOffset(),re=t.getReceiveParent().offset(),C=le.top-re.top,_=le.left-re.left,S=t.getWidth(),y=t.getHeight();Site.commPack.topModuleIndex(u);var A=t.getReceiveParent();A.width(),A.height();h("reset",A),u.removeAttr("style"),u.css({position:"absolute",top:C+"px",left:_+"px",width:S+"px",height:y+"px"}),Site.protectZoneElemView(u),81==u.attr("_modulestyle")&&Site.adjustFlBtnPos(g),i.resizeZoneOneModule(u),u.attr("_autoheight")>0&&Site.autoModuleHeight(g),r.inZone&&u.removeClass("formInTab formInMulMCol").addClass("formInZone"),v.parentId>0&&Site.setModuleAttrDataChange(v.parentId),u.hasClass("formStyle97")&&u.find(".mallHead").click()}else if(q);else{if(u.css({top:C+"px",left:_+"px"}),A.scrollTop()+A.height()<C&&A.scrollTop(C),Z!=J?Site.commPack.topModuleIndex(u):z&&z.length>0?z.after(u):A.children(".J_zoneContentBg").after(u),u.hasClass("formStyle97")){var se=u.attr("id").substring(6);e(".styleMall"+se).show(),u.find(".mallHead").click().click()}r.inTabPack&&v.parentId!==r.parentId&&(Site.isModule(u,[79,81,86])||u.parent().children().each(function(){if(!e(this).is(u)&&!Site.isModule(e(this),[79,81,86]))return Site.editTabPackItemName(r.parentId,u.parent().attr("id").replace("tabPackContent"+r.parentId+"-",""),e(".mainTitle"+b).eq(0).text()),!0})),u.removeClass("formInTab formInMulMCol").addClass("formInZone"),setTimeout(function(){Site.triggerGobalEvent("changeParentModuleHeightToAuto",{id:b})},0),Site.protectZoneElemView(u)}var de=!v.inFullmeasurePack&&r.inFullmeasurePack,he=!v.inTabPack&&r.inTabPack;de?(Site.shouldSetFullWidthModule(u)&&Fai.top.Site.dragToAddModuleData.setWidth(oe.find(".J_fullmeasurePackContent:visible").width()),Fai.top.Site.commPack.setNewModuleStyle(u),Site.shouldSetFullWidthModule(u)&&u.css({left:0})):he&&(Site.shouldSetFullWidthModule(u)?Fai.top.Site.dragToAddModuleData.setWidth(oe.find(".J_tabPackContent:visible").width()):(Fai.top.Site.dragToAddModuleData.setWidth(u.width()),Fai.top.Site.dragToAddModuleData.setHeight(u.height())),Fai.top.Site.commPack.setNewModuleStyle(u),Site.shouldSetFullWidthModule(u)&&u.css({left:0}));var ce=!1;e.inArray(u.attr("_modulestyle"),["39","45","62","65","66"])>-1&&e.inArray(t.getReceive(),["moduleZone","pack"])>-1?ce=!0:he&&(ce=!0);ce&&(Site.oneKeySetModuleTB(b,!0),t.setHeight(u.height()));v.inPack?(Site.disableEditLayer(),Site.commPack.resetPackModuleHeight(v.parentId),Site.enableEditLayer()):(v.inFullmeasurePack||v.inTabPack)&&"1"==e("#module"+v.parentId).attr("_autoheight")&&Site.dockModuleAutoHeight(v.parentId);e(".mulMColList").sortable("option","disabled",!1),e(".mulMColList").addClass("column"),e(".formTabCntId").sortable("option","disabled",!1),e(".form").removeClass("fk_form_unsortable"),e(".formTabButtonList").sortable("option","disabled",!1),e(".formTabButtonYList").sortable("option","disabled",!1),e(".formTabContent").sortable("option","disabled",!1),e(".formTab").sortable("option","disabled",!1),Fai.top.$(".fillContentRelative").css("z-index","-1"),e(".elemZoneModule").sortable("option","disabled",!1),u.show(),v.parentId>0&&Site.setModuleAttrDataChange(v.parentId);r.parentId>0&&Site.setModuleAttrDataChange(r.parentId);"fullmeasure"==t.getReceive()&&(Site.inFullmeasueModuleEdit.autoResetFullmeasureHeight(t.getReceiveParent().attr("moduleid")),Site.inFullmeasueModuleEdit.checkContentBgPlace(u));"fullmeasure"==t.getFrom()&&Site.inFullmeasueModuleEdit.autoResetFullmeasureHeight(t.getOriginalParent().attr("moduleid"));"fk-webFooterZone"==t.getReceiveId()&&i.refreshFooterHeightForManage(u);Fai.top._moduleMoved++,Site.styleChanged(),Site.moduleSizeChange(u.attr("id")),Fai.top.originSortable="",t.reset();var pe=Site.moveSpecialModuleInNewPack(g,!0);return Site.moduleChangeParentCallback(),Site.displayAddModule(),pe?"needNewWrapPack":a}(0,r,this)}if(u){var S=Fai.top.sortSysModuleFail;Fai.top.sortSysModuleFail=!1}return u&&_&&!1!==b&&(f=e.extend({},l),g=Site.undoGetElemInfo(e(r.item),"sort"),v=Site.checkNestModule(e(r.item)),g&&l&&(v.inTab&&g.parent&&(g.parent.hasClass("formTabButtonList")||g.parent.hasClass("formTabCntId"))&&(g.parent=g.parent.parent()),g.parent.hasClass("formTabCntId")&&(g.parent=g.parent.parent()),f.removeWrapPack="needNewWrapPack"==b,S||Site.undoRun(function(){},{type:"module",detail:"elemZoneSortStop",id:parseInt(e(r.item).attr("_moduleid")),undoSame:!1,redoSame:!1,undoFn:Fai.top._undo.moduleSortStopUndo,redoFn:Fai.top._undo.moduleSortStopUndo,undoArgs:[f],redoArgs:[g]}))),"needNewWrapPack"==b&&(b=a),u=!1,m&&e(r.item).hasClass("form")&&Site.boundary.reset(e(r.item)),b}}}})}function l(t){e(t).find(".J_packContent").length>0||e(t).hasClass("J_packContent")||e(t).find(".J_fullmeasurePackContent").length>0||e(t).hasClass("J_fullmeasurePackContent")?r(t):e(t).find(".J_popupZoneContent").length>0||e(t).hasClass("J_popupZoneContent")?function(t){var o="",i=e(t).hasClass("elemZoneModule")?e(t):e(t).find(".elemZoneModule"),a="";if(i.children(".J_zoneEditBtn").length>0)return void s(t);i.find(".form:visible").length>0&&(a="style='display:none;'");o+="<div class='J_zoneEditBtn f-zoneEditBtn' "+a+">",o+="<div class='J_addContent f-addContent'>",o+="<span>拖动模块到这里<span>",o+="</div>",o+="</div>",i.append(o)}(t):e(t).find(".J_bottomFloatLayerContent").length>0||e(t).hasClass("J_bottomFloatLayerContent")?function(t){var o=e(t).hasClass("J_bottomFloatLayerContent")?e(t):e(t).find(".J_bottomFloatLayerContent");if(o.length<1)return;Site.EmptyOper.refresh(o)}(t):(e(t).find(".J_topAdvContent").length>0||e(t).hasClass("J_topAdvContent"))&&function(t){var o=e(t).hasClass("J_topAdvContent")?e(t):e(t).find(".J_topAdvContent");if(o.length<1)return;Site.EmptyOper.refresh(o)}(t)}function r(t){var o=e(t).hasClass("elemZoneModule")?e(t):e(t).find(".elemZoneModule");if(!(o.length<1)){var i=o.attr("id").replace("elemZone","").replace("fk-packContent",""),a=e("#module"+i);a.length<1||Site.EmptyOper.refresh(a)}}function s(t){var o=e(t).hasClass("elemZoneModule")?e(t):e(t).find(".J_packContent, .J_fullmeasurePackContent, .elemZoneModule, .J_bottomFloatLayerContent, .J_topAdvContent");o.children(".J_zoneEditBtn").length<1&&r(t),o.children(".form:not('.J_floatDragModuleHelper'), .moduleAloneArea").length>0?o.children(".J_zoneEditBtn").hide():o.children(".J_zoneEditBtn").show(),Site.EmptyOper.refresh(o)}function d(e){return e.hasClass("J_packContent")?"自由容器":e.hasClass("J_tabPackContent")?"标签模块":e.hasClass("J_fullmeasurePackContent")?"通栏排版":""}function h(t,o,a){var n=e(o);if(!(n.length<1))if("over"==t){n.children(".J_zoneEditBtn").hide();var l=n.children(".J_placeholder")}else if("sort"==t){l=n.children(".J_placeholder");var r=e(".jz_placeholder_wrap_original");l.length&&(e(".J_placeholder_wrap").removeClass("J_placeholder_wrap jz_placeholder_wrap"),l.parent().addClass("J_placeholder_wrap jz_placeholder_wrap"),e(".J_placeholder").removeClass("jz_placeholder jz_placeholder_disabled"),l.addClass("jz_placeholder"),i.isZoneDisableModule(e(a),e(o))||Site.isSystemModule(e(a))&&e(o).hasClass("J_moduleZone")?l.addClass("jz_placeholder_disabled"):(e(".J_placeholderWrapAllHidden").removeClass("jz_placeholder_wrap--all_hidden J_placeholderWrapAllHidden"),r.is(l.parent())?Fai.removeAllIng():r.find(l.parent()).length>0?(d(r)&&d(l.parent())?Fai.ing("模块将拖出"+d(r)+"，拖入"+d(l.parent())+"中。"):Fai.removeAllIng(),r.addClass("jz_placeholder_wrap--all_hidden J_placeholderWrapAllHidden")):l.parent().find(r).length>0?(d(l.parent())?Fai.ing("模块将拖入到"+d(l.parent())+"中。"):Fai.removeAllIng(),l.parent().addClass("jz_placeholder_wrap--all_hidden J_placeholderWrapAllHidden")):Fai.removeAllIng()))}else"out"==t?s(o):"originZoneOut"==t||"reset"==t&&s(o)}function c(t){Fai.top._addModuleIcon&&Fai.top._addModuleIcon.draggable("option","connectToSortable",t),Fai.top._addModuleIcon&&Fai.top._addModuleIcon.draggable("refreshConnectToSortable"),Fai.top.$(".elemZone:not("+t+")").each(function(){i.refreshZoneEditBtn(e(this))})}function p(e){Fai.top._addModuleIcon&&Fai.top._addModuleIcon.draggable("option","connectToSortable",".J_moduleZone:visible, .column:visible, .fullmeasureContent:visible, .J_packContent:visible, .formTabButtonList:visible, .formTabButtonYList:visible, .elemZoneModule:visible"),Fai.top._addModuleIcon&&Fai.top._addModuleIcon.draggable("refreshConnectToSortable")}function f(o,i,a){var n=e(a),l=n.attr("id");t.setReceiveId(l),t.setReceiveParent(n),t.setReceive("elemZone"),n.hasClass("J_moduleZone")?t.setReceiveDetail("moduleZone"):n.hasClass("J_packContent")&&t.setReceiveDetail("pack")}function u(){var e,t,o=0,i=Fai.top.$("#fk-webFooterZone").children(".form"),a=i.length,n=Fai.top.$("#webFooter"),l=n.find(".footerContent"),r=n.height(),s=parseInt(l.css("paddingBottom").replace("px")),d=l.offset().top-n.offset().top,h=0,c=Fai.top.Site.getFooterStyleData();if(1!=c.f.t){if(a<1)return c.f.d=0,Fai.top.Site.saveFooterStyleData(c),Fai.top._footerStyleChanged++,Site.styleChanged(),Site.setRefreshInfo("siteStyleSetting",!0),void Fai.top.Fai.removeCtrlStyleCssList("stylefooter","footer",[{cls:".footerContent",key:"padding-bottom"}]);for(;a;)a-=1,(e=(t=i.eq(a)).position().top+t.height())>o&&(o=e);(h=o-r+s+d)<0&&(h=0),c.f.d=-h,Fai.top.Site.saveFooterStyleData(c),Fai.top.Fai.setCtrlStyleCssList("stylefooter","footer",[{cls:".footerContent",key:"padding-bottom",value:h+"px"}])}}i.sortAllZoneModule=function(){e(".elemZoneModule").each(function(t,o){n(e(o))})},i.sortModuleZone=function(){n(e("#fk-webHeaderZone")),n(e("#fk-webBannerZone")),n(e("#fk-webFooterZone")),n(e(".fk-inBannerListZone"))},i.sortPackModule=function(){e(".J_packContent").each(function(t,o){n(e(o))})},i.sortOneZoneModule=function(e){var t=e.hasClass("elemZoneModule")?e:e.find(".elemZoneModule");t.length>0&&n(t)},i.destroySortOneZoneModule=function(e){var t=e.hasClass("elemZoneModule")?e:e.find(".elemZoneModule");t.length>0&&t.sortable("destroy")},i.changeZoneEditPrompt=function(e,t){h(e,t)},i.initAllPackAddModuleBtn=function(){e(".J_packContent, .J_popupZoneContent, .J_fullmeasurePackContent, .J_bottomFloatLayerContent, .J_topAdvContent").each(function(e,t){l(this)})},i.initAddModuleBtn=function(e){e.length>0&&l(e)},i.refreshZoneEditBtn=function(e){s(e)},i.removeZoneEditBtn=function(e){e.find(".J_zoneEditBtn").remove()},i.refreshFooterHeight=function(){u()},i.refreshFooterHeightForManage=function(e){u(),Fai.top._footerStyleChanged++,Site.styleChanged(),Site.setRefreshInfo("siteStyleSetting",!0),Site.scrollToModuleDiv(e)}}(jQuery,Fai.top.Site&&Fai.top.Site.sortData||Site.sortData,Fai.top.Site&&Fai.top.Site.dragToAddModuleData||Site.dragToAddModuleData,Fai.top._elemZone||(Fai.top._elemZone={})),function(e,t,o){function i(e){Site.resizeModule.init(e)}t.resizeAllZoneModule=function(){Site.resizeModule.prepare(Fai.top.$(".elemZoneModule").children(".form"))},t.resizeOneZoneModule=function(t){(t.hasClass("elemZoneModule")?t.children(".form"):t.find(".elemZoneModule").children(".form")).each(function(t,o){i(e(o))})},t.resizeModuleZone=function(){for(var e=Fai.top.$("#fk-webHeaderZone, #fk-webBannerZone, #fk-webFooterZone, .fk-inBannerListZone").children(".form"),t=e.length;t;)t-=1,i(e.eq(t))},t.resizeZoneOneModule=function(e){i(e)},t.destroyResizeOneZoneModule=function(t){(t.hasClass("elemZoneModule")?t.children(".form"):t.find(".elemZoneModule").children(".form")).each(function(t,o){e(o).resizable("destroy"),e(o).children(".ui-resizable-cancelTip").remove()})},t.disableResizeOneZoneModule=function(t){t.children(".form").each(function(t,o){e(o).resizable("destroy"),e(o).children(".ui-resizable-cancelTip").remove()})},t.packChildrenDisableResizable=function(t){(t.hasClass("elemZoneModule")?t.children(".form"):t.find(".J_packContent").children(".form")).each(function(t,o){e(o).resizable("destroy"),e(o).children(".ui-resizable-cancelTip").remove()})},t.isZoneDisableModule=function(t,o){if(o.hasClass("J_fullmeasurePackContent"))return!1;if(Site.isModule(t,[110])||t.hasClass("panelModuleIcon_tabPackHorizonal")||t.hasClass("panelModuleIcon_tabPackVertical")){if(o.hasClass("J_packContent")){var i=e("#module"+o.attr("id").replace("fk-packContent",""));return!!Site.checkNestModule(i).inTab}return!0}if((Site.isModule(t,[87])||t.hasClass("panelModuleIcon_pack"))&&o.hasClass("J_tabPackContent"))return!0;return!!(Site.isModule(t,[80,109,87,29,35])||t.hasClass("panelModuleIcon_pack")||t.hasClass("panelModuleIcon_tabHorizonal")||t.hasClass("panelModuleIcon_tabVertical")||t.hasClass("panelModuleIcon_mulModuleCol")||t.hasClass("panelModuleIcon_fullmeasaure")||t.hasClass("panelModuleIcon_fullmeasurePack")||Fai.top._matFactorySortModule)}}(jQuery,Fai.top._elemZone||(Fai.top._elemZone={})),function(e,t,o){var i;function a(e){return Site.getModuleAutoHeight(e)}function n(t){var o,a=t.elem,n=t.helper,s=t.notElem,d=t.directionArr,h=(a.attr("id"),n[0].getBoundingClientRect()),c=(t.callback||e.noop,e(window)),p=c.height(),f=c.width();o=Fai.top.$(".form, #g_main").filter(function(){var t=e(this).offset(),o=this.getBoundingClientRect(),i=o.height,a=o.width,l=t.top,r=l+i,d=t.left;return this!==n&&(!(l>=p||r<=0||d>=f||a+d<=0)&&!(e.inArray(e(this).attr("id"),s)>-1))}),h.level=(h.bottom+h.top)/2,h.vertical=(h.right+h.left)/2,Fai.top.$("#absAlignTop, #absAlignRight, #absAlignBottom, #absAlignLeft, #absAlignLevel, #absAlignVertical").hide(),i.init&&(i.compareData=function(t){var o={},i=Fai.top.$(window).height();return t.each(function(){var t,a=e(this),n=a.attr("id");if(n&&((t=a[0].getBoundingClientRect()).level=(t.bottom+t.top)/2,t.vertical=(t.right+t.left)/2,o[n]=t,t.top>=i||t.bottom<=0))return!0}),o}(o)),function(t,o,a,n,s){Fai.top.$("#absAlignTop, #absAlignRight, #absAlignBottom, #absAlignLeft, #absAlignLevelLine, #absAlignVerticalLine").css("opacity",1);var d=0,h=0,c=0,p=0,f=0,u=0,m=0,g=0,b=0,v=0,C=0,_=0,S=[t.left,t.right],y=[t.top,t.bottom],F=[t.left,t.right],M=[t.top,t.bottom];for(var k in obtainLevel=[t.left,t.right],obtainVertical=[t.top,t.bottom],o){var w=o[k];d=t.top-w.top,h=t.right-w.right,c=t.bottom-w.bottom,p=t.left-w.left,f=t.level-w.level,u=t.vertical-w.vertical,-1!=e.inArray("top",s)&&Math.abs(d)<i.showGap&&(m=w.top,S.push(w.left,w.right),i.inTopLine=!0),-1!=e.inArray("right",s)&&Math.abs(h)<i.showGap&&(g=w.right,y.push(w.top,w.bottom),i.inRightLine=!0),-1!=e.inArray("bottom",s)&&Math.abs(c)<i.showGap&&(b=w.bottom,F.push(w.left,w.right),i.inBottomLine=!0),-1!=e.inArray("left",s)&&Math.abs(p)<i.showGap&&(v=w.left,M.push(w.top,w.bottom),i.inLeftLine=!0),-1!=e.inArray("level",s)&&Math.abs(f)<i.showGap&&(C=w.level,obtainLevel.push(w.left,w.right),i.initLevelLine=!0),-1!=e.inArray("vertical",s)&&Math.abs(u)<i.showGap&&(_=w.vertical,obtainVertical.push(w.top,w.bottom),i.initVerticalLine=!0)}(n.hasClass("formStyle81")||n.hasClass("formStyle79"))&&!0;i.inTopLine&&(l("top",S),r("Top",m),i.inTopLine=!1);i.inRightLine&&(l("right",y),r("Right",g),i.inRightLine=!1);i.inBottomLine&&(l("bottom",F),r("Bottom",b),i.inBottomLine=!1);i.inLeftLine&&(l("left",M),r("Left",v),i.inLeftLine=!1);i.initLevelLine&&(l("level",obtainLevel),r("Level",C),i.initLevelLine=!1);i.initVerticalLine&&(l("vertical",obtainVertical),r("Vertical",_),i.initVerticalLine=!1)}(h,i.compareData,0,a,d),i.init=!1}function l(e,t){var o=Math.min.apply(null,t),i=Math.max.apply(null,t);switch(e){case"top":Fai.top.$("#absAlignTop").css({left:o-15+"px",width:i-o+30+"px"});break;case"right":Fai.top.$("#absAlignRight").css({top:o-15+"px",height:i-o+30+"px"});break;case"bottom":Fai.top.$("#absAlignBottom").css({left:o-15+"px",width:i-o+30+"px"});break;case"left":Fai.top.$("#absAlignLeft").css({top:o-15+"px",height:i-o+30+"px"});break;case"level":Fai.top.$("#absAlignLevel").css({left:o-15+"px",width:i-o+30+"px"});break;case"vertical":Fai.top.$("#absAlignVertical").css({top:o-15+"px",height:i-o+30+"px"})}}function r(e,t){var o=Fai.top.$("body");if(o.find(".absAlign"+e).length<1){var i="<div id='absAlign"+e+"' class='absAlign"+e+"' ";switch(e){case"Top":case"Bottom":case"level":i+="style='top:"+t+"px;' ";break;case"Left":case"Right":case"vertical":i+="style='right:"+t+"px;' "}i+="></div>",o.append(i)}else switch(e){case"Top":o.find(".absAlign"+e).css({top:t+"px",display:"block"});break;case"Bottom":o.find(".absAlign"+e).css({top:t-1+"px",display:"block"});break;case"Left":o.find(".absAlign"+e).css({left:t+"px",display:"block"});break;case"Right":o.find(".absAlign"+e).css({left:t-1+"px",display:"block"});break;case"Level":o.find(".absAlign"+e).css({top:t+"px",display:"block"});break;case"Vertical":o.find(".absAlign"+e).css({left:t+"px",display:"block"})}}t.initAlignLine=function(t){if(null==(i=e.extend({},{showGap:2,inTopLine:!1,inRightLine:!1,inBottomLine:!1,inLeftLine:!1,initLevelLine:!1,initVerticalLine:!1,init:!0,elem:null,helper:null,notElem:null,directionArr:["left","top","right","bottom","level","vertical"]},t)).helper||null==i.elem)throw new Error("alignLine 参数错误");n(i)},t.refreshAlignLine=function(){if(void 0===i||null==i)throw new Error("alignLine 未初始化");n(i)},t.resetAlignLine=function(){i=null,Fai.top.$("#absAlignTop, #absAlignRight, #absAlignBottom, #absAlignLeft, #absAlignLevel, #absAlignVertical").hide()},t.getModuleAutoHeight=function(e){return a(e)},t.addModuleResizeHandle=function(e){!function(e){var t=Fai.top.$("#module"+e),o=t.height(),i=a(t),n=!0;if(o>=i)return;if(t.children(".J_resizableTip").length>0)return;1!=Site.getModuleStatus(e)&&(n=!1);n?t.append("<a href='javascript:;' class='J_resizableTip ui-resizable-cancelTip fk-resizable-cancelTip ui-resizable-cancelTip2 fk-resizable-cancelTip2' _faiscoTip='还原模块高度' onclick='Site.dockModuleAutoHeight("+e+");Site.changeParentModuleHeightToAuto("+e+");return false;'></a>"):t.append("<a href='javascript:;' class='J_resizableTip ui-resizable-cancelTip fk-resizable-cancelTip ui-resizable-cancelTip2 fk-resizable-cancelTip2' parentid='module"+e+"' _faiscoTip='还原模块默认高度' onclick='Site.absModuleAutoHeightDo("+e+");return false;'></a>")}(e)}}(jQuery,Fai.top._elemZone||(Fai.top._elemZone={})),function(e,t){function o(e){e.draggable("destroy").draggable({containment:"parent",cursor:"move",axis:"x,y",scroll:!1,distance:3,tolerance:2,smartguides:".form, .elemZoneCell",cancel:".elmeZoneCellNoDrag",start:function(){},stop:function(){}})}t.dragAllZoneCell=function(){e(".elemZoneCell").each(function(t,i){o(e(i))})},t.dragOneZoneCell=function(e){var t=e.find(".elemZoneCell");t.length>0&&o(t)},t.destroyDragOneZoneCell=function(e){var t=e.find(".elemZoneCell");t.length>0&&t.draggable("destroy")},t.dragZoneOneCell=function(e){e.length>0&&o(e)}}($,Fai.top._elemZone||(Fai.top._elemZone={})),function(e,t){function o(t){var o;t.resizable("destroy"),t.resizable({helper:"ui-resizable-helper",handles:"n, e, s, w, se, sw, ne, nw",autoHide:!0,smartguides:".form, .elemZoneCell",create:function(t,o){Site.addResizableExtHandles(e(this)),Site.refreshResizableHandles(e(this)),e(this).off("mouseenter.zoneLine").on("mouseenter.zoneLine",".ui-resizable-handle",function(){e(this).addClass("f-handleHover").siblings(".ui-resizable-handle").addClass("f-handleHover")}),e(this).off("mouseleave.zoneLine").on("mouseleave.zoneLine",".ui-resizable-handle",function(){e(this).removeClass("f-handleHover").siblings(".ui-resizable-handle").removeClass("f-handleHover")})},start:function(t,i){Site.disableEditLayer(),Fai.top.$("body").disableSelection(),o=e("#dockTip").show()},resize:function(t,i){var a=e(".ui-resizable-helper");o.html("高度:"+a.height()+"<br/>宽度:"+a.width()).css({left:t.pageX-28,top:t.pageY+18})},stop:function(t,i){Site.protectZoneElemView(e(this)),Site.refreshResizableHandles(e(this)),Site.enableEditLayer(),Fai.top.$("body").enableSelection(),o.hide(),Fai.top.$("#absAlignTop, #absAlignRight, #absAlignBottom,#absAlignLeft").hide(),Site.styleChanged()}})}t.resizeAllZoneCell=function(){e(".elemZone").find(".elemZoneCellResize").each(function(t,i){o(e(i))})},t.resizeOneZoneCell=function(e){var t=e.find(".elemZoneCellResize");t.length>0&&o(t)},t.destroyResizeOneZoneCell=function(e){var t=e.find(".elemZoneCellResize");t.length>0&&(t.resizable("destroy"),t.children(".ui-resizable-cancelTip").remove())},t.resizeZoneOneCell=function(e){e.length>0&&o(e)}}($,Fai.top._elemZone||(Fai.top._elemZone={})),function(e,t,o){function i(){var t=Fai.top.$(document),o="#banner .J_bannerItem, #bannerGetHref";t.off("mousedown.selectable"),Fai.top._useBannerVersionTwo||(e("#banner").length&&e("#banner").find(".J_bannerItem").length<1&&(o+=", #bannerGetHref, #banner "),t.on("mousedown.selectable",o,function(e){Fai.top.$("#fk-webBannerZone .fk-moduleZoneBg").trigger("mousedown.mouseSelectable",e)})),t.on("mousedown.selectable","#footer",function(t){e(t.target).is("a")||e(t.target).parent().is("a")||Fai.top.$("#fk-webFooterZone .fk-moduleZoneBg").trigger("mousedown.mouseSelectable",t)}).on("mousedown.selectable",".headerNav",function(t){e(t.target).is("a")||e(t.target).parent().is("a")||e(t.target).hasClass("ui-resizable-handle")||Fai.top.$("#fk-webHeaderZone .fk-moduleZoneBg").trigger("mousedown.mouseSelectable",t)})}function a(o){var a=Fai.top.$(o);if(!(a.length<1)){var d=Fai.top.$(document),h=a.attr("id").replace("elemZone","").replace("fk-packContent","");a.hasClass("J_fullmeasurePackContent")&&(h=a.attr("moduleid")),a.hasClass("J_tabPackContent")&&(h=a.attr("moduleid"));var f,u=a.attr("id").indexOf("Zone")>0?a:Fai.top.$("#module"+h),m=new g;a.data("info",m),a.off(".mouseSelectable").on("mousedown.mouseSelectable",".J_zoneContentBg",function(e,t){Fai.top.Fai.isMozilla()&&Fai.top.$("a.J_bannerItem").attr("ondragstart","return false");var o=!1,i=null,l=t||e,r=l.clientX,p=l.clientY,f=a.hasClass("J_moduleZone")?Fai.top.$(document):a;m.mat=[],f.on("mousemove.mouseSelectable",function(l){var d=l,c=d.clientX,f=d.clientY;!o&&(Math.abs(c-r)>3||Math.abs(f-p)>3)&&(e=t||e,_(),i=new v(e,a),m.init(a),m.zoneId=h,o=!0),o&&(i.change(l),m.refresh(i.getConfig()),function(e){for(form in e)s(e[form].$elem)}(m.all),n(m.mat,m.all),l.stopPropagation(),l.preventDefault())}),d.one("mouseup.mouseSelectable",function(e){if(Fai.top.Fai.isMozilla()&&Fai.top.$("a.J_bannerItem").attr("ondragstart",""),(a.hasClass("J_moduleZone")?Fai.top.$(document):a).off("mousemove.mouseSelectable"),o)return m.hasMat()?(Site.logDog(100045,65),c(m.mat,m.all,a),b(),C(a)):S(),i.remove(),i=null,Site.checkSimpleTextHideTool(),e.stopPropagation(),e.preventDefault(),!1}),a.off("click.mouseSelectable").on("click.mouseSelectable",function(e){o&&(e.stopPropagation(),e.preventDefault())})}).off(".ctrlClickSelectable").on("click.ctrlClickSelectable",".form, .elemZoneCell",function(t){F(t)&&(e(this).find(".floatImg_noImg_J").length>0||(Site.logDog(100045,65),b(),C(a),_(),m.init(a),m.refresh(new v(t,a).remove().getConfig(),!0),n(m.mat),c(m.mat,m.all,a),r(m.getElemInfo(e(this)),m.all)))}).on("click.ctrlClickSelectable",".J_selectableMask",function(e){F(e)?(m.refresh(new v(e,a).remove().getConfig(),!0),n(m.mat),c(m.mat,m.all,a)):0==e.button&&S()}).on("click.ctrlClickSelectable",".J_selectedArea",function(t){if(F(t)){var o=function(e,t){var o=t.offset(),i=o.left,a=o.top,n=e.clientY-a,l=e.clientX-i;return{top:n,left:l}}(t,a),i=o.left,n=o.top;m.init(a);var l=[];e.each(m.all,function(e,t){var o=t.left+t.marginLeft,a=t.right+t.marginLeft,r=t.top+t.marginTop,s=t.bottom+t.marginTop;i>o&&i<a&&n>r&&n<s&&l.push(t)});var d=l.sort(function(e,t){return e.$elem.index()<t.$elem.index()})[0];m.mat.indexOf(d)>-1?(m.delMat(d),c(m.mat,m.all,a),s(d.$elem),m.mat.length<1&&S()):(m.addMat(d),c(m.mat,m.all,a),r(d,m.all))}}),a.hasClass("J_moduleZone")&&i()}function b(){Site.addModuleMask({id:h,realElem:u,callback:function(){Fai.top.$(".moduleMask-center").remove();var e=parseInt(a.css("border-left-width")),t=parseInt(a.css("border-right-width")),o=parseInt(a.css("border-top-width")),i=parseInt(a.css("border-bottom-width")),n=Fai.top.$(".moduleMask-left"),l=n.width()+e;n.width(l);var r=Fai.top.$(".moduleMask-top"),s=r.width()-e-t;r.height(r.height()+o).width(s).css("left",l+"px");var d=Fai.top.$(".moduleMask-bottom");d.height(d.height()+i).css("top",parseInt(d.css("top"))-i+"px").width(s).css("left",l+"px");var h=Fai.top.$(".moduleMask-right");h.width(h.width()+t).css("left",l+s+"px")},extFn:[{name:"click",fn:S}]})}function _(){y(),d.off("mousewheel.selectwheel").on("mousewheel.selectwheel",function(e){setTimeout(function(){y()},200)}).off("keydown.selectwheel").on("keydown.selectwheel",function(e){32!=e.keyCode&&9!=e.keyCode||e.preventDefault()}).on("exitEditMode.selectable",S),f=f?f.show():Fai.top.$("<div class='fk-selectableMask J_selectableMask' style='width:"+a.width()+"px;height:"+a.height()+"px;'>").appendTo(a),a.off("contextmenu.selectable").on("contextmenu.selectable",function(e){e.stopPropagation()}),d.find("body").addClass("fk-elemZone-unselect"),Fai.top._selectableMode=!0}function S(){Site.enableEditLayer(),Fai.top.$("body").enableSelection(),d.off(".selectwheel").off("exitEditMode.selectable"),f&&(f.remove(),f=null),Site.removeModuleMask(),a.off("contextmenu.selectable"),d.find("body").removeClass("fk-elemZone-unselect"),p(a),l(m.all),m.reset(),t.resetAlignLine(),Fai.top._selectableMode=!1}function y(){Site.disableEditLayer(),Fai.top.$("body").disableSelection()}function F(e){return e.ctrlKey&&0==e.button}}function n(e){for(var t=0,o=e.length;t<o;t++)r(e[t])}function l(e){for(var t=0,o=e.length;t<o;t++)d(e[t])}function r(e){var t=e.$elem,o=t.find(">.J_selectedLineWrap");o.length<1&&(o=h(e)),t.css({overflow:"visible"}),o.show()}function s(e){var t=e.find(">.J_selectedLineWrap");t.length<1||(e.removeCss("overflow"),t.hide())}function d(e){var t=e.$elem,o=t.find(">.J_selectedLineWrap");o.length<1||(t.removeCss("overflow"),o.remove())}function h(e){d(e);var t,o,i=e.$elem,a=(i.find(">.J_selectedLineWrap"),parseInt(i.css("border-top-width"))||0),n=parseInt(i.css("border-left-width"))||0;return(t=[]).push("<div class='fk-selectedLineWrap J_selectedLineWrap' style='width:"+(o=e).outerWidth+"px;height:"+o.outerHeight+"px;left:"+(-1-n)+"px;top:"+(-1-a)+"px;'>"),t.push("</div>"),Fai.top.$(t.join("")).appendTo(i)}function c(i,a,r){if(p(r),!(i.length<1)){var s,d,h=r.data("info"),g=h.mat,b={},v=b.left=k("left",0)-1,C=b.top=k("top",0)-1,S=b.right=k("right",1)+1,y=b.bottom=k("bottom",1)+1,F=S-v,M=y-C;b.width=F,b.height=M;if(v=b.left=v-1,C=b.top=C-1,b.right=S-1+2,b.bottom=y-1+2,h.hasInit)d=parseInt(1e4*Math.random()),(s=[]).push("<div id='selectedAreaWrap"+d+"' class='fk-selectedAreaWrap J_selectedAreaWrap'>"),s.push("    <div class='f-selectedArea J_selectedArea' style='width:"+F+"px;height:"+M+"px;left:"+(v-1)+"px;top:"+(C-1)+"px;'></div>"),s.push("</div>"),Fai.top.$(s.join("")).appendTo(r).find(".J_selectedArea").show(),e.each(i,function(e,t){t.$elem.addClass("J_onSelected")});!function(i,a,r,s){var d,h,p=e(".J_selectedTool");if(p.length<1){h=function(){var e=[{toolType:"Align",toolList:[{toolFunc:"left",toolFuncName:"左对齐"},{toolFunc:"right",toolFuncName:"右对齐"},{toolFunc:"top",toolFuncName:"上对齐"},{toolFunc:"bottom",toolFuncName:"下对齐"},{toolFunc:"level",toolFuncName:"上下居中"},{toolFunc:"vertical",toolFuncName:"左右居中"}]},{toolType:"Spread",toolList:[{toolFunc:"vertical",toolFuncName:"垂直等距离"},{toolFunc:"level",toolFuncName:"水平等距离"}]}];r.hasClass("fk-webBannerZone")||r.hasClass("fk-webFooterZone")&&!Fai.top._useFooterVersionTwo||(e.push({toolType:"Copy",toolFunc:"copyAll"}),e.push({toolType:"Delete",toolFunc:"deleteAll"}));return e}(),d=function(e){var t=[];t.push("<div class='fk-selectedTool J_selectedTool'>");for(var o,i=0;i<e.length;i++){if(o=e[i],t.push("<div class='f-toolType f-tool"+o.toolType+" J_toolType'>"),o.toolList&&o.toolList.length){t.push("<div class='f-icon f-toolType-icon J_toolTypeIcon J_toolTypeIcon"+o.toolType+"'></div>"),t.push("<div class='f-toolType-wrap J_toolTypeWrap'>"),t.push("<div class='f-wrap-cover'></div>");for(var a,n=0;n<o.toolList.length;n++)a=o.toolList[n],t.push("<div class='f-wrap-item' onclick='Fai.top._elemZone."+a.toolFunc+o.toolType+"();'>"),t.push("<div class='f-icon f-icon-"+a.toolFunc+"'></div>"),t.push("<div class='f-text'>"+a.toolFuncName+"</div>"),t.push("</div>");t.push("</div>")}else t.push("<div class='f-icon f-toolType-icon J_toolTypeIcon J_toolTypeIcon"+o.toolType+"' onclick='Fai.top._elemZone."+o.toolFunc+"();'></div>");t.push("</div>")}return t.push("</div>"),t.join("")}(h);r.find(".J_selectedAreaWrap");p=Fai.top.$(d).appendTo("#web"),function(i,a,r,s){var d=e(".J_selectedTool");if(d.length<1)return;var h=r.data("info");function p(t){var o=e.extend(!0,[],h.mat);t();var i=e.extend(!0,[],h.mat);Site.undoRun(function(){},{type:"module.select",detail:"zoneSelectResizeStop",undoSame:!1,redoSame:!1,undoFn:Fai.top._undo.zoneSelectMoveUndo,redoFn:Fai.top._undo.zoneSelectMoveUndo,undoArgs:[o,h,r,c],redoArgs:[i,h,r,c]})}function f(e){for(var t=[],o=[],n=!0,l=0,s=0;n;){var l=u(t=b(h.mat,e),g,e),d=l/(t.length-1);u(t,m,e,d),n=!1;for(var p=0;p<t.length;p++)t[p]!==o[p]&&(n=!0);s!==l&&(n=!0),o=t,s=l}c(i,a,r)}function u(t,o){var i,a,n=[].slice.call(arguments,2);return e.each(t,function(e,t){0!=e?(a=o.apply(t,[i,t,e,a].concat(n)),i=t):i=t}),a}function m(e,t,o,i,a,n){var l,r=["left","top"][a],s=["right","bottom"][a],d=["right","bottom"][a],h=["outerWidth","outerHeight"][a],c=["marginLeft","marginTop"][a],p={};t[r]=e[s]+e[c]+n-t[c],l=t[r],p[r]=l+"px",t[d]=l+t[h],t.$elem.css(p)}function g(e,t,o,i,a){var n=["left","top"][a],l=["marginLeft","marginTop"][a],r=["right","bottom"][a],s=t[n]+t[l]-(e[r]+e[l]);return(i||0)+s}function b(e,t){for(var o,i,a=e.length,n=["left","top"][t],l=["marginLeft","marginTop"][t];a>0;){for(o=0;o<a-1;o++)e[o][n]+e[o][l]>e[o+1][n]+e[o+1][l]&&(i=e[o],e[o]=e[o+1],e[o+1]=i);a--}return e}d.find(".J_toolType").off("mouseenter.toggle, mouseleave.toggle").on("mouseenter.toggle, mouseleave.toggle",function(){var t=e(this),o=t.find(".J_toolTypeIcon"),a=t.find(".J_toolTypeWrap"),n=i.length>1&&"none"==a.css("display");if(n){if(o.hasClass("J_toolTypeIconSpread")&&i.length<3)return;a.show();var l=t.offset();if(0==e("#bannerV2").find(a).length&&a.css({left:l.left+"px",top:l.top+36+"px"}),"fk-webFooterZone"==r.attr("id")){var s,d,h=e(window).height(),c=t.outerHeight(),p=h-l.top-c,f=a.outerHeight();p<f?(s=a.position().top,d=s-f-c,a.css({top:d+"px"}),a.find(".f-wrap-cover").css({bottom:-2,top:"initial"})):a.find(".f-wrap-cover").css({bottom:"",top:""})}o.addClass("f-toolTypeIcon-show")}else a.hide(),o.removeClass("f-toolTypeIcon-show")}),d.find(".J_toolTypeWrap").off("click.toggle").on("click.toggle",function(e){d.find(".J_toolTypeWrap").hide(),d.find(".J_toolTypeIcon").removeClass("f-toolTypeIcon-show")}),d.find(".J_toolTypeIcon").off("click.tip").on("click.tip",function(t){var o=e(this);o.hasClass("J_toolTypeIconAlign")&&i.length<2&&Fai.ing("圈选两个以上模块，才可以使用对齐功能",!0),o.hasClass("J_toolTypeIconSpread")&&i.length<3&&Fai.ing("圈选三个以上模块，才可以使用等距离分布功能",!0)}),function(){var e=d.find(".J_toolTypeIconAlign");i.length<2?e.css({cursor:"not-allowed"}):e.removeCss("cursor");var t=d.find(".J_toolTypeIconSpread");i.length<3?t.css({cursor:"not-allowed"}):t.removeCss("cursor")}(),t.leftAlign=function(){p(function(){_(1),h.eachMat(function(e,t){t.left=s.left+2-t.marginLeft}),h.styleChanged(),c(i,a,r),h.resetCopy()})},t.rightAlign=function(){p(function(){_(1),h.eachMat(function(e,t){t.left=s.right-2-t.outerWidth-t.marginLeft}),h.styleChanged(),c(i,a,r),h.resetCopy()})},t.topAlign=function(){p(function(){_(1),h.eachMat(function(e,t){t.top=s.top+2-t.marginTop}),h.styleChanged(),c(i,a,r),h.resetCopy()})},t.bottomAlign=function(){p(function(){_(1),h.eachMat(function(e,t){t.top=s.bottom-2-t.outerHeight-t.marginTop}),h.styleChanged(),c(i,a,r),h.resetCopy()})},t.verticalAlign=function(){p(function(){_(1);var e=(s.right+s.left)/2;h.eachMat(function(t,o){var i=e-o.outerWidth/2-o.marginLeft;o.left=i}),h.styleChanged(),c(i,a,r),h.resetCopy()})},t.levelAlign=function(){p(function(){_(1);var e=(s.bottom+s.top)/2;h.eachMat(function(t,o){var i=e-o.outerHeight/2-o.marginTop;o.top=i}),h.styleChanged(),c(i,a,r),h.resetCopy()})},t.levelSpread=function(){p(function(){_(2),f(0),h.styleChanged(),h.resetCopy()})},t.verticalSpread=function(){p(function(){_(2),f(1),h.styleChanged(),h.resetCopy()})},t.deleteAll=function(){if(_(0),h.mat.length>20)return Fai.ing("已超过20个模块，不支持批量隐藏",!0),void Site.logDog(200334,22);Fai.ing("正在隐藏模块......"),setTimeout(function(){Fai.top._delCount=h.mat.length,h.mat.forEach(function(e){Fai.top._delCount--,Site.hideModule(e.id,!1,o,!0)}),h.styleChanged(),e(document).trigger("exitEditMode.selectable")},0)},t.copyAll=function(){if(Site.logDog(200334,21),h.mat.length>20)return Fai.ing("已经超过20个模块，不支持批量复制",!0),void Site.logDog(200334,23);var t=e(".J_selectedArea"),i=t.width(),a=t.position().left,s=t.height(),d=t.position().top,p=r.width(),f=r.height(),u=0,m=0;switch(p-i-a>i+10?"right":f-s-d>s+10?"bottom":a>i?"left":d>f?"top":p>i+10&&f>s+10?"normal":"same"){case"right":u=i+10;break;case"bottom":m=s+10;break;case"left":u=-(i+10);break;case"top":m=-(s+10);break;case"normal":u=m=10;break;case"same":default:u=m=0}var g=[];h.mat.forEach(function(e){g.push(parseInt(e.id))}),h.mat.splice(0,h.mat.length),c(h.mat,h.all,r),l(h.all),Site.copyAllModule(g,o,o,{extFunc:function(t,o){var i=e("#module"+t),a=e("#module"+o),l=i.position().left,s=i.position().top;a.css({left:l+u+"px",top:s+m+"px"}),h.addNewElem(a),h.mat.length==g.length&&(h.mat.forEach(function(e){e.$elem.css("opacity",""),Site.moduleAnimation.publishOne(e.id)}),n(h.mat),c(h.mat,h.all,r))}})}}(i,a,r,s),u()}return p}(i,a,r,b),function(o,i,a,n,l){var r=Fai.top.$("#selectedAreaWrap"+o);if(r.length<1)return;var s,d,h,p,g,b,v=r.find(".J_selectedArea"),C=(n.find(".J_onSelected"),e(".J_selectedTool")),_=n.data("info"),S=n.attr("id").replace("elemZone","").replace("fk-packContent","");n.hasClass("J_fullmeasurePackContent")&&(S=n.attr("moduleid"));S&&(_.zoneId=S),v.draggable("destroy").draggable({tolerance:2,smartguides:".form:not(.J_onSelected), .elemZoneCell, #localer, #corpTitle, #nav2",scroll:!1,start:function(t,o){var i=o.position;h=i.left,p=i.top,C.hide(),s=e.extend(!0,[],_.mat),_.styleChanged()},drag:function(e,t){var o=t.position,i=o.left,a=o.top,n=i-h,l=a-p;f(n,l,_),h=i,p=a},stop:function(t,o){l.left=o.position.left,l.top=o.position.top,l.right=l.left+l.width+2,l.bottom=l.top+l.height+2,m(n,l),u(),Site.logDog(200084,2),Fai.top._moduleMoved++,Site.changeParentModuleHeightToAuto(_.mat[0].id),n.find(".J_selectableMask").css({width:n.width()+"px",height:n.height()+"px"}),Fai.top.$(window).trigger("resize.addModuleMask");var i=e.extend(!0,[],_.mat),a=e.extend(!0,[],s);Site.undoRun(function(){},{type:"module.select",detail:"zoneSelectableDrag",undoSame:!1,redoSame:!1,undoFn:Fai.top._undo.zoneSelectMoveUndo,redoFn:Fai.top._undo.zoneSelectMoveUndo,undoArgs:[a,_,n,c],redoArgs:[i,_,n,c]})}}).resizable("destroy").resizable({autoHide:!1,handles:"n, e, s, w, se, sw, ne, nw",aspectRatio:!1,create:function(){Site.resizeModule.customHandles(e(this))},start:function(t,o){g=o.size.width,b=o.size.height,h=o.position.left,p=o.position.top,C.hide(),_.eachMat(function(e,t){82!=t.style&&(t.origWidth=t.width,t.origHeight=t.height)},function(t,o){if(82!=o.style)if(79==o.style){var i=o.$elem;i.find(".formMiddleContent").css("overflow","visible"),i.find(".formMiddleContent").css("overflow-y","visible");var a=i[0].id.slice(6),n=e("#hoverEftDialog"+a);n.length>0&&Site.removeHoverEftDialog&&Site.removeHoverEftDialog(a)}else o.style}),_.styleChanged(),_.resetCopy(),d=e.extend(!0,[],_.mat)},resize:function(t,o){l.width=o.size.width,l.height=o.size.height,l.top=o.position.top,l.left=o.position.left,l.bottom=l.top+l.height,l.right=l.left+l.width;var i=l.width-2,a=l.height-2,n=g-2,r=b-2,s=l.left+3,d=l.top+3;l.left,l.top;_.eachMat(function(e,t){82!=t.style&&(t.$elem.hasClass("elemZoneCell")&&!t.$elem.hasClass("elemZoneCellResize")||(t.width=t.outerWidth*(i/n)-t.borderLeft-t.borderRight,t.height=t.outerHeight*(a/r)-t.borderTop-t.borderBottom,t.left=(t.left+l.left-h-s+t.marginLeft)*(i/n)+s-t.marginLeft,t.top=(t.top+l.top-p-d+t.marginTop)*(a/r)+d-t.marginTop))},function(o,i){if(82!=i.style){var a=i.$elem;79==i.style?function(){var e=i.$elem,t=e.find(".formBanner"),o=t.is(":visible")?t.height():0;e.find(".J_defImage, .floatImgWrap"+(e.find(".J_fonticon").length>0?"":", .forMargin")).css({width:i.width,height:i.height-o});var a=i.width-1,n=i.height,l=a>n?n:a;-1!=e.find(".float_in_img").attr("class").indexOf("mr")&&a<260&&(l=a/2),e.find(".float_in_img").css({"font-size":l,"line-height":n+"px"}),e.find(".J_hoverImage").css({"font-size":l,"line-height":n+"px"})}():81==i.style?function(){var e=i.$elem,o=e.find(".floatBtn"),n=2*parseInt(o.css("borderLeftWidth"))||0,l=o.height();Site.absAlignLine.resize.init(a,e,t,["top","right","bottom","left"]);var r=e.attr("id").replace("module","");Site.setModuleStyleCssList(r,[{cls:".floatBtn",key:"width",value:i.width-n+"px"},{cls:".floatBtn",key:"height",value:i.height-n+"px"},{cls:".floatBtn",key:"line-height",value:l+"px"}])}():86==i.style?(Site.refreshSimpleEditor(a,a),Fai.top.$(".J_fkEditor_tool").css("display","none")):function(){if(a.find(".formMiddle").find(".formMiddleCenter").css("vertical-align","top"),(a.hasClass("formStyle35")||a.hasClass("formStyle29")||a.hasClass("formStyle110"))&&a.attr("_mousein",1),a.hasClass("formStyle97")){var t=a.attr("id").substring(6);e(".styleMall"+t).hide()}}()}}),g=o.size.width,b=o.size.height,h=o.position.left,p=o.position.top},stop:function(t,o){l.width=o.size.width,l.height=o.size.height,l.top=o.position.top,l.left=o.position.left,l.bottom=l.top+l.height,l.right=l.left+l.width,_.eachMat(function(t,o){if(82!=o.style&&(!o.$elem.hasClass("elemZoneCell")||o.$elem.hasClass("elemZoneCellResize"))){var i=o.style,a=o.$elem,n=(a[0],o.$elem);79==i?function(){var e=o.$elem,t=e.attr("id").replace("module",""),i=Site.checkNestModule(n);Fai.top._moduleMoved++,Site.moduleSizeChange("module"+t),e.trigger("Fai_onModuleSizeChange"),e.find("map").length&&Site.refreshFloatImgHotArea(modules),i.inPack&&Site.setModuleAttrDataChange(i.parentId),Site.protectZoneElemView(e),setTimeout(function(){Site.triggerGobalEvent("changeParentModuleHeightToAuto",{id:t})},0);var a=e[0].id.slice(6);refreshHoverImgEft(a,e.data("imgHoverEft")),3==Site.getModuleStatus(a)&&Site.refreshAbsFloatForm(e);var l=o.width,r=o.height,s=(parseInt(l)-8)/2-2,d=(parseInt(r)-8)/2-2;e.children(".ui-resizable-s").children(".imgResizeLine").css({width:s+"px"}),e.children(".ui-resizable-n").children(".imgResizeLine").css({width:s+"px"}),e.children(".ui-resizable-e").children(".imgResizeLine").css({height:d+"px"}),e.children(".ui-resizable-w").children(".imgResizeLine").css({height:d+"px"})}():81==i?function(){var t=n,o=t.find(".floatBtn"),i=Site.checkNestModule(n);e(".draggableBtn").css({opacity:"1"}),Site.enableEditLayer();var a=e("#dockTip");a.hide();var l=t.attr("id").replace("module",""),r=o.height();Site.setModuleStyleCssList(l,[{cls:".floatBtn",key:"line-height",value:r+"px"}]),Site.getModuleAttrPattern(l).changed=!0;var s=Site.getModuleAttrPattern(l).floatBtn;s.s=s.s||{},s.s.t=1,s.s.w=parseInt(o.width()),s.s.h=parseInt(o.height()),Fai.top._moduleMoved++,Site.setFlBtnModuleWidth(t),Site.styleChanged(),Site.moduleSizeChange("module"+l),t.trigger("Fai_onModuleSizeChange"),Fai.top.$("#absAlignTop, #absAlignRight, #absAlignBottom,#absAlignLeft").hide(),i.inPack&&Site.setModuleAttrDataChange(i.parentId),Site.protectZoneElemView(t),setTimeout(function(){Site.triggerGobalEvent("changeParentModuleHeightToAuto",{id:l})},0)}():86==i?(a.find(".J_resizableTip").length>0?a.find(".J_resizableTip").show():a.append("<a href='javascript:;' class='J_resizableTip moduleAutoHeight ui-resizable-cancelTip fk-resizable-cancelTip' style='z-index:1000;' parentid='"+a.attr("id")+"' _faiscoTip='还原模块默认高度' onclick='Site.absModuleAutoHeightDo("+a.attr("id").replace("module","")+");return false;'></a>"),(a.find(".fk-editor-vertical-rl").length>0||a.find(".fk-editor-vertical-lr").length>0)&&a.find(".fk-editor").attr("_autowidth",0),Site.createSimpleTextAutoWidthBtn(a),l.apply(o.$elem[0])):l.apply(o.$elem[0]),o.$elem.attr("_autoheight",0),Site.refreshModuleHeight(o.id)}function l(t,i){var a=e(this).attr("_moduleid"),n=Site.checkNestModule(e(this));if(Site.protectZoneElemView(e(this)),(e(this).hasClass("formStyle35")||e(this).hasClass("formStyle29")||e(this).hasClass("formStyle110"))&&e(this).attr("_mousein",1),!e(this).hasClass("elemZoneCell")){var l=e(this).attr("id").replace("module","");if(e(this).children(".ui-resizable-cancelTip").length<1){e(this).find(".ui-resizable-se").css("z-index");(e(this).hasClass("formStyle29")||e(this).hasClass("formStyle110")||e(this).hasClass("formStyle35")||e(this).hasClass("formStyle80"))&&" ui-resizable-cancelTip2 fk-resizable-cancelTip2"}Site.getModuleAttrPattern(l).changed=!0,Site.setModuleAttrDataChange(n.parentId);var r=e(this).attr("_side");2!=r&&Site.refreshAbsFloatForm(e(this)),Site.refreshSideBtn(e(this)),Site.moduleSizeChange("module"+l),(e(this).hasClass("formStyle5")||e(this).hasClass("formStyle77"))&&Site.refreshModulePhotoSwitch(l),Site.triggerGobalEvent("resizableModuleChange",l),Fai.top.$("#absAlignTop, #absAlignRight, #absAlignBottom,#absAlignLeft").hide(),e(this).hasClass("formStyle83")&&Site.initPhotoCard(l),e(this).hasClass("formStyle85")&&Site.initPhotoNewCard(l),e(this).hasClass("formStyle98")&&(e(this).width()<=400?(e(this).css("height",o.origHeight+"px"),e(this).css("width",o.origWidth+"px"),o.height=o.origHeight,o.width=o.origWidth):o.origWidth!=e(this).width()?Site.initPhotoMoreCard(l,o.origWidth):Site.initPhotoMoreCard(l)),e(this).hasClass("formStyle97")&&(a=e(this).attr("_moduleid"),e(this).find(".mallHead").click(),e(".styleMall"+a).stop(!0,!0).show()),Site.triggerGobalEvent("changeParentModuleHeightToAuto",{id:a})}e(this).trigger("Fai_onModuleSizeChange"),function(e){var t=e.module,o=t.width(),i=t.height(),a=t.position(),n=a.left,l=a.top,r=Fai.top.$("#module"+e.parentId),s=r.width(),d=r.height(),h=!1,c=!1;n>=s?(n=s-o,h=!0):n<=-o&&(n=0,h=!0);l>=d?(l=d-i,c=!0):l<=-i&&(l=0,c=!0);h&&t.css("left",n+"px");c&&t.css("top",l+"px")}({module:e(this),parentId:n.parentId}),e(this).parent().hasClass("J_packContent")?(Site.logDog(100092,0),Site.logDog(100092,6),Site.logDog(100045,64)):e(this).parent().hasClass("J_moduleZone")&&(Site.logDog(100092,0),Site.logDog(100092,7)),Site.styleChanged()}},function(e,t){t.$elem.hasClass("elemZoneCell")&&Site.refreshResizableHandles(t.$elem)}),c(i,a,n),u(),e(this).find(".ui-resizable-handle").show();var r=e.extend(!0,[],_.mat),s=e.extend(!0,[],d);Site.undoRun(function(){},{type:"module.select",detail:"zoneSelectResizeStop",undoSame:!1,redoSame:!1,undoFn:Fai.top._undo.zoneSelectResizeUndo,redoFn:Fai.top._undo.zoneSelectResizeUndo,undoArgs:[s,_,n,c],redoArgs:[r,_,n,c]})}}).off(".rh").on("hover.rh",function(){e(this).find(".ui-resizable-handle").show()});var y=!1;Fai.top.$(document).off("keydown.areaDrag").on("keydown.areaDrag",function(o){var i={37:1,38:1,39:1,40:1};if(i[o.which]){var a=e.extend(!0,[],_.mat);o.preventDefault();var r=v.position(),s=r.left,d=r.top,h=0,p=0;switch(o.which){case 37:h=-1;break;case 38:p=-1;break;case 39:h=1;break;case 40:p=1}l.left=l.left+h,l.right=l.right+h,l.top=l.top+p,l.bottom=l.bottom+p,v.css({left:s+h,top:d+p}),f(h,p,_),i=e.map(_.mat,function(e,t){return"#"+e.elemZoneId}).join(","),i=Fai.top.$(i);var g=e.map(_.mat,function(e,t){return e.elemZoneId});t.initAlignLine({elem:i,helper:i,notElem:g}),t.refreshAlignLine({elem:i,helper:i}),m(n,l),u(),_.styleChanged(),Site.logDog(200084,3),Fai.top._moduleMoved++,y||(y=!0,Fai.top.$(document).off("keyup.areakey").one("keyup.areakey",function(){y=!1;var t=e.extend(!0,[],_.mat);Site.undoRun(function(){},{type:"module.select",detail:"zoneSelectResizeStop",undoSame:!1,redoSame:!1,undoFn:Fai.top._undo.zoneSelectMoveUndo,redoFn:Fai.top._undo.zoneSelectMoveUndo,undoArgs:[a,_,n,c],redoArgs:[t,_,n,c]})}))}})}(d,i,a,r,b),m(r,b)}function k(t,o){return[Math.min,Math.max][o].apply(null,e.map(g,function(e,o){var i={left:e.marginLeft,right:e.marginLeft,top:e.marginTop,bottom:e.marginTop};return e[t]+i[t]}))}}function p(t){var o=t.find(".J_selectedAreaWrap");t.find(".J_onSelected").removeClass("J_onSelected"),o.off().remove(),function(t){var o=e(".J_selectedTool");if(o.length<1)return;o.off().remove()}(),Fai.top.$(document).off("keydown.areaDrag")}function f(e,t,o){o.eachMat(function(o,i){i.left=i.left+e,i.top=i.top+t})}function u(){var t=e(".J_selectedTool"),o=e(".J_selectedArea"),i=e("#fk-toolTopBar"),a=e("#g_main");if(!(t.length<1||o.length<1)){var n=0,l=0,r=0,s=null,d=0;i.length>0&&(r=i.height()),o.length>0&&(n=(s=o.offset()).top,l=s.left),a.length>0&&(d=a.scrollTop()||0);var h=e("#topAdvArea"),c=e("#memberBarArea"),p=e("#sitetips"),f=0;h.length>0&&"none"!==h.css("display")&&(f+=h.height()),c.length>0&&"none"!==c.css("display")&&(f+=c.height()),p.length>0&&"none"!==p.css("display")&&(f+=p.height()),a[0].scrollLeft>0&&(l+=a[0].scrollLeft),n=n-r-40+d-f,t.css({left:l,top:n}).show()}}function m(e,t){var o=e.data("info"),i=e.width(),a=e.height(),n=Fai.top.$(".J_selectedArea");o.eachMat(function(e,a){var l=a.left<0&&a.right+2*a.marginLeft<10,r=i-a.left<10;if(l||r){var s=0;l?s=-t.left:r&&(s=i-t.right);t.left=t.left+s,t.top=t.top+0,t.right=t.left+t.width,t.bottom=t.top+t.height,n.css(t);t.left,t.top;return f(s,0,o),u(),!1}}),o.eachMat(function(e,i){var l=i.top<0&&i.bottom+2*i.marginTop<10,r=a-i.top<10;if(l||r){var s=0;return l?s=-t.top:r&&(s=a-t.bottom),t.left=t.left+0,t.top=t.top+s,t.right=t.left+t.width,t.bottom=t.top+t.height,n.css(t),f(0,s,o),u(),!1}})}function g(){this.all=[],this.mat=[],this.hasInit=!1,this.copy=[]}function b(){var t=e(this),o=t.attr("id"),i=t.attr("_moduleid"),a=t.position(),n=a.left,l=a.top,r=t.width(),s=t.height(),d=t.outerWidth(),h=t.outerHeight(),c=+t.css("border-left-width").replace("px",""),p=+t.css("border-right-width").replace("px",""),f=+t.css("border-top-width").replace("px",""),u=+t.css("border-bottom-width").replace("px",""),m=+t.css("margin-left").replace("px",""),g=+t.css("margin-right").replace("px",""),b=+t.css("margin-top").replace("px",""),v=+t.css("margin-bottom").replace("px",""),C=n+d,_=l+h,S=t.attr("_modulestyle");return{left:n,top:l,width:r,height:s,right:C,bottom:_,size:{width:r,height:s},outerWidth:d,outerHeight:h,outerSize:{width:d,height:h},borderLeft:c,borderRight:p,borderTop:f,borderBottom:u,marginLeft:m,marginRight:g,marginTop:b,marginBottom:v,position:{left:n,top:l},config:e.extend({},this.size,this.position,{right:this.right,bottom:this.bottom}),style:S,$elem:t,id:i||"elemCell",elemZoneId:o}}function v(e,t){return this.width=0,this.height=0,this.$wrap=Fai.top.$(t),this.fClass="fk-mouseSelectableTool",this.jClass="J_mouseSelectableTool",this._getMousePosition(e),this._update(),this._create(),this}t.selectToolAllZone=function(){e(".elemZone").each(function(){a(this)})},t.selectToolOneZone=function(e){var t=e.hasClass("elemZone")?e:e.find(".elemZone");t.length>0&&t.each(function(){a(this)})},t.destroySelectToolOneZone=function(e){var t=e.hasClass("elemZone")?e:e.find(".elemZone");t.length>0&&(t.each(function(){t.off(".mouseSelectable").off(".ctrlClickSelectable")}),Fai.top.$(document).trigger("exitEditMode.selectable"))},t.selectToolModuleZone=function(){a(Fai.top.$("#fk-webBannerZone")),Fai.top._useBannerVersionTwo?a(Fai.top.$(".fk-inBannerListZone")):a(Fai.top.$("#fk-webHeaderZone")),a(Fai.top.$("#fk-webFooterZone")),i()},t.selectToolPackZone=function(){e(".J_packContent").each(function(){a(this)})},t.disableSelectable=function(e){var t=Fai.top.$(e);t.length<1||t.off(".mouseSelectable").off(".ctrlClickSelectable")},g.prototype.reset=function(){this.all.splice(0,this.all.length),this.mat.splice(0,this.mat.length),this.hasInit=!1,this.resetCopy()},g.prototype.refresh=function(e,t){var o,i,a=e.left,n=e.right,l=e.top,r=e.bottom,s=[];for(o=0,i=this.all.length;o<i;o++){var d,h=(d=this.all[o]).left,c=d.right,p=d.top,f=d.bottom;81==d.style&&(h+=d.marginLeft,c+=d.marginLeft,p+=d.marginTop,f+=d.marginTop),c<a||p>r||h>n||f<l?t||this.delMat(d):t?s.push(d):this.addMat(d)}if(t){var u=s.sort(function(e,t){return e.$elem.index()<t.$elem.index()})[0];this.addMat(u)}},g.prototype.delMat=function(t){for(;e.inArray(t,this.mat)>-1;)this.mat.splice(e.inArray(t,this.mat),1)},g.prototype.addMat=function(t){e.inArray(t,this.mat)>-1||this.mat.push(t)},g.prototype.hasMat=function(){return this.mat.length>0},g.prototype.addNewElem=function(e){var t=b.call(e);this.all.push(t),this.mat.push(t)},g.prototype.init=function(e){var t=this;e&&(t.hasInit||(e.find(">.form:visible:not(.formLockEdit), >.elemZoneCell:visible").each(function(){var e=b.call(this);t.all.push(e)}),t.hasInit=!0))},g.prototype.getElemInfo=function(e){var t,o;for(t=0,o=this.all.length;t<o;t++)if(this.all[t].$elem.is(e))return this.all[t];return null},g.prototype.eachMat=function(t,o){var i,a,n;for(i=0,a=this.mat.length;i<a;i++){n=this.mat[i];t.apply(n.$elem[0],[i,n]);n.outerWidth=n.width+n.borderLeft+n.borderRight,n.outerHeight=n.height+n.borderTop+n.borderBottom,n.bottom=n.top+n.outerHeight,n.right=n.left+n.outerWidth,n.size.width=n.width,n.size.height=n.height,n.position.left=n.left,n.position.top=n.top,n.outerSize.width=n.outerWidth,n.outerSize.height=n.outerHeight,e.extend(n.config,n.size,n.position,{right:n.right,bottom:n.bottom}),n.$elem.css(n.size).css(n.position).find(".J_selectedLineWrap").css(n.outerSize),"function"==typeof o&&o.apply(n.$elem[0],[i,n])}},g.prototype.styleChanged=function(t){Site.getModuleAttrPattern(this.zoneId).changed=!0,Site.getModuleAttrData(this.zoneId).changed=!0,e.each(this.mat,function(e,t){var o=t.id;Site.getModuleAttrPattern(o).changed=!0,Site.getModuleAttrData(o).changed=!0}),Site.styleChanged()},g.prototype.setCopy=function(e){this.resetCopy();for(var t=0;t<this.mat.length;t++)this.copy.push(this.mat[t])},g.prototype.resetCopy=function(e){this.copy.splice(0,this.copy.length)},v.prototype._getMousePosition=function(e){var t=this.$wrap.offset(),o=t.left,i=t.top,a=e.clientY-i,n=e.clientX-o;return this.left=n,this.top=a,this},v.prototype._update=function(){return this.right=this.left+this.width,this.bottom=this.top+this.height,this.size={width:this.width,height:this.height},this.position={left:this.left,top:this.top},this.config=e.extend({},this.size,this.position,{right:this.right,bottom:this.bottom}),this},v.prototype._create=function(){return this.oriLeft=this.left,this.oriTop=this.top,this.oriPosition={left:this.oriLeft,top:this.oriTop},Fai.top.$("."+this.jClass).remove(),this.$elem=Fai.top.$("<div class='"+this.fClass+" "+this.jClass+"'></div>").appendTo(this.$wrap).css(this.oriPosition),this},v.prototype.change=function(e){return this._getMousePosition(e),this.width=Math.abs(this.left-this.oriLeft),this.height=Math.abs(this.top-this.oriTop),this.left>this.oriLeft&&(this.left=this.left-this.width),this.top>this.oriTop&&(this.top=this.top-this.height),this._update(),this.$elem.css(this.size).css(this.position),this},v.prototype.remove=function(){return this.$elem.remove(),this.$elem=null,this.$wrap=null,this},v.prototype.getConfig=function(){return e.extend({},this.config)};function C(e){var t={"fk-webHeaderZone":6,"fk-webFooterZone":7,J_packContent:8,J_popupZoneContent:9,"fk-inBannerListZone":18,J_subNavPack:20,J_bottomFloatLayerContent:24,J_fullmeasurePackContent:25,J_tabPackContent:26,J_topAdvContent:27};for(var o in t)if(e.hasClass(o)){Site.logDog(200334,t[o]);break}}function _(e){Site.logDog(200334,[15,16,17][e])}}(jQuery,Fai.top._elemZone||(Fai.top._elemZone={})),function(e,t,o,i){i.init=function(){i.sortAllZoneModule(),i.resizeAllZoneModule(),i.dragAllZoneCell(),i.resizeAllZoneCell(),i.selectToolAllZone(),i.initAllPackAddModuleBtn()},i.initOne=function(e){!function(e){i.sortOneZoneModule(e),i.resizeOneZoneModule(e),i.dragOneZoneCell(e),i.resizeOneZoneCell(e),i.selectToolOneZone(e),i.initAddModuleBtn(e)}(e)},i.destroyOne=function(e){!function(e){i.destroySortOneZoneModule(e),i.destroyResizeOneZoneModule(e),i.destroyDragOneZoneCell(e),i.destroyResizeOneZoneCell(e),i.destroySelectToolOneZone(e),i.removeZoneEditBtn(e)}(e)}}($,Fai,Site,Fai.top._elemZone||(Fai.top._elemZone={}));