function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var PhotoSphereViewer=function(e){var t=function(){var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl"))},o=function(e,t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent("on"+t,o)},i=function(e,t,o){return Math.max(t,Math.min(o,e))},n=function(e,t,o,i){var n=o-e,r=i-t;return n*n+r*r},r=function(e,t){return(t=void 0!==t&&!!t)&&e==2*Math.PI?2*Math.PI:e-2*Math.floor(e/(2*Math.PI))*Math.PI};this.load=function(){if(Ee.innerHTML="",ot&&1===ot.nodeType)Ee.appendChild(ot);else if(ot&&"string"==typeof ot)Ee.innerHTML=ot;else if(tt){var e=document.createElement("img");e.setAttribute("src",tt),e.setAttribute("alt",et),Ee.appendChild(e)}else Ee.textContent=et;var t;((Re=document.createElement("div")).style.width="100%",Re.style.height="100%",Re.style.position="relative",Re.style.overflow="hidden",(t=document.createElement("canvas")).getContext&&t.getContext("2d"))?void 0!==window.THREE?(_e={width:0,height:0,ratio:0},je&&!Ie.match(/^data:image\/[a-z]+;base64/)?a():l()):console.log("PhotoSphereViewer: Three.js is not loaded."):Ee.textContent="Canvas is not supported, update your browser!"};var s=function(e,t){var o=e.indexOf("GPano:"+t)+t.length+8,i=e.indexOf('"',o);return-1==i&&(o=e.indexOf("GPano:"+t)+t.length+7,i=e.indexOf("<",o)),e.substring(o,i)},a=function(){var e=null;if(window.XMLHttpRequest)e=new XMLHttpRequest;else{if(!window.ActiveXObject)return void(Ee.textContent="XHR is not supported, update your browser!");try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){e=new ActiveXObject("Microsoft.XMLHTTP")}}e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var t=function(e){for(var t=0,o=0,i="";-1!=(t=e.indexOf("<x:xmpmeta",o))&&-1!=(o=e.indexOf("</x:xmpmeta>",t));)if(-1!=(i=e.substring(t,o)).indexOf("GPano:"))return i;return""}(e.responseText);if(!t.length)return void l();Ke={full_width:parseInt(s(t,"FullPanoWidthPixels")),full_height:parseInt(s(t,"FullPanoHeightPixels")),cropped_width:parseInt(s(t,"CroppedAreaImageWidthPixels")),cropped_height:parseInt(s(t,"CroppedAreaImageHeightPixels")),cropped_x:parseInt(s(t,"CroppedAreaLeftPixels")),cropped_y:parseInt(s(t,"CroppedAreaTopPixels"))},Qe=!0,l()}},e.open("GET",Ie,!0),e.send(null)},l=function(){var e=new Image;e.onload=function(){var o={full_width:e.width,full_height:e.height,cropped_width:e.width,cropped_height:e.height,cropped_x:null,cropped_y:null};if(360!=Je.horizontal_fov||180!=Je.vertical_fov){if(Ke.cropped_width=o.cropped_width,Ke.cropped_height=o.cropped_height,Ke.full_width=o.full_width,Ke.full_height=o.full_height,360!=Je.horizontal_fov){var i=Je.horizontal_fov/360;Ke.full_width=Ke.cropped_width/i}if(180!=Je.vertical_fov){var n=Je.vertical_fov/180;Ke.full_height=Ke.cropped_height/n}}else{for(var r in Ke)null===Ke[r]&&void 0!==o[r]&&(Ke[r]=o[r]);if(Qe){if(Ke.cropped_width!=o.cropped_width){var s=o.cropped_width/Ke.cropped_width;Ke.cropped_width=o.cropped_width,Ke.full_width*=s,Ke.cropped_x*=s}if(Ke.cropped_height!=o.cropped_height){var a=o.cropped_height/Ke.cropped_height;Ke.cropped_height=o.cropped_height,Ke.full_height*=a,Ke.cropped_y*=a}}}null===Ke.cropped_x&&(Ke.cropped_x=(Ke.full_width-Ke.cropped_width)/2),null===Ke.cropped_y&&(Ke.cropped_y=(Ke.full_height-Ke.cropped_height)/2);var l=2048;if(t()){var c=document.createElement("canvas").getContext("webgl");l=c.getParameter(c.MAX_TEXTURE_SIZE)}var u=Math.min(Ke.full_width,l),h=u/Ke.full_width;Ke.full_width=u,Ke.cropped_width*=h,Ke.cropped_x*=h,e.width=Ke.cropped_width,Ke.full_height*=h,Ke.cropped_height*=h,Ke.cropped_y*=h,e.height=Ke.cropped_height;var p=document.createElement("canvas");p.width=Ke.full_width,p.height=Ke.full_height,p.getContext("2d").drawImage(e,Ke.cropped_x,Ke.cropped_y,Ke.cropped_width,Ke.cropped_height),d(p.toDataURL("image/jpeg"))},Ue&&!Ie.match(/^data:image\/[a-z]+;base64/)&&e.setAttribute("crossOrigin","anonymous"),e.src=Ie},d=function(e){var t=new THREE.Texture;t.minFilter=THREE.LinearFilter;(new THREE.ImageLoader).load(e,function(e){t.needsUpdate=!0,t.image=e,c(t)})},c=function(e){void 0!==Te.width&&(Ee.style.width=Te.width.css),void 0!==Te.height&&(Ee.style.height=Te.height.css),v(),(Pe=t()?new THREE.WebGLRenderer:new THREE.CanvasRenderer).setSize(_e.width,_e.height),Fe=new THREE.Scene,(He=new THREE.PerspectiveCamera(Z,_e.ratio,1,300)).position.set(0,0,0),Fe.add(He);var i=new THREE.SphereGeometry(200,ae,se),n=new THREE.MeshBasicMaterial({map:e,overdraw:!0}),r=new THREE.Mesh(i,n);if(r.scale.x=-1,Fe.add(r),(Me=document.createElement("div")).style.position="absolute",Me.style.zIndex=0,Re.appendChild(Me),ye&&(fe.setClass(be),fe.setStyle(we),fe.create(),Re.appendChild(fe.getBar())),null!==it){var s=document.createElement("img");s.onload=function(){s.style.display="block",s.style.position="absolute",s.style[it.position.x]="5px",s.style[it.position.y]="5px","bottom"==it.position.y&&ye&&(s.style.bottom=fe.getBar().offsetHeight+5+"px"),void 0!==it.size&&(s.style.width=it.size.width,s.style.height=it.size.height),Re.appendChild(s)},s.src=it.image}o(window,"resize",v),xe&&(o(Me,"mousedown",k),o(document,"mousemove",R),o(Me,"mousemove",D),o(document,"mouseup",S),o(Me,"touchstart",z),o(document,"touchend",S),o(document,"touchmove",M),Ce&&(o(Me,"mousewheel",H),o(Me,"DOMMouseScroll",H)),nt.addAction("fullscreen-mode",_)),o(document,"fullscreenchange",L),o(document,"mozfullscreenchange",L),o(document,"webkitfullscreenchange",L),o(document,"MSFullscreenChange",L),Ge.addListener(F),Ee.innerHTML="",Ee.appendChild(Re);var a=Pe.domElement;a.style.display="block",Me.appendChild(a),u(),le>0&&B(le),h(),W("ready")},u=function(){var e=new THREE.Vector3;e.setX(Math.cos(ie)*Math.sin(ne)),e.setY(Math.sin(ie)),e.setZ(Math.cos(ie)*Math.cos(ne)),He.lookAt(e),null!==Be?Be.render(Fe,He):Pe.render(Fe,He)};this.toggleStereo=function(){null!==Be?(Be=null,Pe.setSize(_e.width,_e.height),fe.mustBeHidden(!1),u(),W("stereo-effect",!1)):((Be=new THREE.StereoEffect(Pe)).eyeSeparation=ze,Be.setSize(_e.width,_e.height),P(),O(),fe.mustBeHidden(),u(),W("stereo-effect",!0))};var h=function(){!1!==ue&&(We=setTimeout(p,ue))},p=function(){!function e(){ie-=(ie-me)*ge,ne+=he;var t=!0;oe||(ne=i(ne,$,V))!=$&&ne!=V||(pe?he*=-1:(g(),t=!1)),ne=r(ne,!0),W("position-updated",{longitude:ne,latitude:ie}),u(),t&&(Xe=setTimeout(e,ce))}(),Ve=!0,W("autorotate",!0)},g=function(){clearTimeout(We),We=null,clearTimeout(Xe),Xe=null,Ve=!1,W("autorotate",!1)},m=function(){qe&&(qe=!1,p())};this.toggleAutorotate=function(){clearTimeout(We),Xe?g():p()};var v=function(){var e=y(Ee),t=e.detached,o=e.rendered;!1!==t||!1!==o||"px"!=Te.width.unit||"px"!=Te.height.unit?Ee.clientWidth==_e.width&&Ee.clientHeight==_e.height||b({width:Ee.clientWidth,height:Ee.clientHeight}):b({width:parseFloat(Te.width.css)||0,height:parseFloat(Te.height.css)||0})},f=function(e,t,o){return(window.getComputedStyle(e,o||null)||{display:"none"})[t]},y=function(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};for(var t=e;t!==document;){if("none"===f(t,"display"))return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}};this.fitToContainer=function(){v()};var b=function(e){_e.width=void 0!==e.width?parseInt(e.width):_e.width,_e.height=void 0!==e.height?parseInt(e.height):_e.height,_e.ratio=_e.width/_e.height,He&&(He.aspect=_e.ratio,He.updateProjectionMatrix()),Pe&&(Pe.setSize(_e.width,_e.height),u()),Be&&(Be.setSize(_e.width,_e.height),u())};this.getPosition=function(){return{longitude:ne,latitude:ie}},this.getPositionInDegrees=function(){return{longitude:180*ne/Math.PI,latitude:180*ie/Math.PI}};var w=function(e,t){var o=X(e);oe||(o=i(o,$,V));var n=X(t);n>Math.PI&&(n-=2*Math.PI),n=i(n,Q,J),W("position-updated",{longitude:ne=o,latitude:ie=n}),u()};this.moveTo=function(e,t){w(e,t)};var x=function(e,t){e=X(e),t=X(t),w(ne+e,ie+t)};this.rotate=function(e,t){x(e,t)};var _=function(e){(e?window.addEventListener:window.removeEventListener)("keydown",C)},C=function(e){var t=0,o=0;switch(function(e){if(e.key)return/^Arrow/.test(e.key)?e.key:"Arrow"+e.key;if(e.keyCode||e.which){var t=e.keyCode?e.keyCode:e.which,o={38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",37:"ArrowLeft"};if(void 0!==o[t])return o[t]}return""}(e)){case"ArrowUp":o=U;break;case"ArrowRight":t=-j;break;case"ArrowDown":o=-U;break;case"ArrowLeft":t=j}x(t,o)},k=function(e){E(parseInt(e.clientX),parseInt(e.clientY))},z=function(e){if(1==e.touches.length){var t=e.touches[0];t.target.parentNode==Me&&E(parseInt(t.clientX),parseInt(t.clientY))}else 2==e.touches.length&&(S(),e.touches[0].target.parentNode==Me&&e.touches[1].target.parentNode==Me&&T(n(e.touches[0].clientX,e.touches[0].clientY,e.touches[1].clientX,e.touches[1].clientY)));D()},E=function(e,t){Le=e,Oe=t,clearTimeout($e),$e=null,!0===Ve&&(qe=!0),g(),Ae=!0},T=function(e){Ne=e,De=!0},S=function(e){Ae=!1,De=!1,$e=setTimeout(m,500)},R=function(e){I(parseInt(e.clientX),parseInt(e.clientY))},M=function(e){if(1==e.touches.length&&Ae){var t=e.touches[0];t.target.parentNode==Me&&(e.preventDefault(),I(parseInt(t.clientX),parseInt(t.clientY)))}else if(2==e.touches.length&&e.touches[0].target.parentNode==Me&&e.touches[1].target.parentNode==Me&&De){e.preventDefault();var o=n(e.touches[0].clientX,e.touches[0].clientY,e.touches[1].clientX,e.touches[1].clientY),i=o-Ne;if(0!==i){var r=i/Math.abs(i);B(le+r*ke),Ne=o}}},I=function(e,t){Ae&&(q?(ne+=(e-Le)/_e.height*de*Math.PI/180,ie+=(t-Oe)/_e.height*de*Math.PI/180):(ne+=(e-Le)*G,ie+=(t-Oe)*Y),Le=e,Oe=t,oe||(ne=i(ne,$,V)),ne=r(ne,!0),ie=i(ie,Q,J),W("position-updated",{longitude:ne,latitude:ie}),u())},P=function(){Ge.start(),g(),W("device-orientation",!0)};this.toggleDeviceOrientation=function(){Ge.isEventAttached()?(Ge.stop(),W("device-orientation",!1)):P()};var F=function(e){ne=i(e.longitude,$,V),ie=i(e.latitude,Q,J),W("position-updated",{longitude:ne,latitude:ie}),u()},H=function(e){e.preventDefault(),e.stopPropagation();var t=e.detail?-e.detail:e.wheelDelta;if(0!==t){var o=parseInt(t/Math.abs(t));B(le+o*ke)}};this.mouseWheel=function(e){H(e)};var B=function(e){le=i(e,0,100),de=Z+le/100*(K-Z),He.fov=de,He.updateProjectionMatrix(),u(),W("zoom-updated",le)};this.getZoomLevel=function(){return le},this.zoom=function(e){B(e)},this.zoomIn=function(){le<100&&B(le+ke)},this.zoomOut=function(){le>0&&B(le-ke)};var A=function(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},L=function(){document.webkitFullscreenElement||document.msFullscreenElement?(Se.width=Ee.style.width,Se.height=Ee.style.height,Ee.style.width="100%",Ee.style.height="100%",v()):(Ee.webkitRequestFullscreen||Ee.msRequestFullscreen)&&(Ee.style.width=Se.width,Ee.style.height=Se.height,v()),W("fullscreen-mode",A())},O=function(){Ee.requestFullscreen?Ee.requestFullscreen():Ee.mozRequestFullScreen?Ee.mozRequestFullScreen():Ee.webkitRequestFullscreen?Ee.webkitRequestFullscreen():Ee.msRequestFullscreen&&Ee.msRequestFullscreen()};this.toggleFullscreen=function(){A()?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen():O()};var D=function(){ye&&fe.show()},N=function(e){e=e.toString().trim();var t=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),o=e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();o.match(/(pm|per minute)$/)&&(t/=60);var i=0;switch(o){case"rpm":case"rev per minute":case"revolutions per minute":case"rps":case"rev per second":case"revolutions per second":i=2*t*Math.PI;break;case"dpm":case"deg per minute":case"degrees per minute":case"dps":case"deg per second":case"degrees per second":i=t*Math.PI/180;break;case"rad per minute":case"radians per minute":case"rad per second":case"radians per second":i=t;break;default:m_anim=!1}return i*ce/1e3},X=function(e){e=e.toString().trim();var t=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));return"deg"==e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim()&&(t*=Math.PI/180),r(t)};this.addAction=function(e,t){e in Ye||(Ye[e]=[]),Ye[e].push(t)};var W=function(e,t){if(e in Ye&&Ye[e].length)for(var o=0,i=Ye[e].length;o<i;++o)void 0!==t?Ye[e][o](t):Ye[e][o]()};if(void 0!==e&&void 0!==e.panorama&&void 0!==e.container){var $,V,q=void 0===e.smooth_user_moves||!!e.smooth_user_moves,G=void 0!==e.long_offset?X(e.long_offset):Math.PI/360,Y=void 0!==e.lat_offset?X(e.lat_offset):Math.PI/180,j=void 0!==e.keyboard_long_offset?X(e.keyboard_long_offset):Math.PI/60,U=void 0!==e.keyboard_lat_offset?X(e.keyboard_lat_offset):Math.PI/120,K=void 0!==e.min_fov?i(parseFloat(e.min_fov),1,179):30,Z=void 0!==e.max_fov?i(parseFloat(e.max_fov),1,179):90,J=void 0!==e.tilt_up_max?i(X(e.tilt_up_max),0,Math.PI/2):Math.PI/2,Q=void 0!==e.tilt_down_max?-i(X(e.tilt_down_max),0,Math.PI/2):-Math.PI/2,ee=void 0!==e.min_longitude?X(e.min_longitude):0,te=void 0!==e.max_longitude?X(e.max_longitude):0,oe=ee==te;oe?(ee=0,te=2*Math.PI):0===te&&(te=2*Math.PI),ee<te?($=ee,V=te):($=te,V=ee);var ie=0,ne=$;if(void 0!==e.default_position){if(void 0!==e.default_position.lat){var re=X(e.default_position.lat);re>Math.PI&&(re-=2*Math.PI),ie=i(re,Q,J)}void 0!==e.default_position._long&&(ne=i(X(e.default_position._long),$,V))}var se=void 0!==e.segments?parseInt(e.segments):100,ae=void 0!==e.rings?parseInt(e.rings):100,le=0;void 0!==e.zoom_level&&(le=i(parseInt(Math.round(e.zoom_level)),0,100));var de=Z+le/100*(K-Z),ce=1e3/60,ue=2e3;void 0!==e.time_anim&&(ue="number"==typeof e.time_anim&&e.time_anim>=0&&e.time_anim);var he=void 0!==e.anim_speed?N(e.anim_speed):N("2rpm"),pe=!0;void 0!==e.reverse_anim&&(pe=!!e.reverse_anim);var ge=void 0!==e.vertical_anim_speed?N(e.vertical_anim_speed):N("2rpm"),me=0;if(void 0!==e.vertical_anim_target){var ve=X(e.vertical_anim_target);ve>Math.PI&&(ve-=2*Math.PI),me=i(ve,Q,J)}var fe=new PSVNavBar(this),ye=void 0!==e.navbar&&!!e.navbar,be=void 0!==e.navbar_class?e.navbar_class:{},we=void 0!==e.navbar_style?e.navbar_style:{},xe=void 0===e.allow_user_interactions||!!e.allow_user_interactions;xe||(ye=!1);var _e,Ce=void 0===e.allow_scroll_to_zoom||!!e.allow_scroll_to_zoom,ke=void 0!==e.zoom_speed?parseFloat(e.zoom_speed):1,ze=void 0!==e.eyes_offset?parseFloat(e.eyes_offset):5,Ee="string"==typeof e.container?document.getElementById(e.container):e.container,Te={},Se={};void 0!==e.size&&function(e){for(var t in e)if("width"==t||"height"==t){var o=e[t].toString().trim(),i=parseFloat(o.replace(/^([0-9]+(?:\.[0-9]*)?).*$/,"$1")),n=o.replace(/^[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();"%"!=n&&(n="px"),Te[t]={css:i+n,unit:n}}}(e.size);var Re,Me,Ie=e.panorama,Pe=null,Fe=null,He=null,Be=null,Ae=!1,Le=0,Oe=0,De=!1,Ne=0,Xe=null,We=null,$e=null,Ve=!1,qe=!1,Ge=new Sphoords,Ye={},je=void 0===e.usexmpdata||!!e.usexmpdata,Ue=void 0===e.cors_anonymous||!!e.cors_anonymous,Ke={full_width:null,full_height:null,cropped_width:null,cropped_height:null,cropped_x:null,cropped_y:null};if(void 0!==e.pano_size){for(var Ze in Ke)void 0!==e.pano_size[Ze]&&(Ke[Ze]=parseInt(e.pano_size[Ze]));je=!1}var Je={horizontal_fov:360,vertical_fov:180};if(void 0!==e.captured_view){for(var Ze in Je)void 0!==e.captured_view[Ze]&&(Je[Ze]=parseFloat(e.captured_view[Ze]));je=!1}var Qe=!1,et=void 0!==e.loading_msg?e.loading_msg.toString():"Loading…",tt=void 0!==e.loading_img?e.loading_img.toString():null,ot=void 0!==e.loading_html?e.loading_html:null,it=null;void 0!==e.overlay&&void 0!==e.overlay.image&&(it={image:e.overlay.image,position:{x:"left",y:"bottom"}},void 0!==e.overlay.position&&(void 0===e.overlay.position.x||"left"!=e.overlay.position.x&&"right"!=e.overlay.position.x||(it.position.x=e.overlay.position.x),void 0===e.overlay.position.y||"top"!=e.overlay.position.y&&"bottom"!=e.overlay.position.y||(it.position.y=e.overlay.position.y)),void 0!==e.overlay.size&&(it.size={width:void 0!==e.overlay.size.width?e.overlay.size.width:"auto",height:void 0!==e.overlay.size.height?e.overlay.size.height:"auto"}));var nt=this;void 0!==e.onready&&this.addAction("ready",e.onready),(void 0===e.autoload||!!e.autoload)&&this.load()}else console.log("PhotoSphereViewer: no value given for panorama or container")},PSVNavBar=function(e){var t=function(e,t){for(var o=0,i=t.length;o<i;++o)if(t[o]==e)return!0;return!1},o=function(e,o){return t(e,g)&&"string"==typeof o&&("transparent"==o||!!o.match(/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/)||!!o.match(/^rgb\((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])(,\s*(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}\)$/)||!!o.match(/^rgba\(((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),\s*){3}(0(\.[0-9]*)?|1)\)$/))||t(e,m)&&!isNaN(parseFloat(o))&&isFinite(o)&&o>=0};this.setClass=function(e){for(var t in e)t in h&&"string"==typeof t&&(h[t]=e[t])},this.setStyle=function(e){for(var t in e)t in p&&o(t,e[t])&&(p[t]=e[t])},this.create=function(){var t,o;r=document.createElement("div"),h.navbarClass?(t=r,o=h.navbarClass,t.className.match(new RegExp("(\\s|^)"+o+"(\\s|$)"))||(t.className+=" "+o)):(r.style.backgroundColor=p.backgroundColor,r.style.position="absolute",r.style.zIndex=10,r.style.bottom=0,r.style.width="100%",r.style.boxSizing="content-box",r.style.transition="bottom 0.4s ease-out"),s=new PSVNavBarButton(e,"autorotate",p,h,u),r.appendChild(s.getButton()),a=new PSVNavBarButton(e,"zoom",p,h,u),r.appendChild(a.getButton()),l=new PSVNavBarButton(e,"fullscreen",p,h,u),r.appendChild(l.getButton()),Sphoords.isDeviceOrientationSupported&&(d=new PSVNavBarButton(e,"orientation",p),r.appendChild(d.getButton()),c=new PSVNavBarButton(e,"virtual-reality",p),r.appendChild(c.getButton()))},this.getBar=function(){return r};var i=function(){v&&(clearTimeout(v),!f&&y&&(v=setTimeout(n,5e3))),f&&(r.style.bottom=0,f=!1,y&&(v=setTimeout(n,5e3)))};this.show=function(){i()};var n=function(){f||(r.style.bottom=1-r.offsetHeight+"px",f=!0)};this.hide=function(){n()},this.isHidden=function(){return f},this.mustBeHidden=function(e){(y=void 0===e||!!e)?n():i()};var r,s,a,l,d,c,u={autorotateTips:"播放",activeAutorotateTips:"暂停",zoomMinusTips:"缩小",zoomPlusTips:"放大",fullscreenTips:"全屏",activeFullscreenTips:"退出全屏"},h={navbarClass:"",autorotateClass:"",activeAutorotateClass:"",zoomClass:"",zoomMinusClass:"",zoomRangeBgClass:"",zoomRangeClass:"",zoomValueClass:"",zoomCompleteClass:"",zoomPlusClass:"",fullscreenClass:""},p={backgroundColor:"rgba(61, 61, 61, 0.5)",buttonsColor:"rgba(255, 255, 255, 0.7)",buttonsBackgroundColor:"transparent",activeButtonsBackgroundColor:"rgba(255, 255, 255, 0.1)",buttonsHeight:20,autorotateThickness:1,zoomRangeWidth:50,zoomRangeThickness:1,zoomRangeDisk:7,fullscreenRatio:4/3,fullscreenThickness:2,gyroscopeThickness:1,virtualRealityRatio:4/3,virtualRealityBorderRadius:2},g=["backgroundColor","buttonsColor","buttonsBackgroundColor","activeButtonsBackgroundColor"],m=["buttonsHeight","autorotateThickness","zoomRangeWidth","zoomRangeThickness","zoomRangeDisk","fullscreenRatio","fullscreenThickness"],v=null,f=!1,y=!1},PSVNavBarButton=function(e,t,o,i,n){var r=function(e,t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent("on"+t,o)},s=function(e,t){e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))||(e.className+=" "+t)};this.getButton=function(){return u};var a,l,d,c,u,h=function(e){u.style.backgroundColor=e?o.activeButtonsBackgroundColor:o.buttonsBackgroundColor},p=function(e){e?s(u,i.activeAutorotateClass):function(e,t){if(e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))){var o=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(o," ")}}(u,i.activeAutorotateClass)},g=function(e){u.title=e?n.activeAutorotateTips:n.autorotateTips},m=function(e){u.title=e?n.activeFullscreenTips:n.fullscreenTips},v=function(e){d.style.left=e/100*o.zoomRangeWidth-o.zoomRangeDisk/2+"px"},f=function(e){c.style.width=e/100*o.zoomRangeWidth-o.zoomRangeDisk/2+"px"},y=function(e){w(parseInt(e.clientX))},b=function(e){var t=e.touches[0];t.target!=a&&t.target!=l&&t.target!=d||w(parseInt(t.clientX))},w=function(e){E=!0,k(e)},x=function(e){E=!1},_=function(e){k(parseInt(e.clientX))},C=function(e){var t=e.touches[0];t.target!=a&&t.target!=l&&t.target!=d||(e.preventDefault(),k(parseInt(t.clientX)))},k=function(t){if(E){var i=(t-l.getBoundingClientRect().left)/o.zoomRangeWidth*100;e.zoom(i)}},z=function(t){e.mouseWheel(t)},E=!1;!function(){switch(t){case"autorotate":var w=o.buttonsHeight-2*o.autorotateThickness,k=w/10;if(u=document.createElement("div"),r(u,"click",function(){e.toggleAutorotate()}),u.title=n.autorotateTips,e.addAction("autorotate",g),i.activeAutorotateClass&&e.addAction("autorotate",p),i.autorotateClass)s(u,i.autorotateClass);else{u.style.cssFloat="left",u.style.boxSizing="inherit",u.style.padding="10px",u.style.width=o.buttonsHeight+"px",u.style.height=o.buttonsHeight+"px",u.style.backgroundColor=o.buttonsBackgroundColor,u.style.position="relative",u.style.cursor="pointer";var E=document.createElement("div");E.style.boxSizing="inherit",E.style.width=w+"px",E.style.height=w+"px",E.style.borderRadius="50%",E.style.border=o.autorotateThickness+"px solid "+o.buttonsColor,u.appendChild(E);var T=document.createElement("div");T.style.boxSizing="inherit",T.style.width=w+"px",T.style.height=k+"px",T.style.borderRadius="50%",T.style.border=o.autorotateThickness+"px solid "+o.buttonsColor,T.style.position="absolute",T.style.top="50%",T.style.marginTop=-(k/2+o.autorotateThickness)+"px",u.appendChild(T),e.addAction("autorotate",h)}break;case"zoom":u=document.createElement("div"),i.zoomClass?s(u,i.zoomClass):(u.style.cssFloat="left",u.style.boxSizing="inherit");var S=document.createElement("div");S.title=n.zoomMinusTips,r(S,"click",function(){e.zoomOut()}),i.zoomMinusClass?s(S,i.zoomMinusClass):(S.style.cssFloat="left",S.style.boxSizing="inherit",S.style.padding="10px",S.style.height=o.buttonsHeight+"px",S.style.backgroundColor=o.buttonsBackgroundColor,S.style.lineHeight=o.buttonsHeight+"px",S.style.color=o.buttonsColor,S.style.cursor="pointer",S.textContent="-"),u.appendChild(S),a=document.createElement("div"),i.zoomRangeBgClass?s(a,i.zoomRangeBgClass):(a.style.cssFloat="left",a.style.boxSizing="inherit",a.style.padding=10+(o.buttonsHeight-o.zoomRangeThickness)/2+"px 5px",a.style.backgroundColor=o.buttonsBackgroundColor,a.style.cursor="pointer"),u.appendChild(a),(l=document.createElement("div")).style.width=o.zoomRangeWidth+"px",l.style.height=o.zoomRangeThickness+"px",i.zoomRangeClass?s(l,i.zoomRangeClass):(l.style.boxSizing="inherit",l.style.backgroundColor=o.buttonsColor,l.style.position="relative"),a.appendChild(l),(d=document.createElement("div")).style.top=(o.zoomRangeThickness-o.zoomRangeDisk)/2+"px",d.style.left=-o.zoomRangeDisk/2+"px",d.style.width=o.zoomRangeDisk+"px",d.style.height=o.zoomRangeDisk+"px",i.zoomValueClass?s(d,i.zoomValueClass):(d.style.position="absolute",d.style.boxSizing="inherit",d.style.borderRadius="50%",d.style.backgroundColor=o.buttonsColor),(c=document.createElement("div")).style.width="0px",c.style.height=o.zoomRangeThickness+"px",i.zoomValueClass&&s(c,i.zoomCompleteClass),e.addAction("zoom-updated",v),e.addAction("zoom-updated",f),r(a,"mousedown",y),r(a,"touchstart",b),r(document,"mousemove",_),r(document,"touchmove",C),r(document,"mouseup",x),r(document,"touchend",x),r(a,"mousewheel",z),r(a,"DOMMouseScroll",z),l.appendChild(d),l.appendChild(c);var R=document.createElement("div");R.title=n.zoomPlusTips,r(R,"click",function(){e.zoomIn()}),i.zoomPlusClass?s(R,i.zoomPlusClass):(R.style.cssFloat="left",R.style.boxSizing="inherit",R.style.padding="10px",R.style.height=o.buttonsHeight+"px",R.style.backgroundColor=o.buttonsBackgroundColor,R.style.lineHeight=o.buttonsHeight+"px",R.style.color=o.buttonsColor,R.style.cursor="pointer",R.textContent="+"),u.appendChild(R);break;case"fullscreen":var M=o.buttonsHeight*o.fullscreenRatio,I=.3*o.buttonsHeight,P=(o.buttonsHeight-I)/2,F=.3*M,H=(M-F)/2-o.fullscreenThickness,B=o.buttonsHeight-2*o.fullscreenThickness;if((u=document.createElement("div")).title=n.fullscreenTips,e.addAction("fullscreen-mode",m),r(u,"click",function(t){e.toggleFullscreen()}),i.fullscreenClass)s(u,i.fullscreenClass);else{u.style.cssFloat="right",u.style.boxSizing="inherit",u.style.padding="10px",u.style.width=M+"px",u.style.height=o.buttonsHeight+"px",u.style.backgroundColor=o.buttonsBackgroundColor,u.style.cursor="pointer";var A=document.createElement("div");A.style.cssFloat="left",A.style.boxSizing="inherit",A.style.width=o.fullscreenThickness+"px",A.style.height=I+"px",A.style.borderStyle="solid",A.style.borderColor=o.buttonsColor+" transparent",A.style.borderWidth=P+"px 0",u.appendChild(A);var L=document.createElement("div");L.style.cssFloat="left",L.style.boxSizing="inherit",L.style.width=H+"px",L.style.height=B+"px",L.style.borderStyle="solid",L.style.borderColor=o.buttonsColor+" transparent",L.style.borderWidth=o.fullscreenThickness+"px 0",u.appendChild(L);var O=document.createElement("div");O.style.cssFloat="left",O.style.boxSizing="inherit",O.style.marginLeft=F+"px",O.style.width=H+"px",O.style.height=B+"px",O.style.borderStyle="solid",O.style.borderColor=o.buttonsColor+" transparent",O.style.borderWidth=o.fullscreenThickness+"px 0",u.appendChild(O);var D=document.createElement("div");D.style.cssFloat="left",D.style.boxSizing="inherit",D.style.width=o.fullscreenThickness+"px",D.style.height=I+"px",D.style.borderStyle="solid",D.style.borderColor=o.buttonsColor+" transparent",D.style.borderWidth=P+"px 0",u.appendChild(D);var N=document.createElement("div");N.style.clear="left",u.appendChild(N),e.addAction("fullscreen-mode",h)}break;case"orientation":var X=o.buttonsHeight-2*o.gyroscopeThickness,W=X-4*o.gyroscopeThickness,$=X/10;(u=document.createElement("div")).style.cssFloat="right",u.style.boxSizing="inherit",u.style.padding="10px",u.style.width=o.buttonsHeight+"px",u.style.height=o.buttonsHeight+"px",u.style.backgroundColor=o.buttonsBackgroundColor,u.style.position="relative",u.style.cursor="pointer",r(u,"click",function(){e.toggleDeviceOrientation()});var V=document.createElement("div");V.style.boxSizing="inherit",V.style.width=X+"px",V.style.height=X+"px",V.style.borderRadius="50%",V.style.border=o.gyroscopeThickness+"px solid "+o.buttonsColor,u.appendChild(V);var q=document.createElement("div");q.style.boxSizing="inherit",q.style.width=W+"px",q.style.height=$+"px",q.style.borderRadius="50%",q.style.border=o.gyroscopeThickness+"px solid "+o.buttonsColor,q.style.position="absolute",q.style.top="50%",q.style.left="50%",q.style.marginTop=-($/2+o.gyroscopeThickness)+"px",q.style.marginLeft=-(W/2+o.gyroscopeThickness)+"px",u.appendChild(q);var G=document.createElement("div");G.style.boxSizing="inherit",G.style.width=$+"px",G.style.height=W+"px",G.style.borderRadius="50%",G.style.border=o.gyroscopeThickness+"px solid "+o.buttonsColor,G.style.position="absolute",G.style.top="50%",G.style.left="50%",G.style.marginTop=-(W/2+o.gyroscopeThickness)+"px",G.style.marginLeft=-($/2+o.gyroscopeThickness)+"px",u.appendChild(G),e.addAction("device-orientation",h);break;case"virtual-reality":var Y=o.buttonsHeight*o.virtualRealityRatio,j=Y/4,U=j/2;(u=document.createElement("div")).style.cssFloat="right",u.style.position="relative",u.style.boxSizing="inherit",u.style.padding="10px",u.style.width=Y+"px",u.style.height=o.buttonsHeight+"px",u.style.backgroundColor=o.buttonsBackgroundColor,u.style.cursor="pointer",r(u,"click",function(){e.toggleStereo()});var K=document.createElement("div");K.style.boxSizing="inherit",K.style.width=Y+"px",K.style.height=o.buttonsHeight+"px",K.style.borderRadius=o.virtualRealityBorderRadius+"px",K.style.backgroundColor=o.buttonsColor,u.appendChild(K);var Z=document.createElement("div");Z.style.boxSizing="inherit",Z.style.width=j+"px",Z.style.height=j+"px",Z.style.position="absolute",Z.style.top=U+10+"px",Z.style.left=U+10+"px",Z.style.borderRadius="50%",Z.style.backgroundColor=o.backgroundColor,u.appendChild(Z);var J=document.createElement("div");J.style.boxSizing="inherit",J.style.width=j+"px",J.style.height=j+"px",J.style.position="absolute",J.style.top=U+10+"px",J.style.right=U+10+"px",J.style.borderRadius="50%",J.style.backgroundColor=o.backgroundColor,u.appendChild(J);var Q=document.createElement("div");Q.style.boxSizing="inherit",Q.style.width=j+"px",Q.style.height=o.buttonsHeight/2+"px",Q.style.position="absolute",Q.style.left="50%",Q.style.bottom="10px",Q.style.marginLeft=-j/2+"px",Q.style.borderTopLeftRadius="50% 60%",Q.style.borderTopRightRadius="50% 60%",Q.style.backgroundColor=o.backgroundColor,u.appendChild(Q),e.addAction("stereo-effect",h)}}()},Sphoords=function e(){var t=function(e){return e-360*Math.floor(e/360)};this.start=function(){return e.isDeviceOrientationSupported?(window.addEventListener("deviceorientation",o,!1),r=!0,!0):(console.log("Device Orientation API not supported"),!1)},this.stop=function(){r&&(window.removeEventListener("deviceorientation",o,!1),r=!1)},this.toggle=function(){r?this.stop():this.start()},this.isEventAttached=function(){return r};var o=function(o){var i=0,r=0;switch(u=e.getScreenOrientation()){case"portrait-primary":i=o.alpha+o.gamma,r=o.beta-90;break;case"landscape-primary":if(i=o.alpha+o.beta-90,r=-o.gamma-90,Math.abs(o.beta)>90)switch(h){case"Blink":r+=180;break;case"Gecko":default:r=-r}"WebKit"===h&&window.orientation&&(r<0&&(r=-1*(r+180)),i>=180?i-=180:i+=180);break;case"landscape-secondary":if(i=o.alpha-o.beta+90,r=o.gamma-90,Math.abs(o.beta)>90)switch(h){case"Blink":r+=180;break;case"Gecko":default:r=-r}"WebKit"===h&&window.orientation&&(r<0&&(r=-1*(r+180)),i>=180?i-=180:i+=180);break;case"portrait-secondary":i=o.alpha-o.gamma,r=180-(o.beta-90),r=270-o.beta}(r=t(r))>=180&&(r-=360),s=t(i),a=Math.max(-90,Math.min(90,r)),l=s*c,d=a*c,n()};this.getCoordinates=function(){return{longitude:l,latitude:d}},this.getCoordinatesInDegrees=function(){return{longitude:s,latitude:a}},this.getScreenOrientation=function(){return u},this.addListener=function(e){p.push(e)};var i,n=function(){if(p.length)for(var e=0,t=p.length;e<t;++e)p[e]({longitude:l,latitude:d})},r=!1,s=0,a=0,l=0,d=0,c=Math.PI/180,u=e.getScreenOrientation(),h=(i=navigator.userAgent,/Gecko\/[0-9.]+/.test(i)?"Gecko":/Chrome\/[0-9.]+/.test(i)?"Blink":/AppleWebKit\/[0-9.]+/.test(i)?"WebKit":/Trident\/[0-9.]+/.test(i)?"Trident":/Opera\/[0-9.]+/.test(i)?"Presto":"Gecko"),p=[]};Sphoords.getScreenOrientation=function(){var e=null;if(screen.orientation)e=screen.orientation;else if(screen.mozOrientation)e=screen.mozOrientation;else if(screen.msOrientation)e=screen.msOrientation;else if(window.orientation||0===window.orientation)switch(window.orientation){case 0:e="portrait-primary";break;case 180:e="portrait-secondary";break;case-90:e="landscape-primary";break;case 90:e="landscape-secondary"}return null!==e&&"object"==_typeof(e)?e.type:e},Sphoords.isDeviceOrientationSupported=!1,function(){if(window.DeviceOrientationEvent&&null!==Sphoords.getScreenOrientation());}();