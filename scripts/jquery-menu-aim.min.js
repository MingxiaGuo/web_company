!function(e){e.fn.menuAim=function(t){return this.each(function(){(function(t){var n=e(this),i=null,o=[],u=null,r=null,c=e.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:e.noop,exit:e.noop,activate:e.noop,deactivate:e.noop,exitMenu:e.noop,exitActRow:e.noop},t),l=function(e){e!=i&&(i&&c.deactivate(i),c.activate(e),i=e)},a=function e(t){var n=f();n?r=setTimeout(function(){e(t)},n):l(t)},f=function(){if(!i||!e(i).is(c.submenuSelector))return 0;var t=n.offset(),r={x:t.left,y:t.top-c.tolerance},l={x:t.left+n.outerWidth(),y:r.y},a={x:t.left,y:t.top+n.outerHeight()+c.tolerance},f={x:t.left+n.outerWidth(),y:a.y},s=o[o.length-1],h=o[0];if(!s)return 0;if(h||(h=s),h.x<t.left||h.x>f.x||h.y<t.top||h.y>f.y)return 0;if(u&&s.x==u.x&&s.y==u.y)return 0;function x(e,t){return(t.y-e.y)/(t.x-e.x)}var m=l,v=f;"left"==c.submenuDirection?(m=a,v=r):"below"==c.submenuDirection?(m=f,v=a):"above"==c.submenuDirection&&(m=r,v=l);var y=x(s,m),p=x(s,v),d=x(h,m),b=x(h,v);return y<d&&p>b?(u=s,300):(u=null,0)};n.mouseleave(function(){r&&clearTimeout(r);c.exitActRow(this)&&(e(i).length&&0==e(i).attr("_chd")&&c.deactivate(i),i=null);c.exitMenu(this)&&(i&&c.deactivate(i),i=null)}).find(c.rowSelector).mouseenter(function(){r&&clearTimeout(r);c.enter(this),a(this)}).mouseleave(function(){c.exit(this)}).click(function(){l(this)}),e(document).mousemove(function(e){o.push({x:e.pageX,y:e.pageY}),o.length>3&&o.shift()})}).call(this,t)}),this}}(jQuery);