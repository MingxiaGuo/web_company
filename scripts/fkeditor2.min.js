function _typeof(t) { return (_typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(t) { return typeof t } : function(t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t })(t) }

function _defineProperty(t, e, o) { return e in t ? Object.defineProperty(t, e, { value: o, enumerable: !0, configurable: !0, writable: !0 }) : t[e] = o, t }! function(t, e, o, n, i) {
    var a, r, l, d, s = n,
        c = s.top.Site,
        u = !e.getSelection,
        m = navigator.userAgent.toLowerCase(),
        f = m.indexOf("se") > -1,
        p = m.indexOf("firefox") > -1,
        h = m.indexOf("opera") > -1,
        g = /applewebkit/.test(m) && /chrome/.test(m) && parseFloat(m.match(/ chrome\/(\d+)/)[1]) >= 58,
        v = "",
        C = "unselectable",
        B = u ? o.selection && o.selection.createRange && "None" != o.selection.type ? o.selection.createRange() : i : e.getSelection(),
        E = (_defineProperty(a = { ModuleId: "moduleId", OuterFun: "outerFun", Option: "option", Editor: "editor", LinkHasClick: "linkHasClick", SignClassNum: "scn", HasRsChildStyle: "hrcs", Range: "range", NotCreateNewNode: "ncnn", SimpleTextEdit: "simpleTextEdit", HasSelectText: "hst", ClearSpanCursoring: "cscs", OldVHeight: "ovht", OldHwidth: "ohwt", HoverToolOn: "hoverToolOn", FloatImg: "floatImg", HoverToolTimeout: "htto", EditLineTimeout: "etto" }, "SignClassNum", "signClassNum"), _defineProperty(a, "SetPageChange", "spce"), _defineProperty(a, "HasRemoveUselessChild", "rucsc"), _defineProperty(a, "RemoveUselessChildIng", "rucscing"), _defineProperty(a, "PreScrollHeight", "psht"), _defineProperty(a, "ChangeCount", "changeCount"), _defineProperty(a, "ScrollChangeChecking", "sccg"), _defineProperty(a, "FirstChooseEditor", "fcet"), _defineProperty(a, "PreHtmlContent", "phct"), _defineProperty(a, "Onfocused", "onfocused"), _defineProperty(a, "Mousedown", "mousedown"), _defineProperty(a, "Mousemove", "mousemove"), _defineProperty(a, "FixRight", "fixRight"), _defineProperty(a, "ScreenX", "screenX"), _defineProperty(a, "ScreenY", "screenY"), _defineProperty(a, "HasRefreshClick", "hrfc"), _defineProperty(a, "PreModuleHeight", "pmheight"), _defineProperty(a, "PreCommand", "preCommand"), _defineProperty(a, "SelectedInputBlur", "sib"), _defineProperty(a, "TriggerClick", "ectc"), _defineProperty(a, "EndCheckClass", "endCheckClass"), _defineProperty(a, "EditSignClass", "editSignClass"), _defineProperty(a, "EditorEventBind", "editorEventBind"), _defineProperty(a, "BackPreColor", "bpcolor"), _defineProperty(a, "PreHasText", "preHasText"), a),
        T = "contenteditable";
    ToolAttr = { Scrolling: "scll", ScrollingMousedown: "scllmdn" }, BtnCommand = { EditContent: "editContent", EditPositionFixed: "positionFixed", EditLogoDisplay: "logoDisplay", GlobalLink: "globalLink", BorderRadius: "borderRadius", Opacity: "opacity", Border: "border", Shadow: "shadow", Radius: "radius", Delete: "delete", FontSize: "fSize", LineHeight: "lineHeight", Animation: "animation", BtnModuleStyle: "btnModuleStyle", EditPhotoBtn: "editPhotoBtn", EditFixedBtn: "editFixedBtn", ImgEffectBtn: "imgEffectBtn", PhotoShapeBtn: "photoShapeBtn", SimpleLinkBtn: "simpleLinkBtn", ModuleTitleBtn: "moduleTitleBtn", DescribePicBtn: "describePicBtn", Linkcreator: "linkcreator", Formats: "formats", Colors: "colors", Removeformat: "removeformat", TextAlign: "textAlign", JustifyLeft: "justifyLeft", JustifyCenter: "justifyCenter", JustifyRight: "justifyRight", JustifyFull: "justifyFull", WritingMode: "writingMode", Bold: "Bold", Italic: "Italic", Underline: "Underline", Unlink: "Unlink", Createlink: "Createlink", SingleClick: "singleClick", Dblclick: "dblclick", InputFontSize: "inputFontSize", InputLineHeight: "inputLineHeight", ChooseFormats: "chooseFormats", ChooseLineHeight: "chooseLineHeight", ChooseFontSize: "chooseFontSize", DeleteLink: "deleteLink", Horizontal: "horizontal", VerticalToRight: "verticalToRight", VerticalToLeft: "verticalToLeft" }, c.simpleTextList = { allEditors: [], chooseEditor: {}, colorToolShow: !1, checking: !1 }, v = /msie/.test(m) ? "-ms-" : /chrome/.test(m) || /safari/.test(m) || /yandex/.test(m) ? "-webkit-" : p ? "-moz-" : h ? "-o-" : /konqueror/.test(m) ? "-khtml-" : "";
    r = new function() { this.constructor.prototype.extend = function(t, e) { for (var o in e) o in e.constructor.prototype || (t[o] = e[o]); for (var o in e.constructor.prototype) t.constructor.prototype[o] = e[o] } };
    new function() { this.constructor.prototype.test = function() { return !0 } };
    d = new function() {
        var e, o = this;
        this.getEventCtrl = function() {
            return e || (e = new function() {
                var e = this;
                e.constructor.prototype.removeParentUselessNode = function(t) {
                    var n = t.element,
                        a = t.styleName,
                        r = (t.styleValue, t.endCheckClass);
                    if (_typeof(n.parent()) == i) return o;
                    var l = n.parent();
                    return l.hasClass(r) ? o : (n.text().length == l.text().length && (l.css(a, ""), t.element = l, e.removeParentUselessNode(t)), o)
                }, e.constructor.prototype.changeChildStyle = function(t) {
                    var n = t.element,
                        a = t.styleName;
                    if (t.styleValue, _typeof(n.children) == i) return o;
                    for (var r = 0; r < n.children().length; r++) {
                        var l = n.children().eq(r);
                        l.css(a, ""), t.element = l, e.changeChildStyle(t)
                    }
                    return o
                }, e.constructor.prototype.setElementStyleEffectAll = function(t) {
                    var n = t.element,
                        i = t.effectElement,
                        a = t.styleName,
                        r = t.styleValue;
                    return t.elemenText, t.endCheckClass, n && n.length > 0 && (n.find("*").css(a, ""), n.find(i).css(a, r)), t.element = n, e.setElementParentStyleEffectAll(t), o
                }, e.constructor.prototype.setElementParentStyleEffectAll = function(n) {
                    var a = n.element,
                        r = n.effectElement,
                        l = n.styleName,
                        d = n.styleValue,
                        s = n.elemenText,
                        c = n.endCheckClass,
                        u = a.parent();
                    return _typeof(u) == i ? o : u.hasClass(c) || t.trim(u.text()) != s ? o : (u[0].tagName.toLowerCase() == r ? u.css(l, d) : _typeof(u.css(l)) != i && u.css(l, ""), n.element = u, e.setElementParentStyleEffectAll(n), o)
                }, e.constructor.prototype.checkInArray = function(t, e) {
                    for (var o = 0; o < t.length; o++)
                        if (t[o] == e) return !0;
                    return !1
                }, e.constructor.prototype.findTagInParent = function(t, o, n) { if (_typeof(t.parent()) == i || t.parent().length <= 0) return !1; var a = t.parent(); return !a.hasClass(n) && (a[0].tagName.toLowerCase() == o ? a : e.findTagInParent(a, o, n)) }, e.constructor.prototype.filterPasteData = function(n) {
                    var a, r, l, d, s, c, u, m, f, p = ["div", "span", "font", "p", "u", "i", "br", "b", "a", "strong", "em"],
                        h = ["font-size", "line-height", "text-align", "color", "font-family"];
                    if (_typeof(n.children) == i || n.children().length <= 0) return o;
                    for (var g = 0; g < n.children().length; g++)
                        if (r = n.children().eq(g), e.filterPasteData(r), a = t.trim(r.prop("tagName").toLowerCase()), e.checkInArray(p, a)) {
                            if (!(_typeof(l = r.attr("style")) == i || l.length <= 0 || (f = (l = l.toLowerCase()).split(";")).length <= 0)) {
                                d = !1, s = [];
                                for (var v = 0; v < f.length; v++) _typeof(f[v]) != i && _typeof(c = f[v].split(":")) != i && 2 == c.length ? ((u = c[0]).indexOf(",") > 0 && (u = u.substring(u.lastIndexOf(","))), m = c[1], u = t.trim(u), e.checkInArray(h, u) ? ("font-size" != u && "line-height" != u || (m.indexOf("px") < 0 ? f[v] = "" : d = !0), s.push(f[v] + ";")) : d = !0) : d = !0;
                                d && r.attr("style", s.join(""))
                            }
                        } else r.prop("outerHTML", r.text());
                    return o
                }, e.constructor.prototype.textPositionCorrect = function(t) {
                    if (t.find("div").length > 0 || t.find("p") > 0) return o;
                    if (_typeof(t.children) == i || t.children().length <= 0) return o;
                    for (var n = 0; n < t.children().length; n++) {
                        var a = t.children().eq(n);
                        _typeof(a.attr("style")) != i && a.attr("style") && -1 != a.attr("style").indexOf("text-align") && "block" != a.css("display") && a.css("display", "block"), e.textPositionCorrect(a)
                    }
                    return o
                }, e.constructor.prototype.setUnselectable = function(t) { return t.fkEditorWrap.find("[unselectable]").css(v + "user-select", "none").attr(C, "on").on("selectstart mousedown", !1), t.toolbar.find(".simpleTextEditTool").find("[unselectable]").css(v + "user-select", "none").attr(C, "on").on("selectstart mousedown", !1), o }, e.constructor.prototype.removeUselessChildStyle = function(t, o) {
                    if (t.data(E.SetPageChange) && 1 != t.data(E.HasRemoveUselessChild) && _typeof(o.children()) != i)
                        for (var n, a, r, l, d, s, c, u, m = 0; m < o.children().length; m++) {
                            if (u = _typeof(r = (n = o.children().eq(m)).attr("class")) == i || "" == r, a = o.parent(), ("span" == l || "font" == l || "a" == l) && n.text().length <= 0 && u && n.html().indexOf("br") <= 0) return void n.replaceWith("");
                            u && (l = n.prop("tagName").toLowerCase(), d = n.attr("style"), s = n.attr("color"), c = n.attr("face"), _typeof(d) != i && "" != d || "span" != l && ("font" != l || _typeof(s) != i || _typeof(c) != i) || (n.replaceWith(n.html()), n = a)), e.removeUselessChildStyle(t, n)
                        }
                }, e.constructor.prototype.removeElementProp = function(t) {
                    var o, n, a = t.element,
                        r = t.attrName;
                    _typeof(n = a.attr(r)) != i && "" != n && a.removeAttr(r);
                    for (var l = 0; l < a.children().length; l++) _typeof(n = (o = a.children().eq(l)).attr(r)) != i && "" != n && o.removeAttr(r), e.removeElementProp({ element: o, attrName: r })
                }, e.constructor.prototype.setElementStyle = function(t) {
                    var o, n = t.element,
                        i = t.styleName,
                        a = t.styleValue;
                    n.css(i, a);
                    for (var r = 0; r < n.children().length; r++)(o = n.children().eq(r)).css(i, a), e.setElementStyle({ element: o, styleName: i, styleValue: a })
                }
            })
        }, this.getUICtrl = function() {}
    };
    l = new function() {
        var n, a, r = this;
        this.getEventCtrl = function() {
            return n || (n = new function() {
                var n = this,
                    a = (new Date).getTime(),
                    l = (new Date).getTime();
                n.constructor.prototype.getWindowSelection = function() { return u ? n.checkSelectionRange() ? o.selection.createRange() : B : e.getSelection() }, n.constructor.prototype.checkIEGetSelection = function() { var t = n.getWindowSelection(); return !(!t || "baseOffset" in t && 0 == t.baseOffset) }, n.constructor.prototype.isNumberPress = function(t) { return t >= 48 && t <= 57 || t >= 96 && t <= 105 || 8 == t || 46 == t || 37 == t || 39 == t }, n.constructor.prototype.checkSelectionRange = function() { return o.selection && o.selection.createRange && "None" != o.selection.type }, n.constructor.prototype.getSelectedNode = function() { var e, i, a = n.getWindowSelection(); return u || (e = a.anchorNode), !e && n.checkSelectionRange() && (e = (i = (a = o.selection).getRangeAt ? a.getRangeAt(0) : a.createRange()).commonAncestorContainer ? i.commonAncestorContainer : i.parentElement ? i.parentElement() : i.item(0)), !!e && ("#text" == e.nodeName ? t(e.parentNode) : t(e)) }, n.constructor.prototype.detectElement = function(e) {
                    var o, i = e.tags,
                        a = !1,
                        r = n.getSelectedNode();
                    return !!r && (o = r.prop("tagName").toLowerCase(), t.each(i, function(t, e) { if (o == e) return a = !0, !1 }), a || (r.parents().each(function() { if (o = t(this).prop("tagName").toLowerCase(), t.each(i, function(t, e) { if (o == e) return a = !0, !1 }), a) return !1 }), a))
                }, n.constructor.prototype.detectElementCss = function(t) { var e, o = n.getSelectedNode(); return t && o && o.length > 0 && o.hasClass("fk-editor") ? ("" == (e = n.detectElementDeepCss(o, t)) && (e = o.css(t)), e) : t && o ? o.css(t) : "" }, n.constructor.prototype.detectElementDeepCss = function(t, e) {
                    var o = "",
                        i = t.text().length;
                    if (i <= 0) return o;
                    if (t.children().length <= 0 && i > 0) return o = t.css(e);
                    for (var a = t.children().length; a >= 0 && "" == (o = n.detectElementDeepCss(t.children().eq(a), e)); a--);
                    return o
                }, n.constructor.prototype.refuseStyle = function(t) { var e = n.getSelectedNode(); if (e && e.is("[style]") && "" != e.css(t)) { var o, i = e.css(t); return e.css(t, ""), o = e.attr("style"), e.css(t, i), o } return "" }, n.constructor.prototype.setSelection = function(t, e) {
                    var i, a = n.getWindowSelection();
                    if (u) a.execCommand(t, !1, e);
                    else { a.anchorNode && a.getRangeAt && (i = a.getRangeAt(0)), i && (a.removeAllRanges(), a.addRange(i)), m.match(/msie/) || o.execCommand("StyleWithCSS", !1, !1), "fontname" === t && (s.isIE() ? e = e.replace(/\\/g, "") : o.execCommand("StyleWithCSS", !1, !0)); try { o.execCommand(t, !1, e) } catch (t) { console.log(t) } }
                    return n.affectStyleAround(!1, !0), r
                }, n.constructor.prototype.affectStyleAround = function(e, o) {
                    var i = n.getSelectedNode();
                    if ((i = i || e) && 0 == o) return i.parent().is("[style]") && i.attr("style", i.parent().attr("style")), i.is("[style]") && i.find("*").attr("style", i.attr("style")), r;
                    if (e && o && e.is("[style]")) {
                        var a = o.split(";");
                        if ("color" == (a = a[0].split(":"))[0]) {
                            var l = !1;
                            e.find("*").each(function(e, o) {
                                (0 == e && t(this).attr("color") || t(this).parent().attr("color")) && (l = !0), t(this).attr("color") || l || t(this).css(a[0], a[1])
                            })
                        } else e.is("[style*=" + a[0] + "]") && e.find("*").css(a[0], a[1]);
                        n.selectText(e)
                    }
                    return r
                }, n.constructor.prototype.selectText = function(e) {
                    if (B == i || !e) return r;
                    e = e[0];
                    var a, l = n.getWindowSelection();
                    return u ? (l.moveToElementText(e), l.select(), r) : _typeof(e) == i || null == e ? r : ((a = o.createRange()).selectNodeContents(e), l.removeAllRanges(), l.addRange(a), t(e).is(":empty") && (t(e).append("&nbsp;"), n.selectText(t(e))), r)
                }, n.constructor.prototype.setNodeRange = function(t) {
                    if (_typeof(t) != i) {
                        if (u) return r;
                        try {
                            var e, a = n.getWindowSelection();
                            if (a.removeAllRanges(), g) a.selectAllChildren(t);
                            else {
                                if ((e = t.childNodes) && e.length > 0) {
                                    for (var l = 0; l < e.length; l++) {
                                        var d;
                                        (d = o.createRange()).selectNode(e[l]), a.addRange(d)
                                    }
                                    return r
                                }(d = o.createRange()).selectNode(t)
                            }
                        } catch (t) { console.log(t) }
                        return r
                    }
                }, n.constructor.prototype.getSelectText = function(t, e) {
                    var o, a = "",
                        r = n.getWindowSelection();
                    return !u && r.anchorNode && r.getRangeAt && (o = r.getRangeAt(0), e || t.data(E.Range, o), a = o.toString()), u && B != i && (e || t.data(E.Range, r), a = r.htmlText), a
                }, n.constructor.prototype.setSelectRange = function(t) { if (null == t) return r; var e = n.getWindowSelection(); return u ? (n.checkSelectionRange() && o.selection.createRangeCollection(t), r) : (e.removeAllRanges(), n.getWindowSelection().addRange(t), r) }, n.constructor.prototype.setTagStyle = function(t) { _typeof(t.styleName) == i && (t.styleName = ""), _typeof(t.styleValue) == i && (t.styleValue = ""); var e = n.refuseStyle(t.styleName); return _typeof(e) == i && (e = ""), _typeof(t.tagName) != i && "" != t.tagName || (t.tagName = "span"), t.tAttr = "style", t.tVal = t.styleName + ":" + t.styleValue + ";" + e, n.replaceSelectedStyle(t) }, n.constructor.prototype.replaceSelectedStyle = function(e) {
                    var s, c, u = e.tagName,
                        m = e.tAttr,
                        f = e.tVal,
                        p = e.styleName,
                        h = e.styleValue,
                        g = e.editor,
                        v = e.notCreateNewNode,
                        C = e.attr2,
                        B = e.attr2Value,
                        T = e.command,
                        b = e.createNewNodeAction;
                    if (!g) return console.log("replaceSelectedStyle err, editor = " + g), r;
                    if (c = g.data(E.EndCheckClass), s = g.data(E.EditSignClass), _typeof(v) == i && (v = !1), (a = (new Date).getTime()) - l < 20) return r;
                    var k, S = g.data(E.HasRefreshClick),
                        y = g.data(E.SignClassNum),
                        _ = g.find("." + g.data(E.EditSignClass) + y),
                        w = t.trim(n.getSelectText(g, !0)).length,
                        x = !!e.isSetLinkColor;
                    if (!x && !S && _.length > 0 && (w > 0 || v || t.browser.msie && "9.0" == t.browser.version)) return _.css(p, h), _typeof(C) != i && "" != C && _.attr(C, B), "color" != p && "color" != C || ((k = d.getEventCtrl().findTagInParent(_, "u", c)).length > 0 && k.css(p, h), (k = d.getEventCtrl().findTagInParent(_, "a", c)).length > 0 && k.css(p, h), _.find("a").css(p, h)), g.data(E.HasRsChildStyle) < 50 && (g.data(E.HasRsChildStyle, parseInt(g.data(E.HasRsChildStyle)) + 1), _.find("*").css(p, ""), "color" != p && "color" != C || d.getEventCtrl().removeElementProp({ element: _, attrName: "color" }), d.getEventCtrl().removeParentUselessNode({ element: _, styleName: p, styleValue: h, endCheckClass: c })), n.setOrUnsetUnderline({ command: T, element: _, editor: g, endCheckClass: c }), r;
                    if (l = a, g.data(E.HasRefreshClick, !1), g.data(E.HasRsChildStyle, 0), 1 == b) return r;
                    var D, P, H, I, L = n.getWindowSelection();
                    L.anchorNode && L.getRangeAt && (D = L.getRangeAt(0), P = o.createElement(u), _.length > 0 && ("&nbsp;" == _.html() ? _.replaceWith("") : _.removeClass(s + y)), I = g.attr("style"), g.height(g.height() + "px"), y = parseInt(y) + 1, g.data(E.SignClassNum, y), t(P).addClass(s + y), H = D.extractContents(), P.appendChild(H), g.attr("style", I), _typeof(C) != i && "" != C && t(P).attr(C, B), D.insertNode(P), x && t(P).parent().attr("color") ? t(P).attr("style", "") : t(P).attr("style", "").css(p, h), T != BtnCommand.Underline && ("style" == m ? n.affectStyleAround(t(P), f) : n.affectStyleAround(t(P), !0)), n.setOrUnsetUnderline({ command: T, element: t(P), editor: g, endCheckClass: c }))
                }, n.constructor.prototype.setOrUnsetUnderline = function(e) {
                    var o, i = e.command,
                        a = e.element,
                        l = e.editor,
                        s = e.endCheckClass;
                    if (i == BtnCommand.Underline) {
                        var c, u, m = !1,
                            f = !1,
                            p = !1,
                            h = !1,
                            g = "text-decoration";
                        if (elemenText = t.trim(a.text()), o = l.attr("style"), l.height(l.height() + "px"), 0 == (c = d.getEventCtrl().findTagInParent(a, "u", s)) && (0 != (m = d.getEventCtrl().findTagInParent(a, "a", s)) && "none" != m.css(g) ? (f = m, m = !0) : m = !1, 0 == m)) {
                            var v = a.find("u");
                            if (v.length > 0 && t.trim(v.eq(0).text()) == elemenText && (p = !0), 0 == p) {
                                var C = a.find("a");
                                h = C.length > 0 && t.trim(C.eq(0).text()) == elemenText && "none" != C.eq(0).css(g)
                            }
                        }
                        if (n.setSelection(i), u = { element: a, effectElement: "a", styleName: g, styleValue: "none", elemenText: elemenText, endCheckClass: s }, 0 != c || 0 != m || 0 != p || 0 != h) 1 == m && t.trim(f.text()) != elemenText ? (f.find("*").css(g, ""), "none" != f.css(g) ? f.css(g, "none") : f.css(g, "underline")) : d.getEventCtrl().setElementStyleEffectAll(u);
                        else {
                            var B = t("<u></u>");
                            B.html(a.html()), a.html(B.prop("outerHTML")), d.getEventCtrl().setElementStyleEffectAll(u)
                        }
                        return n.setNodeRange(a[0]), l.attr("style", o), r
                    }
                }, n.constructor.prototype.popCursorLastDiv = function(t) {
                    var n = t.obj,
                        i = t.editor;
                    if (!t.checkOnfocused || !i.data(E.Onfocused)) try {
                        var a;
                        if (!u) return void((a = e.getSelection()).selectAllChildren && n[0] && !s.isIE9() && (a.selectAllChildren(n[0]), a.collapseToEnd()));
                        o.selection && ((a = o.selection.createRange()).moveToElementText(n[0]), a.collapse(!1), a.select())
                    } catch (t) {}
                }
            })
        }, this.getUICtrl = function() { return a || (a = new function() {}) }
    };
    new function() {
        var t, e = this;
        this.getEventCtrl = function() { return t || (t = new function() { r.extend(this, l.getEventCtrl()), this.constructor.prototype.setSelection = function() { return console.log("rewrite setSelection"), e } }) }, this.getUICtrl = function() {}
    };
    _SelectedTool = new function() {
        var e, o;
        this.getEventCtrl = function() {
            return e || (e = new function(e) {
                this.constructor.prototype.bindInputEvent = function(e) {
                    var o = e.element,
                        n = e.module,
                        i = e.editor,
                        a = e.command,
                        r = e.btn,
                        d = e.option;
                    r.find(".selectDivCover").unbind("mousewheel.selectDivCover").bind("mousewheel.selectDivCover", function(t, n) {
                        if (r.find(".fkEditor-formatBar").height() <= 10) return !1;
                        var s, c = r.find(".selectDiv span"),
                            u = parseInt(c.attr("_value"));
                        if (n > 0) {
                            if (u >= 120) return !1;
                            u += 1
                        } else {
                            if (u <= 12) return !1;
                            u -= 1
                        }
                        switch (c.attr("_value", u).text(u), a) {
                            case BtnCommand.FontSize:
                                d.btnModuleEdit ? ((s = {}).command = BtnCommand.FontSize, s.val = u + "px", _EditBtnBase.getEventCtrl().selectChangeForBtnModuel(e, s)) : l.getEventCtrl().setTagStyle({ styleName: "font-size", styleValue: u + "px", editor: i, notCreateNewNode: !0, createNewNodeAction: !0 });
                                break;
                            case BtnCommand.LineHeight:
                                l.getEventCtrl().setTagStyle({ styleName: "line-height", styleValue: u + "px", editor: i, notCreateNewNode: !0, createNewNodeAction: !0 })
                        }
                        return l.getEventCtrl().popCursorLastDiv({ obj: o }), !1
                    }), o.unbind("keyup").bind("keyup", function(o) {
                        o.stopPropagation();
                        var s = t(this),
                            c = s.html().replace(/\D/g, "");
                        switch (c > 120 ? (c = 120, s.html(c), s.attr(T) && l.getEventCtrl().popCursorLastDiv({ obj: s })) : c < 12 && (c = 12), c = t.trim(c), r.find(".selectDiv span").attr("_value", c), a) {
                            case BtnCommand.FontSize:
                                d.btnModuleEdit ? (otherOption = {}, otherOption.command = BtnCommand.FontSize, otherOption.val = c + "px", _EditBtnBase.getEventCtrl().selectChangeForBtnModuel(e, otherOption)) : (i.data(E.SelectedInputBlur) && _EditToolBase.getEventCtrl().editToolLogDog({ module: n, command: BtnCommand.InputFontSize }), l.getEventCtrl().setTagStyle({ styleName: "font-size", styleValue: c + "px", editor: i, notCreateNewNode: !0, createNewNodeAction: !0 }));
                                break;
                            case BtnCommand.LineHeight:
                                i.data(E.SelectedInputBlur) && _EditToolBase.getEventCtrl().editToolLogDog({ module: n, command: BtnCommand.InputLineHeight }), l.getEventCtrl().setTagStyle({ styleName: "line-height", styleValue: c + "px", editor: i, notCreateNewNode: !0, createNewNodeAction: !0 })
                        }
                        i.data(E.SelectedInputBlur, !1)
                    }).unbind("keydown").bind("keydown", function(e) { e.stopPropagation(); var o = e.keyCode; if (13 != o && 116 != o || _EditToolBase.getEventCtrl().animateHideToolSecondPanel(d), l.getEventCtrl().isNumberPress(o)) { var n = t(this).html().replace(/\D/g, ""); "0" != n || 48 != o && 96 != o ? n.length > 3 && e.preventDefault() : e.preventDefault() } else e.preventDefault() }).unbind("blur").bind("blur", function(t) { t.stopPropagation(), i.data(E.SelectedInputBlur, !0) })
                }, this.constructor.prototype.getWheelData = function(t) {
                    var e = t.find(".fkEditor-formats"),
                        o = e.find(".fkEditor-formatContent"),
                        n = e.find(".fkEditor-formatSlider"),
                        i = o.find(".fkEditor-format"),
                        a = e.height(),
                        r = o.height(),
                        l = n.height(),
                        d = i.length - a / i.height(),
                        s = r - a,
                        c = a - l,
                        u = c / d,
                        m = s / d,
                        f = o.position().top,
                        p = n.position().top;
                    return { c: o, s: n, ct: f, st: p, cs: 1 * m, ss: 1 * u, cm: s, sm: c }
                }, this.constructor.prototype.bindMousewheelAndSlideEvent = function(t) {
                    var e, o, n = t.formatbar,
                        i = t.toolbar;
                    e = function() { i.data(ToolAttr.ScrollingMousedown) && i.data(ToolAttr.Scrolling, !0) }, o = function() { i.data(ToolAttr.Scrolling, !1), i.data(ToolAttr.ScrollingMousedown, !1) }, n.find(".fkEditor-formatContent").mCustomScrollbar({ theme: "select-theme", callbacks: { onScrollStart: e, onScroll: o } }), n.find(".mCSB_dragger_bar").unbind("mousemove.scrollTools").bind("mousemove.scrollTools", function(t) { i.data(ToolAttr.ScrollingMousedown, !0) }), n.find("a").click(function() { i.data(ToolAttr.Scrolling, !1) }), n.unbind("mousewheel.formatbar").bind("mousewheel.formatbar", function(t, e) { return !1 })
                }
            })
        }, this.getUICtrl = function() {
            return o || (o = new function() {
                var t = this;
                t.constructor.prototype.createSelectedToolCoverDom = function(t) { var e = []; return e.push('<div unselectable class="selectDivCover"></div>'), e }, t.constructor.prototype.createSelectedToolDom = function(e) {
                    e.option;
                    var o = e.btn,
                        n = e.reSetUnselectable,
                        i = [],
                        a = o.command,
                        r = C;
                    return n && (r = n), i.push("<div " + r + ' class="selectDiv selectDivNew">'), i.push("<span " + r + "></span>"), i.push("</div>"), i.push("<a " + r + ' class="fkEditor-tool-icon fkEditor-tool-iconNew ' + a + '-tool-icon">'), i.push("</a>"), r != C && i.push(t.createSelectedToolCoverDom(e).join("")), i
                }, t.constructor.prototype.createSelectedSlideToolDom = function(e) {
                    var o = e.option,
                        n = e.btn,
                        a = [],
                        r = "formatDef",
                        l = e.selectedData;
                    a.push(t.createSelectedToolDom(e).join("")), a.push('<div class="' + o.css + "-formatBar " + o.css + '-formatBarNew"' + C + ">"), a.push('<span class="selectedTip" title="当访客电脑未安装该款字体时，将显示为系统默认字体。">'), a.push('<span class="tipLeft">'), a.push("</span>"), a.push('<span class="tipRight">'), a.push("当访客电脑未安装该款字体时，将显示为系统默认字体。"), a.push("</span>"), a.push("</span>"), a.push('<div class="' + o.css + "-formats " + o.css + '-formatsNew fkEditorBar" ' + C + ">"), a.push('<div class="' + o.css + '-formatContent" ' + C + ">");
                    for (var d = 0; d < l.length; d++) {
                        var s = "formatMg ",
                            c = "";
                        0 != d && (r = ""), _typeof(l[d][3]) != i && (s += l[d][3], c = ""), a.push("<a " + o.css + '-formatval="' + l[d][0] + '" ' + o.css + '-formatName="' + l[d][1] + '" class="' + o.css + "-format  " + o.css + "-formatNew  " + r + '" role="menuitem" ' + C + ' title="' + c + '">'), _typeof(l[d][2]) != i && a.push('<span class="' + l[d][2] + '"></span>'), a.push('<span style="position:relative; font-family:' + l[d][0] + '" class="' + s + '" ' + C + ">" + l[d][1]), a.push("</span>"), a.push("</a>")
                    }
                    return a.push("</div>"), a.push("</div>"), a.push("</div>"), _EditBtnBase.getUICtrl().createBtnToolDom({ option: o, reSetUnselectable: e.reSetUnselectable, btn: n, toolContent: a.join("") })
                }
            })
        }
    };
    var b = {};
    _EditBtnBase = new function() {
        var e, a, r = this;
        this.getEventCtrl = function() {
            return e || (e = new function() {
                var e, i, a, m = this,
                    p = [],
                    h = [],
                    g = !1;
                m.constructor.prototype.addBtnParam = function(t, e, o, n, i, a, r, l) { return p.push({ moduleName: t, command: e, key: o, tag: n, cls: i, emphasis: a, className: r, title: l }) }, m.constructor.prototype.getButtonsData = function(t) { var e = t.option; return p && p.length > 0 ? m.getShowOrderBtn({ btns: p, toolBtnOrder: e.Tool.ToolBtnOrder, option: e }) : (m.addBtnParam("EditColorBtn", BtnCommand.Colors, "", "", "tool-colors", !1, "tool-color", "颜色"), m.addBtnParam("EditFormatsBtn", BtnCommand.Formats, "", "", "tool-formats", !1, "", "文字字体"), m.addBtnParam("EditFontSizeBtn", BtnCommand.FontSize, "", "", "tool-fontSize", !1, "tool-size", "文字大小"), m.addBtnParam("EditBreakLineBtn"), m.addBtnParam("EditBoldBtn", BtnCommand.Bold, "B", ["b", "strong", "h1", "h2", "h3", "h4", "h5", "h6"], "tool-bold tool-boldNew", !0, "", "加粗"), m.addBtnParam("EditItalicBtn", BtnCommand.Italic, "I", ["i", "em"], "tool-italic", !0, "", "斜体"), m.addBtnParam("EditUnderlineBtn", BtnCommand.Underline, "U", ["u"], "tool-underline", !0, "", "下划线"), m.addBtnParam("EditWritingModeBtn", BtnCommand.WritingMode, "", "", "tool-writingMode tool-writingModeNew", !1, "", "文字排列方式"), m.addBtnParam("EditLineHeightBtn", BtnCommand.LineHeight, "", "", "tool-lineHeight", !1, "", "行高"), m.addBtnParam("EditTextAlignBtn", BtnCommand.TextAlign, "", "", "tool-textAlign", !1, "", "对齐方式"), m.addBtnParam("EditLinkBtn", BtnCommand.Linkcreator, "L", ["a"], "tool-linkcreator", !1, "", "设置链接"), m.addBtnParam("EditRemoveFormatBtn", BtnCommand.Removeformat, ".", "", "tool-removeformat", !1, "", "清除格式"), m.addBtnParam("EditSeperatorBtn"), m.getShowOrderBtn({ btns: p, toolBtnOrder: e.Tool.ToolBtnOrder, option: e })) }, m.constructor.prototype.addHoverBtnParam = function(t, e, o, n) { return h.push({ moduleName: t, command: e, className: o, title: n }) }, m.constructor.prototype.getHoverShowButtons = function(t) { var e = t.option; return h && h.length > 0 ? m.getShowOrderBtn({ btns: h, toolBtnOrder: e.HoverTool.ToolBtnOrder, option: e }) : (m.addHoverBtnParam("EditContentBtn", BtnCommand.EditContent, "tool-editContent tool-editContentNew", "编辑文本"), m.addHoverBtnParam("EditFixedPositionBtn", BtnCommand.EditPositionFixed, "tool-editPositionFixed", "固定"), m.addHoverBtnParam("EditLogoDisplayBtn", BtnCommand.EditLogoDisplay, "tool-editLogoDisplay", "显示Logo"), m.addHoverBtnParam("EditBtnModuleStyleBtn", BtnCommand.BtnModuleStyle, "tool-editModule f-tool-editModule", "设置样式"), m.addHoverBtnParam("EditPhotoBtn", BtnCommand.EditPhotoBtn, "f-tool-editPic tool-editPic", "添加图片"), m.addHoverBtnParam("EditImgEffectBtn", BtnCommand.ImgEffectBtn, "f-tool-hoverPic tool-hoverPic", "模块特效"), m.addHoverBtnParam("EditPhotoShapeBtn", BtnCommand.PhotoShapeBtn, "f-tool-picShape tool-picShape", "图片形状"), m.addHoverBtnParam("EditSimpleLinkBtn", BtnCommand.SimpleLinkBtn, "f-tool-link tool-link f-simple-tool-link", "设置链接"), m.addHoverBtnParam("EditModuleTitleBtn", BtnCommand.ModuleTitleBtn, "f-tool-edit-name tool-edit-name", "模块标题"), m.addHoverBtnParam("EditDescribePicBtn", BtnCommand.DescribePicBtn, "f-tool-description tool-description", "图片描述"), m.addHoverBtnParam("EditFixedBtn", BtnCommand.EditFixedBtn, "f-tool-fixed tool-fixed", "固定"), m.addHoverBtnParam("EditAnimationBtn", BtnCommand.Animation, "f-tool-animation tool-animation tool-animationNew", "模块动画"), m.addHoverBtnParam("EditBorderRadiusBtn", BtnCommand.BorderRadius, "f-tool-borderRadius tool-borderRadius", "圆角"), m.addHoverBtnParam("EditOpacityBtn", BtnCommand.Opacity, "f-tool-opacity tool-opacity", "透明度"), m.addHoverBtnParam("EditBorderBtn", BtnCommand.Border, "f-tool-border tool-border", "边框"), m.addHoverBtnParam("EditShadowBtn", BtnCommand.Shadow, "f-tool-shadow tool-shadow", "阴影"), m.addHoverBtnParam("EditGlobalLinkBtn", BtnCommand.GlobalLink, "f-tool-link tool-link tool-linkNew", "设置链接"), m.addHoverBtnParam("EditDeleteBtn", BtnCommand.Delete, "f-tool-delete tool-delete tool-deleteNew", "隐藏模块"), m.addHoverBtnParam("EditSeperatorBtn"), m.getShowOrderBtn({ btns: h, toolBtnOrder: e.HoverTool.ToolBtnOrder, option: e })) }, m.constructor.prototype.getShowOrderBtn = function(t) {
                    for (var e = t.option, o = t.btns, n = t.toolBtnOrder, i = [], a = 0; a < n.length; a++)
                        for (var r = 0; r < o.length; r++)
                            if (o[r].moduleName == n[a]) { "EditContentBtn" == o[r].moduleName ? o[r].title = e.EditContentBtn.name : "EditDeleteBtn" == o[r].moduleName && ("logo" == e.moduleId ? o[r].title = "隐藏logo" : o[r].title = "隐藏模块"), i.push(o[r]); break }
                    return i
                }, m.constructor.prototype.buttonEmphasize = function(e) {
                    for (var o, n, i, a = e.option, r = e.buttons, s = e.editor, c = t("#" + a.css + "-toolBar-" + a.moduleId), u = c.find(".tool-formats"), m = c.find(".tool-fontSize"), f = m.find(".selectDiv span"), p = c.find(".tool-lineHeight"), h = c.find(".tool-color ." + a.css + "-tool-icon"), g = a.css + "-tool-depressedNew", v = a.css + "-tool-depressedNewHover", C = a.css + "-tool-depressedNewShow", B = 0; B < r.length; B++)
                        if (d.getEventCtrl().checkInArray(a.Tool.ToolBtnOrder, r[B].moduleName)) {
                            if (i = r[B].command, r[B].emphasis && "" != r[B].tag) {
                                if (o = r[B].cls.split(" ")[0], !(n = l.getEventCtrl().detectElement({ tags: r[B].tag }))) switch (i) {
                                    case BtnCommand.Bold:
                                        "bold" == l.getEventCtrl().detectElementCss("font-weight") && (n = !0);
                                        break;
                                    case BtnCommand.Italic:
                                        "italic" == l.getEventCtrl().detectElementCss("font-style") && (n = !0);
                                        break;
                                    case BtnCommand.Underline:
                                        /underline/.test(l.getEventCtrl().detectElementCss("text-decoration")) && (n = !0)
                                }
                                n ? c.find("." + o).find("." + C).length <= 0 && c.find("." + o).find("." + g).addClass(C).removeClass(v) : c.find("." + o).find("." + g).removeClass(C).addClass(v)
                            }
                            var E, b, k, S, y;
                            if (i == BtnCommand.TextAlign) switch (l.getEventCtrl().detectElementCss("text-align")) {
                                case "center":
                                    _EditTextAlignBtn.getEventCtrl().textAlignEmphasize({ editor: s, toolbar: c, command: BtnCommand.JustifyCenter });
                                    break;
                                case "right":
                                    _EditTextAlignBtn.getEventCtrl().textAlignEmphasize({ editor: s, toolbar: c, command: BtnCommand.JustifyRight });
                                    break;
                                case "justify":
                                    _EditTextAlignBtn.getEventCtrl().textAlignEmphasize({ editor: s, toolbar: c, command: BtnCommand.JustifyFull });
                                    break;
                                default:
                                    _EditTextAlignBtn.getEventCtrl().textAlignEmphasize({ editor: s, toolbar: c, command: BtnCommand.JustifyLeft })
                            }
                            if (i == BtnCommand.WritingMode) {
                                var _, w = l.getEventCtrl().getSelectedNode();
                                if (!w || w.length < 0) return;
                                switch (w.hasClass("fk-editor") && (w.hasClass("fk-editor-vertical-rl") ? _ = "verticalToLeft" : w.hasClass("fk-editor-vertical-lr") && (_ = "verticalToRight")), _) {
                                    case "verticalToRight":
                                        _EditWritingModeBtn.getEventCtrl().writtingModeEmphasize({ editor: s, toolbar: c, command: BtnCommand.VerticalToRight });
                                        break;
                                    case "verticalToLeft":
                                        _EditWritingModeBtn.getEventCtrl().writtingModeEmphasize({ editor: s, toolbar: c, command: BtnCommand.VerticalToLeft });
                                        break;
                                    default:
                                        _EditWritingModeBtn.getEventCtrl().writtingModeEmphasize({ editor: s, toolbar: c, command: BtnCommand.Horizontal })
                                }
                            }
                            if (i == BtnCommand.Colors && (E = l.getEventCtrl().detectElementCss("color"), b = _EditColorBtn.getEventCtrl().checkColorIsWhite(E), S = "none" == (k = l.getEventCtrl().detectElementCss("background-image")), b && S ? h.css("border", "solid 1px #ccc") : h.css("border", "0px"), b && S ? h.css("background", E) : S ? h.css("background", E) : h.css("background", k), h.removeClass("fk-colorPicker-transparentIco")), i == BtnCommand.Formats) {
                                var x, D, P = "font-family",
                                    H = a.EditFormatsBtn.selectedData;
                                if (H && H.length > 0) {
                                    (x = l.getEventCtrl().detectElementCss(P)).indexOf(",") > 0 && (x = x.substring(0, x.indexOf(","))), x = (x = x.replace(/"/g, "")).replace(/'/g, "");
                                    for (var I = 0; I < H.length; I++)
                                        if (t.trim(H[I][0]).indexOf(t.trim(x)) >= 0) { x = H[I][1], (D = u.find("." + a.css + "-formatContent")).find(".formatDef").removeClass("formatDef"), D.find("a").eq(I).addClass("formatDef"); break }
                                    u.find(".selectDiv span").html(x), u.attr("title", x)
                                }
                            }
                            i == BtnCommand.FontSize && (P = "font-size", fontSize = l.getEventCtrl().detectElementCss(P), fontSize = parseInt(fontSize.replace("px", "")), fontSize > 0 && ("true" == f.attr(T) ? m.find(".selectDiv span").attr("_value", fontSize).html(fontSize) : m.find(".selectDiv span").attr("_value", fontSize).html(fontSize + "px"))), i == BtnCommand.LineHeight && (P = "line-height", y = (y = l.getEventCtrl().detectElementCss(P)).replace("px", ""), isNaN(y) && fontSize && (y = fontSize), (y = parseInt(y)) > 0 && p.find(".selectDiv span").attr("_value", y))
                        }
                }, m.constructor.prototype.bindToolBtnEvent = function(e) {
                    var o = e.option,
                        n = e.editor,
                        i = e.toolbar,
                        a = (e.module, e.fkEditorWrap, i.find(".simpleTextEditTool .tool")),
                        d = i.find(".editToolIcon");
                    return f && d.unbind("mouseup.hoverToolButton").bind("mouseup.hoverToolButton", function(t) { t.stopPropagation() }), d.unbind("click.hoverToolButton").bind("click.hoverToolButton", function() { return e.thisBtnElement = this, m.hoverToolButtonClick(e), !1 }), o.simpleTool || a.unbind("click.toolbutton").bind("click.toolbutton", function(i) { return n.data(E.HasRsChildStyle, 0), _EditColorBtn.getEventCtrl().backTextSelectedStatus(e), t(".J_advanceColorPicker").hide(), f ? (l.getEventCtrl().setSelectRange(n.data(E.Range)), e.thisBtnElement = this, o.btnModuleEdit ? m.toolButtonClickForBtnModuel(e) : m.toolButtonClick(e)) : (e.thisBtnElement = this, o.btnModuleEdit ? m.toolButtonClickForBtnModuel(e) : m.toolButtonClick(e)), !1 }), r
                }, m.constructor.prototype.hoverToolButtonClick = function(e) {
                    var o, n = e.option,
                        i = e.editor,
                        r = e.module,
                        d = e.fkEditorWrap,
                        u = e.toolbar,
                        m = e.thisBtnElement,
                        f = t(m),
                        p = n.moduleId.replace("module", ""),
                        h = f.attr("command"),
                        v = n.btnModuleEdit,
                        C = n.simpleTool,
                        B = n.tipTitle,
                        k = !0;
                    switch (i.data(E.PreCommand, h), _EditToolBase.getEventCtrl().hideToolBarMask(), h) {
                        case BtnCommand.EditContent:
                            b[i.attr("id")] = i.html() || "", i.data(E.TriggerClick) && (i.data(E.TriggerClick, !1), k = !1), i.find(".editTip").length > 0 ? i.data(E.PreHtmlContent, "") : i.data(E.PreHtmlContent, i.html()), i.data(E.SimpleTextEdit, !0), i.data(E.HasRefreshClick, !0), i.removeData(E.Range, !0), u.css({ width: n.Tool.width, height: n.Tool.height }), u.find(".simpleTextHoverTool").hide(), u.find(".simpleTextEditTool").fadeIn(500), i.css("cursor", "text"), _EditLinkBtn.getEventCtrl().handTagANotJump(i), r.addClass("formLockEdit"), i.not(":focus") && (clearTimeout(a), a = setTimeout(function() { i.find(".editTip").remove(), i.attr(T, !0).focus(), _EditBtnBase.getEventCtrl().buttonEmphasize(e) }, 100)), _EditToolBase.getEventCtrl().calcuToolBarPos(e), c.checkSimpleTextHideTool(n.moduleId), _EditToolBase.getEventCtrl().editToolBarMask(p), _EditWritingModeBtn.getEventCtrl().adjustWritingModeState(e), v && ((o = {}).command = BtnCommand.EditContent, _EditBtnBase.getEventCtrl().selectChangeForBtnModuel(e, o)), l.getEventCtrl().popCursorLastDiv({ obj: i, editor: i, checkOnfocused: !0 });
                            break;
                        case BtnCommand.EditPositionFixed:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), _EditFixedPositionBtn.getEventCtrl().checkPositionFixed({ toolbar: u, btn: f, option: n }), _EditToolBase.getEventCtrl().calcuToolBarPos(e);
                            break;
                        case BtnCommand.EditLogoDisplay:
                            if (g) return;
                            g = !0, _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), _EditLogoDisplayBtn.getEventCtrl().checkLogoDisplay({ toolbar: u, btn: f, option: n }), setTimeout(function() { g = !1 }, 500);
                            break;
                        case BtnCommand.GlobalLink:
                            if (i.data(E.PreHtmlContent, i.html()), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), i.find(".editTip").length > 0 && !v && !C) return void s.ing("请输入内容", !0);
                            if (n.globalJumpCtrlFun && "" != n.globalJumpCtrlFun) {
                                var S, y = {};
                                C || (l.getEventCtrl().setNodeRange(i[0]), S = l.getEventCtrl().getSelectText(i, !1), y = "corpTitle" == n.editorName ? _EditLinkBtn.getEventCtrl().getCorpTitleLinkPreData() : _EditLinkBtn.getEventCtrl().getGlobalLinkPreData(i, e)), v || C ? (_EditGlobalLinkBtn.getEventCtrl().showGlobalLinkPanel(e), s.fkEval(n.globalJumpCtrlFun)) : S && "" != S && ("" == y._lide ? (i.data(E.TriggerClick, !0), u.find(".tool-linkcreator").trigger("click"), setTimeout(function() { i.attr(T, !1) }, 500)) : (_EditGlobalLinkBtn.getEventCtrl().showGlobalLinkPanel(e), y._lname = y._lname || y._lurl, s.fkEval(n.globalJumpCtrlFun.replace("xxx", t.toJSON(y)))))
                            }
                            break;
                        case BtnCommand.BorderRadius:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), _EditBorderRadiusBtn.getEventCtrl().showBorderRadiusPanel(e);
                            break;
                        case BtnCommand.Opacity:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), _EditOpacityBtn.getEventCtrl().showOpacityPanel(e);
                            break;
                        case BtnCommand.Border:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), _EditBorderBtn.getEventCtrl().showBorderPanel(e);
                            break;
                        case BtnCommand.Shadow:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), _EditShadowBtn.getEventCtrl().showShadowPanel(e);
                            break;
                        case BtnCommand.Delete:
                            _EditToolBase.getEventCtrl().deleteOrHideToolBar(n), n.deleteFun && "" != n.deleteFun ? s.fkEval(n.deleteFun) : C || d.remove();
                            break;
                        case BtnCommand.Animation:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), n.animationFun && "" != n.animationFun && s.fkEval(n.animationFun);
                            break;
                        case BtnCommand.BtnModuleStyle:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), n.editModuleFun && "" != n.editModuleFun && s.fkEval(n.editModuleFun);
                            break;
                        case BtnCommand.EditPhotoBtn:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), n.editPhotoFun && "" != n.editPhotoFun && s.fkEval(n.editPhotoFun);
                            break;
                        case BtnCommand.ImgEffectBtn:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), n.imgEffectFun && "" != n.imgEffectFun && s.fkEval(n.imgEffectFun);
                            break;
                        case BtnCommand.PhotoShapeBtn:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), n.photoShapeFun && "" != n.photoShapeFun && s.fkEval(n.photoShapeFun);
                            break;
                        case BtnCommand.SimpleLinkBtn:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), n.simpleLinkFun && "" != n.simpleLinkFun && s.fkEval(n.simpleLinkFun);
                            break;
                        case BtnCommand.ModuleTitleBtn:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n);
                            var _ = u.find(".tool-edit-name .fkEditor-moduleNameSlideBar"),
                                w = s.top.$("#module" + p + "SideBtn").find(".g_sideBtn_c .g_sideBtn_tl").text();
                            _.find(".J_module-name-input").val(w).focus(), _EditModuleTitleBtn.getEventCtrl().showModuleTitlePanel(e);
                            break;
                        case BtnCommand.DescribePicBtn:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), u.find(".tool-description").find("#logoDescription").val(s.decodeHtml(s.top._logoData.des)).focus(), _EditDescribePicBtn.getEventCtrl().showDescribePicPanel(e);
                            break;
                        case BtnCommand.EditFixedBtn:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), _EditFixedBtn.getEventCtrl().setFixedLogoBtnTitle({ toolbar: u, btn: f, option: n }), n.fixedFun && "" != n.fixedFun && (s.fkEval(n.fixedFun), c.undoRun(function() {}, { type: "logo", detail: "fixedClick", undoSame: !1, redoSame: !1, undoArgs: [{ toolbar: u, btn: f, option: n }], redoArgs: [{ toolbar: u, btn: f, option: n }], undoFn: function(t) { _EditFixedBtn.getEventCtrl().setFixedLogoBtnTitle(t), s.fkEval(n.fixedFun) }, redoFn: function(t) { _EditFixedBtn.getEventCtrl().setFixedLogoBtnTitle(t), s.fkEval(n.fixedFun) } }))
                    }
                    B && _EditToolBase.getEventCtrl().hideSimpleTip(u.find(".simpleTextHoverTool .tool .editToolIcon")), i.trigger("change"), k && _EditToolBase.getEventCtrl().editToolLogDog({ module: r, command: h })
                }, m.constructor.prototype.toolButtonClick = function(o) {
                    var a = o.option,
                        d = o.editor,
                        s = o.module,
                        m = o.toolbar,
                        f = o.thisBtnElement,
                        p = (m.find(".tool"), t(f).attr("command")),
                        h = m.find(".tool-color ." + a.css + "-tool-icon"),
                        g = !0;
                    switch (d.not(":focus") && d.attr(T, !0).focus(), p == BtnCommand.Removeformat && d.data(E.HasRefreshClick, !0), _EditorBase.getEventCtrl().setEidtorSelectedRule({ editor: d, command: p }), d.data(E.PreCommand, p), p) {
                        case BtnCommand.Linkcreator:
                            if (d.data(E.TriggerClick) && (d.data(E.TriggerClick, !1), g = !1), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(a), a.jumpCtrlFun && "" != a.jumpCtrlFun && !d.data(E.LinkHasClick)) {
                                var v = l.getEventCtrl().getSelectText(d, !0);
                                linkPreData = {}, "corpTitle" == a.editorName ? linkPreData = _EditLinkBtn.getEventCtrl().getCorpTitleLinkPreData() : linkPreData = _EditLinkBtn.getEventCtrl().getLinkPreData(), d.data(E.LinkHasClick, !0), v && "" != v && n.fkEval(a.jumpCtrlFun.replace("xxx", t.toJSON(linkPreData))), clearTimeout(e), e = setTimeout(function() { d.data(E.LinkHasClick, !1) }, 2e3)
                            }
                            break;
                        case BtnCommand.Formats:
                            _EditFormatsBtn.getEventCtrl().showFormatToolBar(o);
                            break;
                        case BtnCommand.FontSize:
                            _EditFontSizeBtn.getEventCtrl().showSizeToolBar(o);
                            break;
                        case BtnCommand.LineHeight:
                            _EditLineHeightBtn.getEventCtrl().showLineHiehgtToolBar(o);
                            break;
                        case BtnCommand.Colors:
                            if (_EditToolBase.getEventCtrl().animateHideToolSecondPanel(a), c.colorPickerV2.show({ base: m[0], initialColor: "none" == h.css("background-image") ? h.css("background-color") : h.css("background-image"), defaultColor: "#000000", openGradientMode: !0, onChange: c.simpleTextSetTextColor }), c.simpleTextList.allEditors)
                                for (var C = 0; C < c.simpleTextList.allEditors.length; C++)
                                    if (c.simpleTextList.allEditors[C].moduleId == a.moduleId) { c.simpleTextList.chooseEditor = c.simpleTextList.allEditors[C].editor; break }
                            break;
                        case BtnCommand.Underline:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(a), t.trim(l.getEventCtrl().getSelectText(d, !0)).length > 0 && d.find("a").length > 0 ? l.getEventCtrl().setTagStyle({ editor: d, command: p }) : l.getEventCtrl().setSelection(p);
                            break;
                        case BtnCommand.Removeformat:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(a), t.trim(l.getEventCtrl().getSelectText(d, !1)).length == t.trim(d.text()).length ? d.html(d.text()) : (u && l.getEventCtrl().setTagStyle({ styleName: "font-size", styleValue: "20px", editor: d }), l.getEventCtrl().setSelection(p), l.getEventCtrl().setSelection("Unlink"), clearTimeout(i), i = setTimeout(function() { l.getEventCtrl().setSelection("removeformat") }, 100), (s.find(".fk-editor-vertical-rl").length < 1 || s.find(".fk-editor-vertical-lr").length < 1) && _EditorBase.getEventCtrl().setEditorAutoHeight(a.moduleId));
                            break;
                        case BtnCommand.TextAlign:
                            _EditTextAlignBtn.getEventCtrl().showTextAlignBtnPanel(o);
                            break;
                        case BtnCommand.WritingMode:
                            _EditWritingModeBtn.getEventCtrl().showWritingModePanel(o);
                            break;
                        default:
                            l.getEventCtrl().setSelection(p), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(a)
                    }
                    return d.data(E.ClearSpanCursoring) || (d.trigger("change"), d.data(E.ClearSpanCursoring, !0), d.find("span").css("cursor", ""), setTimeout(function() { d.data(E.ClearSpanCursoring, !1) }, 300)), setTimeout(function() { p != BtnCommand.Underline && p != BtnCommand.Bold && p != BtnCommand.Italic && p != BtnCommand.Removeformat || _EditBtnBase.getEventCtrl().buttonEmphasize(o), t.trim(l.getEventCtrl().getSelectText(d, !0)).length > 0 && l.getEventCtrl().getSelectText(d, !1) }, 100), g && _EditToolBase.getEventCtrl().editToolLogDog({ module: s, command: p }), r
                }, m.constructor.prototype.toolButtonClickForBtnModuel = function(e) {
                    var o = e.option,
                        n = e.editor,
                        i = e.module,
                        a = o.moduleId.replace("module", ""),
                        d = e.toolbar,
                        u = e.thisBtnElement;
                    switch (toolbutton = d.find(".tool"), jqThisBtn = t(u), command = jqThisBtn.attr("command"), colorBar = d.find(".tool-color ." + o.css + "-tool-icon"), contentLink = s.top.Site.getModuleAttrPattern(a).contentLink, l.getEventCtrl().setNodeRange(n[0]), n.not(":focus") && n.attr(T, !0).focus(), n.data(E.PreCommand, command), command) {
                        case BtnCommand.Formats:
                            _EditFormatsBtn.getEventCtrl().showFormatToolBar(e);
                            break;
                        case BtnCommand.FontSize:
                            _EditFontSizeBtn.getEventCtrl().showSizeToolBar(e);
                            break;
                        case BtnCommand.Colors:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(o);
                            var m = function(t, e) {
                                var o = e || t;
                                _EditColorBtn.getEventCtrl().checkColorIsWhite(o) ? colorBar.css("border", "solid 1px #ccc") : colorBar.css("border", "0px"), colorBar.css("background", o), contentLink.y = 1, contentLink.fct = 1, contentLink.c = o, s.top.Site.getModuleAttrPattern(a).changed = !0, o.indexOf("linear-gradient") > -1 ? c.setModuleStyleCssList(a, [{ cls: ".m_float_btn__text", key: "color", value: o }, { cls: ".m_float_btn__text", key: "background-image", value: o }, { cls: ".m_float_btn__text", key: "-webkit-background-clip", value: "text" }, { cls: ".m_float_btn__text", key: "-webkit-text-fill-color", value: "transparent" }]) : (c.removeModuleStyleCssList(a, [{ cls: ".m_float_btn__text", key: "background-image" }, { cls: ".m_float_btn__text", key: "-webkit-background-clip" }, { cls: ".m_float_btn__text", key: "-webkit-text-fill-color" }]), c.setModuleStyleCssList(a, [{ cls: ".m_float_btn__text", key: "color", value: o }])), c.styleChanged()
                            };
                            c.colorPickerV2.show({ base: d[0], initialColor: "none" == colorBar.css("background-image") ? colorBar.css("background-color") : colorBar.css("background-image"), defaultColor: "#000000", openGradientMode: !0, onChange: m, onChangeStop: function(t, e) { c.undoRun(m, { type: "module.floatBtn", detail: "floatBtnTextColor", id: a, doArgs: [t], undoArgs: [e] }) } }), l.getEventCtrl().getWindowSelection().removeAllRanges();
                            break;
                        case BtnCommand.Underline:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(o), c.undoRun(function(t, e) {
                                s.top.Site.getModuleAttrPattern(t).changed = !0;
                                var o = s.top.Site.getModuleAttrPattern(t).contentLink;
                                e ? (o.d = 1, o.y = 1) : o.d = 0, c.setModuleStyleCssList(t, [{ cls: ".lightModuleOuterContent" + t + " a", key: "text-decoration", value: e ? "underline" : "none" }, { cls: ".lightModuleOuterContent" + t + " .pagenation_N a span", key: "text-decoration", value: e ? "underline" : "none" }])
                            }, { type: "module.floatBtn", detail: "floatBtnUnderLine", id: a, doArgs: [a, !contentLink.d], undoArgs: [a, contentLink.d], redoArgs: [a, !contentLink.d] }), c.styleChanged();
                            break;
                        case BtnCommand.Bold:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(o), c.undoRun(function(t, e) {
                                s.top.Site.getModuleAttrPattern(t).changed = !0;
                                var o = s.top.Site.getModuleAttrPattern(t).contentLink;
                                e ? (o.b = 1, o.y = 1) : o.b = 0, c.setModuleStyleCssList(t, [{ cls: ".lightModuleOuterContent" + t + " a", key: "font-weight", value: e ? "bold" : "normal" }])
                            }, { type: "module.floatBtn", detail: "floatBtnBold", id: a, doArgs: [a, !contentLink.b], undoArgs: [a, contentLink.b], redoArgs: [a, !contentLink.b] }), c.styleChanged();
                            break;
                        default:
                            _EditToolBase.getEventCtrl().animateHideToolSecondPanel(o)
                    }
                    return n.data(E.ClearSpanCursoring) || (n.trigger("change"), n.data(E.ClearSpanCursoring, !0), n.find("span").css("cursor", ""), setTimeout(function() { n.data(E.ClearSpanCursoring, !1) }, 300)), setTimeout(function() { command != BtnCommand.Underline && command != BtnCommand.Bold || _EditBtnBase.getEventCtrl().buttonEmphasize(e) }, 100), _EditToolBase.getEventCtrl().editToolLogDog({ module: i, command: command }), r
                }, m.constructor.prototype.selectChangeForBtnModuel = function(e, n) {
                    var i = e.option,
                        a = e.editor,
                        r = e.module,
                        l = i.moduleId.replace("module", ""),
                        d = s.top.Site.getModuleAttrPattern(l).contentLink,
                        u = n.command,
                        m = n.val;
                    switch (u) {
                        case BtnCommand.Formats:
                            var f = a.css("font-family");
                            d.y = 1, d.f = m, s.top.Site.getModuleAttrPattern(l).changed = !0, m = (m = m.replace(/"/g, "")).replace(/'/g, ""), a.css("font-family", m), c.styleChanged(), c.undoRun(function() {}, { type: "module.floatBtn", detail: "floatBtnFormats", id: l, undoSame: !1, redoSame: !1, undoArgs: [a, f], redoArgs: [a, m], undoFn: function(t, e) { t.css("font-family", e) }, redoFn: function(t, e) { t.css("font-family", e) } });
                            break;
                        case BtnCommand.FontSize:
                            var p = a.css("font-size");
                            a.css("font-size", m), d.y = 1, d.ls = m.replace("px", ""), s.top.Site.getModuleAttrPattern(l).changed = !0, c.styleChanged(), c.undoRun(function() {}, { type: "module.floatBtn", detail: "floatBtnFontSize", id: l, undoSame: !1, redoSame: !1, undoArgs: [a, p], redoArgs: [a, m], undoFn: function(t, e) { t.css("font-size", e) }, redoFn: function(t, e) { t.css("font-size", e) } });
                            break;
                        case BtnCommand.EditContent:
                            a.focus(function() { t(this).css("white-space", "normal") }).focusout(function() { t(this).css("white-space", "nowrap") }), r.find(".ui-resizable-handle").show(), s.top.$(o).off("click.btnToolHide").on("click.btnToolHide", function() { a.attr(T) || r.unbind("mouseout.showResizable") }), r.bind("mouseout.showResizable", function() { r.find(".ui-resizable-handle").show() })
                    }
                }
            })
        }, this.getUICtrl = function() {
            return a || (a = new function() {
                this.constructor.prototype.createHoverBtnToolDom = function(t) {
                    var e = t.option,
                        o = t.btn,
                        n = t.btnContent,
                        i = [],
                        a = "",
                        r = "";
                    return e.tipTitle ? r = ' data-title-tip="' + o.title + '" ' : a = ' title="' + o.title + '" ', i.push('<div command="' + o.command + '" class="tool f-tool editTool ' + o.className + '" role="button" ' + C + " " + a + " >"), n ? i.push(n) : i.push('<a unselectable class="editToolIcon f-editToolIcon" command ="' + o.command + '" ' + r + " ></a>"), i.push("</div>"), i
                }, this.constructor.prototype.createBtnToolDom = function(t) {
                    var e = t.option,
                        o = t.btn,
                        n = t.toolContent,
                        a = t.reSetUnselectable,
                        r = [],
                        l = C;
                    return a && (l = a), r.push('<div command="' + o.command + '" class="tool ' + o.cls + " " + o.className + '" role="button" data-tool="' + o.cls + '" ' + l + ' title="' + o.title + '">'), n ? r.push(n) : r.push("<a " + l + ' class="fkEditor-tool-icon"></a>'), _typeof(o.emphasis) != i && o.emphasis && r.push('<div class="' + e.css + "-tool-depressedNew " + e.css + '-tool-depressedNewHover"></div>'), r.push("</div>"), r
                }
            })
        }
    };
    _EditToolBase = new function() {
        var n, a, r = this;
        this.getEventCtrl = function() {
            return n || (n = new function() {
                var n, a, u, m, f, p, h = this;
                h.constructor.prototype.bindToolAndEditorCreatedEvent = function(t) { return _EditGlobalLinkBtn.getEventCtrl().bindGlobalLinkPanelEvent(t), _EditBorderRadiusBtn.getEventCtrl().bindBorderRadiusPanelEvent(t), _EditOpacityBtn.getEventCtrl().bindOpacityPanelEvent(t), _EditModuleTitleBtn.getEventCtrl().bindModuleTitlePanelEvent(t), _EditDescribePicBtn.getEventCtrl().bindDescribePicPanelEvent(t), _EditBorderBtn.getEventCtrl().bindBorderPanelEvent(t), _EditShadowBtn.getEventCtrl().bindShadowPanelEvent(t), _EditFormatsBtn.getEventCtrl().bindFormatSliderEvent(t), _EditFontSizeBtn.getEventCtrl().bindFontSizeEvent(t), _EditLineHeightBtn.getEventCtrl().bindLineHeihgtSliderBarEvent(t), _EditTextAlignBtn.getEventCtrl().bindTextAlignSliderBarEvent(t), _EditWritingModeBtn.getEventCtrl().bindWrittingModeSliderBarEvent(t), _EditRadiusBtn.getEventCtrl().bindRadiusBtnEvent(t), _EditBtnBase.getEventCtrl().bindToolBtnEvent(t), h.bindToolBarEvent(t), _FkEditor.getEventCtrl().bindEditorEvent(t), r }, h.constructor.prototype.bindSimpleToolCreatedEvent = function(t) { return _EditGlobalLinkBtn.getEventCtrl().bindGlobalLinkPanelEvent(t), _EditBorderRadiusBtn.getEventCtrl().bindBorderRadiusPanelEvent(t), _EditOpacityBtn.getEventCtrl().bindOpacityPanelEvent(t), _EditModuleTitleBtn.getEventCtrl().bindModuleTitlePanelEvent(t), _EditDescribePicBtn.getEventCtrl().bindDescribePicPanelEvent(t), _EditBorderBtn.getEventCtrl().bindBorderPanelEvent(t), _EditShadowBtn.getEventCtrl().bindShadowPanelEvent(t), _EditRadiusBtn.getEventCtrl().bindRadiusBtnEvent(t), _EditBtnBase.getEventCtrl().bindToolBtnEvent(t), h.bindToolBarEvent(t), r }, h.constructor.prototype.showToolBar = function(e) {
                    var o = e.option,
                        n = e.editor,
                        i = e.module,
                        a = t("#fkEditor-toolBar-" + o.moduleId);
                    if (!c.checkNestModule(i).inSubNav || s.top._subNavPackEdit) {
                        var r = c.hasPopupModuleOpen();
                        (!c.checkNestModule(i).inPopupZone || r && r.editing) && (i.hasClass("fixed_project") || "fk-webHeaderZone" === c.checkNestModule(i).realParentId && t(".webHeaderFixed").length || (h.calcuToolBarPos(e), h.calcuPanelPosForRight(e), i.data(E.HoverToolOn, !0), n.data(E.SimpleTextEdit) || (h.checkEditItemDisplay(e), a.find(".simpleTextEditTool").hide(), a.find(".simpleTextHoverTool").show())))
                    }
                }, h.constructor.prototype.calcuToolBarPos = function(e) {
                    var o, n, i, a, l = e.option,
                        d = e.editor,
                        u = t("#fkEditor-toolBar-" + l.moduleId),
                        m = _EditorBase.getEventCtrl().getModule({ option: l }),
                        f = t("#web").offset(),
                        p = m.offset(),
                        h = p.top,
                        g = t("#g_main").width(),
                        v = p.left,
                        C = t(".floatLeftTop").offset().top,
                        B = 0,
                        T = 8,
                        b = c.checkNestModule(m);
                    return u.css({ left: 0, top: 0 }), t("#topAdvArea").is(":visible") && (B = t("#topAdvArea").height()), l.btnModuleEdit && (T += 6), n = v + (o = u.outerWidth() + 2) - g, l.HoverTool && l.HoverTool.show || (simpleTextEdit = !0), d.data(E.SimpleTextEdit) ? toolBarHeight = parseInt(l.Tool.height.replace("px", "")) : toolBarHeight = parseInt(l.HoverTool.height.replace("px", "")), v -= f.left, u.data(E.FixRight, !1), n > 0 && (v = v - n - 20, u.data(E.FixRight, !0)), v + o + 135 > g && u.data(E.FixRight, !0), v = v < 0 ? 0 : v, i = parseInt(h - f.top) - (toolBarHeight + T) + "px", a = v + "px", f.top + C - B > h && (i = parseInt(h + m.outerHeight() - C - B) + "px"), b.inPopupZone && (i = parseInt(h) - (toolBarHeight + T) + "px", toolBarHeight + T > h && (i = parseInt(h + m.outerHeight() + T) + "px")), u.css({ display: "block", top: i, left: a }).addClass("J_fkEditor_tool").data(E.ModuleId, l.moduleId), (m.data("corpTitle") || m.data("logo")) && ((s.top._logoPositionFixTop || s.top._titlePositionFixTop) && h <= C ? u.css({ top: parseInt(h + m.outerHeight()) + "px", position: "fixed" }) : u.css({ position: "absolute" })), r
                }, h.constructor.prototype.calcuPanelPosForRight = function(e) {
                    var o, n, i, a, r = e.option,
                        l = (e.editor, t("#fkEditor-toolBar-" + r.moduleId)),
                        d = l.find(".simpleTextHoverTool .fkEditorBar"),
                        s = 2,
                        c = -2;
                    l.data("fixRight") ? (l.find(".tool .slideDiv").addClass("f-slideDiv-right"), d.each(function() { o = t(this).innerWidth(), s = 2, c = 1, t(this).hasClass("borderPanel") ? i = _EditBorderBtn._panelHeight : t(this).hasClass("opacityPanel") ? i = _EditOpacityBtn._panelHeight : t(this).hasClass("linkPanel") ? (i = _EditGlobalLinkBtn._panelHeight, c = 5) : t(this).hasClass("shadowPanel") ? i = _EditShadowBtn._panelHeight : t(this).hasClass("J_moduleNamePanel") ? i = _EditModuleTitleBtn._panelHeight : t(this).hasClass("descPanel") ? i = _EditDescribePicBtn._panelHeight : t(this).hasClass("borderRadiusPanel") && (i = _EditBorderRadiusBtn._panelHeight), a = -i, n = -(o - 38), !isNaN(i) && i > 0 && t(this).css({ top: a - s + "px", left: n - c + "px" }) })) : (d.css({ left: "6px", top: "46px" }), l.find(".simpleTextHoverTool .linkPanel").css({ left: "2px", top: "46px" }), l.find(".tool .slideDiv").removeClass("f-slideDiv-right"))
                }, h.constructor.prototype.checkEditItemDisplay = function(t) {
                    var e, o, n = t.option,
                        i = t.toolbar,
                        a = i.find(".tool-animation"),
                        l = n.moduleId;
                    return "function" == typeof n.animationStatusFun && 1 == n.animationStatusFun(l.replace("module", "")) ? (a.show(), e = n.HoverTool.animationShowWidth) : (a.hide(), e = n.HoverTool.width), i.css("width", e), i.css("height", n.HoverTool.height), (o = i.find(".tool-edit-name")) && o.length > 0 && (0 == c.getSideStatus(l) ? o.is(":hidden") && o.show() : o.is(":hidden") || o.hide()), r
                }, h.constructor.prototype.bindToolBarEvent = function(t) {
                    var e = t.option,
                        o = t.module,
                        n = t.editor,
                        a = t.toolbar;
                    a.addClass("editorHoverShowTool").unbind("mouseover.hoverShowTool").bind("mouseover.hoverShowTool", function(i) { _EditorBase.getEventCtrl().checkEditorEditable(t) && (o.data(E.HoverToolOn, !0).trigger("mouseover"), a.css("display", "block").addClass("J_fkEditor_tool").data(E.ModuleId, e.moduleId)), clearTimeout(n.data(E.HoverToolTimeout)), clearTimeout(n.data(E.EditLineTimeout)), o.mouseenter() }).unbind("mouseleave.hoverShowTool").bind("mouseleave.hoverShowTool", function(t) {
                        (o.find(".fk-editor-vertical-rl").length < 1 || o.find(".fk-editor-vertical-lr").length < 1) && o.trigger("mouseleave"), o.data(E.HoverToolOn, !1)
                    }).off("click.hoverShowTool").on("click.hoverShowTool", function(t) { t.stopPropagation() }), e.simpleTool || a.find(".simpleTextEditTool").not(".tool").off("click.notBtnClick").on("click.notBtnClick", function() { return _EditToolBase.getEventCtrl().animateHideToolSecondPanel(e), _typeof(n.data(E.Range)) != i && l.getEventCtrl().setSelectRange(n.data(E.Range)), !1 });
                    var r = c.checkNestModule(o);
                    r.inSubNav ? a.addClass("showInSubNavPack") : r.inPopupZone && a.addClass("showInPopupZone")
                }, h.constructor.prototype.deleteToolWrapDom = function(e) {
                    var n = e.deleteToolBar,
                        i = e.option;
                    return n ? (setTimeout(function() {
                        var e = i;
                        n.is(":visible") || (t(o).unbind("mouseup.fkTool" + e.moduleId), h.deleteOrHideToolBar(e))
                    }, 1e3), r) : r
                }, h.constructor.prototype.deleteOrHideToolBar = function(o) {
                    var n, a = t("#" + o.css + "-toolBar-" + o.moduleId),
                        r = _EditorBase.getEventCtrl().getModule({ option: o }),
                        l = r.find("." + o.css);
                    if (o.btnModuleEdit && (!(l = r.find("#" + o.moduleId + "FlBtn")) || l.length <= 0) && (l = r.find(".J_floatBtnBox .floatBtn")), _typeof(a) != i && (o.isHideToolBar ? a.hide() : (a.remove(), a = null), l.data(E.HasRemoveUselessChild) || (n = l.attr("style"), l.height(l.height() + "px"), l.data(E.RemoveUselessChildIng, !0), d.getEventCtrl().removeUselessChildStyle(l, l), l.data(E.RemoveUselessChildIng, !1), setTimeout(function() { l.data(E.HasRemoveUselessChild, !0) }, 500), l.attr("style", n))), _typeof(r) != i && !o.simpleTool) {
                        c.setSimpleEditorBlur(r, l), e.getSelection && e.getSelection().removeAllRanges(), fkEditorLine = r.find(".fk-editor-line"), fkEditorLine.hasClass("fk-editor-bd") && (fkEditorLine.addClass("fk-editor-bdNone"), fkEditorLine.removeClass("fk-editor-bd"));
                        var s = l.html();
                        b[l.attr("id")] && b[l.attr("id")] !== s && (c.undoRun(function() {}, {
                            undoSame: !1,
                            redoSame: !1,
                            undoArgs: [l.attr("id"), b[l.attr("id")], o.showEditTipWord, o.editTipWord],
                            redoArgs: [l.attr("id"), s, o.showEditTipWord, o.editTipWord],
                            undoFn: function(e, o, n, i) {
                                var a = t("#" + e);
                                a.html(o), o.length <= 0 && (n ? a.html('<div class="editTip">' + i + "</div>") : a.html(i))
                            },
                            redoFn: function(e, o) {
                                var n = t("#" + e);
                                n.html(o), o.length <= 0 && (showEditTipWord ? n.html('<div class="editTip">' + editTipWord + "</div>") : n.html(editTipWord))
                            }
                        }), b[l.attr("id")] = null), t.trim(l.text()).length <= 0 && (o.showEditTipWord ? l.html('<div class="editTip">' + o.editTipWord + "</div>") : l.html(o.editTipWord))
                    }
                }, h.constructor.prototype.animateHideToolSecondPanel = function(e, o) { var i, l, d, s, c, h, g, v, C, B, E, b, k, S, y, _ = t("#" + e.css + "-toolBar-" + e.moduleId); if (!_.data(ToolAttr.Scrolling)) return o != BtnCommand.BorderRadius && ($borderRadiusPanel = _.find(".tool-borderRadius").find(".borderRadiusPanel"), $borderRadiusPanel.height() > 0 && ($borderRadiusPanel.removeClass("f-borderRadiusPanel-show"), _.find(".tool-borderRadius").find(".slideDiv").removeClass("slideDivBorder"))), o != BtnCommand.Opacity && (l = _.find(".tool-opacity").find(".opacityPanel")).height() > 0 && (l.removeClass("f-opacityPanel-show"), _.find(".tool-opacity").find(".slideDiv").removeClass("slideDivBorder")), o != BtnCommand.ModuleTitleBtn && (c = _.find(".tool-edit-name").find(".J_moduleNamePanel")).height() > 0 && (c.removeClass("f-moduleNamePanel-show"), _.find(".tool-edit-name").find(".slideDiv").removeClass("slideDivModuleName")), o != BtnCommand.DescribePicBtn && (h = _.find(".tool-description").find(".descPanel")).height() > 0 && (h.removeClass("f-descPanel-show"), _.find(".tool-description").find(".slideDiv").removeClass("slideDivDesc")), o != BtnCommand.Border && (d = _.find(".tool-border").find(".borderPanel")).height() > 0 && (d.removeClass("f-borderPanel-show"), _.find(".tool-border").find(".slideDiv").removeClass("slideDivBorder")), o != BtnCommand.Shadow && (s = _.find(".tool-shadow").find(".shadowPanel")).height() > 0 && (s.removeClass("f-shadowPanel-show"), _.find(".tool-shadow").find(".slideDiv").removeClass("slideDivShadow")), o != BtnCommand.GlobalLink && (i = _.find(".tool-link").find("." + e.css + "-linkSlideBar")).height() > 0 && (i.removeClass("linkPanelSlide"), clearTimeout(f), f = setTimeout(function() { _.find(".tool-link").find(".slideDiv").removeClass("slideDivBorder"), i.find(".fkEditorBar").removeClass("fkEditorBarBorder") }, 200)), o != BtnCommand.Formats && (g = _.find(".tool-formats").find("." + e.css + "-formatBar")).height() > 0 && (clearTimeout(a), g.removeClass("formatBarSlideDown"), a = setTimeout(function() { g.parent().find(".fkEditor-tool-iconNew").removeClass("edTriangleOnNew") }, 200)), o != BtnCommand.FontSize && (v = _.find(".tool-fontSize").find("." + e.css + "-formatBar")).height() > 0 && ((C = _.find(".tool-fontSize").find(".selectDiv")).find("span").attr(T, !1), v.removeClass("formatBarSlideDown"), clearTimeout(n), n = setTimeout(function() { C.find("span").html(C.find("span").attr("_value") + "px"), v.parent().find(".fkEditor-tool-iconNew").removeClass("edTriangleOnNew") }, 200)), o != BtnCommand.LineHeight && (B = _.find(".tool-lineHeight").find("." + e.css + "-formatBar")).height() > 0 && ((E = _.find(".tool-lineHeight").find(".selectDiv")).find("span").attr(T, !1), B.removeClass("formatBarSlideDown"), clearTimeout(u), u = setTimeout(function() { E.addClass("selectDivNew"), E.find("span").html(""), B.parent().find(".fkEditor-tool-iconNew").removeClass("edTriangleOnNew") }, 200)), o != BtnCommand.WritingMode && (S = _.find(".tool-writingMode").find("." + e.css + "-formatBar")).height() > 0 && (y = _.find(".tool-writingMode").find(".selectDiv"), S.removeClass("formatBarSlideDown writingModeSlideDown"), clearTimeout(p), p = setTimeout(function() { y.addClass("selectDivNew"), S.parent().find(".fkEditor-tool-iconNew").removeClass("edTriangleOnNew") }, 200)), o != BtnCommand.TextAlign && (b = _.find(".tool-textAlign").find("." + e.css + "-formatBar")).height() > 0 && (k = _.find(".tool-textAlign").find(".selectDiv"), b.removeClass("formatBarSlideDown textAlignSlideDown"), clearTimeout(m), m = setTimeout(function() { k.addClass("selectDivNew"), b.parent().find(".fkEditor-tool-iconNew").removeClass("edTriangleOnNew") }, 200)), t(".J_faiColorPickerAlp").is(":visible") && t(".J_faiColorPickerAlp").slideUp(200), r }, h.constructor.prototype.isShowHoverToolPanel = function(t) { var e = !1; return t.find(".tool-link").find(".fkEditor-linkSlideBar").height() > 0 && (e = !0), t.find(".tool-borderRadius").find(".borderRadiusPanel").height() > 0 && (e = !0), t.find(".tool-opacity").find(".opacityPanel").height() > 0 && (e = !0), t.find(".tool-border").find(".borderPanel").height() > 0 && (e = !0), t.find(".tool-shadow").find(".shadowPanel").height() > 0 && (e = !0), t.find(".setRadiusBar").data("radiusSliding") && (e = !0), t.find(".tool-edit-name").find(".J_moduleNamePanel").height() > 0 && (e = !0), t.find(".tool-description").find(".descPanel").height() > 0 && (e = !0), e }, h.constructor.prototype.bindSliderInputEvent = function(e, o) {
                    var n, i;
                    return i = function(e) {
                        var o, n, i;

                        function a(t, e) { e ? t.attr("contenteditable", e).addClass("J_contentEditable contentEditable") : t.removeAttr("contenteditable").removeClass("J_contentEditable contentEditable") }

                        function r(t, e, o) { t.html(e + (o || "")) }

                        function d(t) { return parseInt(t.html().replace(e.per, "") || 0) || 0 }

                        function c(t, e) { t._value = d(t), t._length = t.html().length, t._event = e }
                        return o = { onChange: function() {}, maxVal: 100, per: "%", minVal: 0, maxLength: 3 }, e = t.extend({}, o, e), (n = function() { this.cache = [] }).prototype.add = function(t, e, o) {
                            for (var n, a = this, r = 0; n = e[r++];) ! function(e) {
                                var n = e.split(":");
                                a.cache.push(function() { var e = n.shift(); return n.unshift(t), n.push(o), i[e].apply(t, n) })
                            }(n)
                        }, n.prototype.start = function() { for (var t, e = 0; t = this.cache[e++];) { var o = t(); if (o) return o } }, i = { isNumberKey: function(t, e) { if (!s.isNumberKey(t._event)) return e }, maxLength: function(t, e, o) { if (t._length >= e) return o }, maxVal: function(t, e, o) { if (t._value > e) return r(t, e), l.getEventCtrl().popCursorLastDiv(t), t.focus(), o }, minVal: function(t, e, o) { if (t._value < e) return o }, isEditable: function(t, e) { if (t.hasClass("J_contentEditable contentEditable")) return e } }, {
                            click: function(t, e) {
                                var o = new n;
                                o.add(t, ["isEditable"], "可编辑状态中");
                                var i = o.start();
                                if (i) return i;
                                a(t, !0), t.html(d(t)), l.getEventCtrl().setNodeRange(t[0]), s.isMozilla() && t.focus()
                            },
                            keypress: function(t, o) { var i = new n; if (c(t, o), i.add(t, ["isNumberKey"], "请输入数字"), i.add(t, ["maxLength:" + e.maxLength], "数字已达最大长度"), i.start()) return !1 },
                            keyup: function(t, o) {
                                var i = new n;
                                c(t, o), i.add(t, ["maxVal:" + e.maxVal], "超过最大值");
                                var a = i.start();
                                if (function(t, o) {
                                        var i = new n;
                                        c(t, o), i.add(t, ["minVal:" + e.minVal], "小于最小值");
                                        var a = i.start(),
                                            r = d(t);
                                        a && (r = e.minVal), e.onChange(r)
                                    }(t, o), a) return a
                            },
                            blur: function(t, o) {
                                var i = new n;
                                c(t, o), i.add(t, ["minVal:" + e.minVal], "小于最小值");
                                var l = i.start(),
                                    s = d(t);
                                l && (s = e.minVal), r(t, s, e.per), a(t, !1)
                            }
                        }
                    }, n = function() { e.off(".sliderInput").on(["click", " keypress", " keyup", " blur", ""].join(".sliderInput"), function(e) { return e.stopPropagation(), i(o)[e.type](t(this), e) }) }, e.length && n(), e
                }, h.constructor.prototype.editToolBarMask = function(e) {
                    var o = { id: e, useClass: !0, leftClass: "fk-dialog-hidden-mask", rightClass: "fk-dialog-hidden-mask", topClass: "fk-dialog-hidden-mask", bottomClass: "fk-dialog-hidden-mask", centerClass: "fk-dialog-center-mask", extFn: [{ name: "click.dialogmask", fn: function() { h.removeToolBarDialog(e) } }] };
                    c.addModuleMask(o);
                    var n = t("#module" + e),
                        i = c.checkNestModule(n),
                        a = c.hasPopupModuleOpen();
                    i.inPopupZone && a && t(".fk-dialog-hidden-mask").addClass("fk-dialog-hidden-mask_popupZone"), i.inSubNav && s.top._subNavPackEdit && t(".fk-dialog-hidden-mask").addClass("fk-dialog-hidden-mask-insubNav"), t("#g_main").off("mousewheel.disabledScroll").on("mousewheel.disabledScroll", function(t) { setTimeout(function() { c.addModuleMask(o) }, 200) })
                }, h.constructor.prototype.removeToolBarDialog = function(e, o) { var n = s.top.$("#module" + e);!c.checkNestModule(n).inPopupZone && c.hasPopupModuleOpen() || (c.checkSimpleTextHideTool(), t(".moduleMaskContainer").length > 0 && c.removeModuleMask(), t("#g_main").off("mousewheel.disabledScroll")) }, h.constructor.prototype.hideToolBarMask = function() { t(".fk-dialog-hidden-mask").length > 0 && c.removeModuleMask() }, h.constructor.prototype.hideHoverTool = function(e) {
                    var o = e.option,
                        n = e.editor,
                        i = t("#fkEditor-toolBar-" + o.moduleId);
                    n.data(E.SimpleTextEdit) || _EditToolBase.getEventCtrl().isShowHoverToolPanel(i) || (s.top.$(".popupBg").length <= 0 ? _EditToolBase.getEventCtrl().deleteOrHideToolBar(o) : (o.isHideToolBar = !0, _EditToolBase.getEventCtrl().deleteOrHideToolBar(o), o.isHideToolBar = !1))
                }, h.constructor.prototype.buildSimpleTip = function(e, o) {
                    var n = e.toolbar;
                    o.off("mouseenter.tips").on("mouseenter.tips", function() { t(this).attr("data-title-tip") && (n.find(".setRadiusBar").data("radiusSliding") || (t(this).addClass("f-button-tip-vertical"), c.getTopHeight() + 48 > t(this).offset().top ? t(this).removeClass("f-button-top").addClass("f-button-bottom") : t(this).addClass("f-button-top").removeClass("f-button-bottom"))) }).off("mouseleave.tips").on("mouseleave.tips", function() { t(this).removeClass("f-button-tip-vertical").removeClass("f-button-bottom").removeClass("f-button-tip") })
                }, h.constructor.prototype.hideSimpleTip = function(t) { t.removeClass("f-button-tip-vertical").removeClass("f-button-bottom").removeClass("f-button-tip") }, h.constructor.prototype.editToolLogDog = function(t) {
                    var e = t.module,
                        o = t.command;
                    if (e.hasClass("formStyle81")) switch (o) {
                        case BtnCommand.EditContent:
                            c.logDog(200193, 1), c.inPopupZoneLog(e, 200304, 3);
                            break;
                        case BtnCommand.BtnModuleStyle:
                            c.logDog(200193, 2);
                            break;
                        case BtnCommand.Animation:
                            c.logDog(200193, 3);
                            break;
                        case BtnCommand.GlobalLink:
                            c.logDog(200193, 4);
                            break;
                        case BtnCommand.Opacity:
                            c.logDog(200193, 5);
                            break;
                        case BtnCommand.Border:
                            c.logDog(200193, 6);
                            break;
                        case BtnCommand.Shadow:
                            c.logDog(200193, 7);
                            break;
                        case BtnCommand.Radius:
                            c.logDog(200193, 8);
                            break;
                        case BtnCommand.Delete:
                            c.logDog(200193, 9);
                            break;
                        case BtnCommand.Colors:
                            c.logDog(200193, 10);
                            break;
                        case BtnCommand.Bold:
                            c.logDog(200193, 11);
                            break;
                        case BtnCommand.Underline:
                            c.logDog(200193, 12);
                            break;
                        case BtnCommand.Formats:
                            c.logDog(200193, 13);
                            break;
                        case BtnCommand.FontSize:
                            c.logDog(200193, 14);
                            break;
                        case BtnCommand.Dblclick:
                            c.logDog(200193, 15)
                    } else if (e.hasClass("formStyle86")) switch (o) {
                        case BtnCommand.EditContent:
                            c.logDog(200077, 1), c.inPopupZoneLog(e, 200304, 1);
                            break;
                        case BtnCommand.Animation:
                            c.logDog(200077, 2);
                            break;
                        case BtnCommand.GlobalLink:
                            c.logDog(200077, 3);
                            break;
                        case BtnCommand.Delete:
                            c.logDog(200077, 4);
                            break;
                        case BtnCommand.Colors:
                            c.logDog(200077, 5);
                            break;
                        case BtnCommand.Bold:
                            c.logDog(200077, 6);
                            break;
                        case BtnCommand.Italic:
                            c.logDog(200077, 7);
                            break;
                        case BtnCommand.Underline:
                            c.logDog(200077, 8);
                            break;
                        case BtnCommand.Formats:
                            c.logDog(200077, 9);
                            break;
                        case BtnCommand.FontSize:
                            c.logDog(200077, 10);
                            break;
                        case BtnCommand.LineHeight:
                            c.logDog(200077, 14);
                            break;
                        case BtnCommand.TextAlign:
                            c.logDog(200077, 17);
                            break;
                        case BtnCommand.JustifyLeft:
                            c.logDog(200077, 18);
                            break;
                        case BtnCommand.JustifyCenter:
                            c.logDog(200077, 19);
                            break;
                        case BtnCommand.JustifyRight:
                            c.logDog(200077, 20);
                            break;
                        case BtnCommand.SingleClick:
                            c.logDog(200077, 21);
                            break;
                        case BtnCommand.Dblclick:
                            c.logDog(200077, 22);
                            break;
                        case BtnCommand.Linkcreator:
                            c.logDog(200077, 23);
                            break;
                        case BtnCommand.DeleteLink:
                            c.logDog(200077, 24);
                            break;
                        case BtnCommand.InputFontSize:
                            c.logDog(200077, 25);
                            break;
                        case BtnCommand.InputLineHeight:
                            c.logDog(200077, 26);
                            break;
                        case BtnCommand.ChooseFormats:
                            c.logDog(200077, 27);
                            break;
                        case BtnCommand.ChooseLineHeight:
                            c.logDog(200077, 28);
                            break;
                        case BtnCommand.JustifyFull:
                            c.logDog(200077, 30);
                            break;
                        case BtnCommand.Horizontal:
                            c.logDog(200077, 31);
                            break;
                        case BtnCommand.VerticalToLeft:
                            c.logDog(200077, 32);
                            break;
                        case BtnCommand.VerticalToRight:
                            c.logDog(200077, 33)
                    } else if (e.hasClass("corpTitle")) switch (o) {
                        case BtnCommand.EditContent:
                            c.logDog(200271, 1);
                            break;
                        case BtnCommand.GlobalLink:
                            c.logDog(200271, 2);
                            break;
                        case BtnCommand.EditPositionFixed:
                            c.logDog(200271, 3);
                            break;
                        case BtnCommand.EditLogoDisplay:
                            s.top.$("#logo").is(":visible") ? c.logDog(200271, 4) : c.logDog(200271, 5);
                            break;
                        case BtnCommand.Delete:
                            c.logDog(200271, 6);
                            break;
                        case BtnCommand.Dblclick:
                            c.logDog(200271, 7);
                            break;
                        case BtnCommand.Colors:
                            c.logDog(200271, 8);
                            break;
                        case BtnCommand.Bold:
                            c.logDog(200271, 9);
                            break;
                        case BtnCommand.Italic:
                            c.logDog(200271, 10);
                            break;
                        case BtnCommand.Underline:
                            c.logDog(200271, 11);
                            break;
                        case BtnCommand.Formats:
                            c.logDog(200271, 12);
                            break;
                        case BtnCommand.LineHeight:
                            c.logDog(200271, 13);
                            break;
                        case BtnCommand.TextAlign:
                            c.logDog(200271, 14)
                    } else if (e.hasClass("formStyle79")) switch (o) {
                        case BtnCommand.EditPhotoBtn:
                            c.logDog(200194, 2);
                            break;
                        case BtnCommand.ImgEffectBtn:
                            c.logDog(200194, 3);
                            break;
                        case BtnCommand.Animation:
                            c.logDog(200194, 5);
                            break;
                        case BtnCommand.PhotoShapeBtn:
                            c.logDog(200194, 4);
                            break;
                        case BtnCommand.Opacity:
                            c.logDog(200194, 7);
                            break;
                        case BtnCommand.SimpleLinkBtn:
                            c.logDog(200194, 6);
                            break;
                        case BtnCommand.Delete:
                            c.logDog(200194, 8);
                            break;
                        case BtnCommand.Dblclick:
                            c.logDog(200194, 9)
                    }
                }
            })
        }, this.getUICtrl = function() {
            return a || (a = new function() {
                this.constructor.prototype.creatButtonsList = function(t) {
                    t.option;
                    var e, o = t.buttons,
                        n = t.toolbar.find(".simpleTextEditTool"),
                        i = [],
                        a = "moduleName";
                    if (!(n.children().length > 0)) { for (var l = 0; l < o.length; l++) e = o[l], t.btn = e, "EditColorBtn" == e[a] && i.push(_EditColorBtn.getUICtrl().createBtnToolDom(t).join("")), "EditBoldBtn" == e[a] && i.push(_EditBoldBtn.getUICtrl().createBtnToolDom(t).join("")), "EditItalicBtn" == e[a] && i.push(_EditItalicBtn.getUICtrl().createBtnToolDom(t).join("")), "EditUnderlineBtn" == e[a] && i.push(_EditUnderlineBtn.getUICtrl().createBtnToolDom(t).join("")), "EditFormatsBtn" == e[a] && i.push(_EditFormatsBtn.getUICtrl().createBtnToolDom(t).join("")), "EditFontSizeBtn" == e[a] && i.push(_EditFontSizeBtn.getUICtrl().createBtnToolDom(t).join("")), "EditWritingModeBtn" == e[a] && i.push(_EditWritingModeBtn.getUICtrl().createBtnToolDom(t).join("")), "EditLineHeightBtn" == e[a] && i.push(_EditLineHeightBtn.getUICtrl().createBtnToolDom(t).join("")), "EditTextAlignBtn" == e[a] && i.push(_EditTextAlignBtn.getUICtrl().createBtnToolDom(t).join("")), "EditLinkBtn" == e[a] && i.push(_EditLinkBtn.getUICtrl().createBtnToolDom(t).join("")), "EditRemoveFormatBtn" == e[a] && i.push(_EditRemoveFormatBtn.getUICtrl().createBtnToolDom(t).join("")), "EditSeperatorBtn" == e[a] && i.push(_EditSeperatorBtn.getUICtrl().createHoverBtnToolDom().join("")), "EditBreakLineBtn" == e[a] && i.push(_EditBreakLineBtn.getUICtrl().createHoverBtnToolDom().join("")), _EditBreakLineBtn; return n.append(i.join("")), r }
                }, this.constructor.prototype.creatHoverButtonsList = function(t) {
                    var e, o, n = t.option,
                        i = t.hoverShowButtons,
                        a = t.toolbar.find(".simpleTextHoverTool"),
                        l = [],
                        d = "moduleName",
                        s = n.tipTitle;
                    if (a.children().length > 0) return r;
                    for (var c = 0; c < i.length; c++) e = i[c], t.btn = e, "EditContentBtn" == e[d] && l.push(_EditContentBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditFixedPositionBtn" == e[d] && l.push(_EditFixedPositionBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditLogoDisplayBtn" == e[d] && l.push(_EditLogoDisplayBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditAnimationBtn" == e[d] && l.push(_EditAnimationBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditBtnModuleStyleBtn" == e[d] && l.push(_EditBtnModuleStyleBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditPhotoBtn" == e[d] && l.push(_EditPhotoBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditImgEffectBtn" == e[d] && l.push(_EditImgEffectBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditPhotoShapeBtn" == e[d] && l.push(_EditPhotoShapeBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditSimpleLinkBtn" == e[d] && l.push(_EditSimpleLinkBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditModuleTitleBtn" == e[d] && l.push(_EditModuleTitleBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditDescribePicBtn" == e[d] && l.push(_EditDescribePicBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditFixedBtn" == e[d] && l.push(_EditFixedBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditGlobalLinkBtn" == e[d] && l.push(_EditGlobalLinkBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditBorderRadiusBtn" == e[d] && l.push(_EditBorderRadiusBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditOpacityBtn" == e[d] && l.push(_EditOpacityBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditBorderBtn" == e[d] && l.push(_EditBorderBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditShadowBtn" == e[d] && l.push(_EditShadowBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditDeleteBtn" == e[d] && l.push(_EditDeleteBtn.getUICtrl().createHoverBtnToolDom(t).join("")), "EditSeperatorBtn" == e[d] && l.push(_EditSeperatorBtn.getUICtrl().createHoverBtnToolDom().join(""));
                    return a.append(l.join("")), s && (o = a.find(".tool .editToolIcon"), r.getEventCtrl().buildSimpleTip(t, o)), r
                }, this.constructor.prototype.buildToolWrapDom = function(e) {
                    var o, n, i, a = e.option,
                        l = (e.editor, []),
                        d = 6;
                    if (!a.moduleId || a.moduleId <= 0) return console.log("buildToolWrapDom moduleId err, option.moduleId = " + a.moduleId), n;
                    n = t("#" + a.css + "-toolBar-" + a.moduleId), i = c.checkNestModule(t("#" + a.moduleId)).inPopupZone ? t("body") : t("#web"), o = t(".J_fkSingleTool");
                    for (var s = 0; s < o.length; s++) o = o.eq(s), r.getEventCtrl().deleteToolWrapDom({ deleteToolbar: o, option: o.data(E.Option) });
                    return a.btnModuleEdit && (d += 6), l.push('<div id="' + a.css + "-toolBar-" + a.moduleId + '" role="toolbar" class="J_fkSingleTool ' + a.css + " " + a.toolExtClasses + " " + a.css + "-tool " + a.css + 'DefHeight" style="width:' + a.toolBarWidth + ';">'), l.push('<div style="display:none;"><input maxlength="255" id="simpleTextLinkInputVal-' + a.moduleId + '"></input></div>'), l.push('<div class="simpleTextHoverTool"></div>'), l.push('<div class="simpleTextEditTool" style="display:none;"></div>'), l.push('<div class="simpleTextCover f-simpleTextCover" style="height:' + d + 'px;"></div>'), l.push("</div>"), i.append(l.join("")), (n = t("#" + a.css + "-toolBar-" + a.moduleId)).data(E.Option, a), n
                }
            })
        }
    };
    _EditorBase = new function() {
        var e, n, a = this;
        this.getEventCtrl = function() {
            return e || (e = new function() {
                var e, n, r, u = this;
                u.constructor.prototype.getModule = function(e) { var o = e.option; if ("null" != o.moduleId && 0 != o.moduleId) return t("#" + o.moduleId) }, u.constructor.prototype.stopBannerJump = function(e) {
                    var o = e.clickEvent,
                        n = t(o.target).parentsUntil("#bannerV2", ".J_bannerItem");
                    n.length && (href = n.attr("href"), target = n.attr("target"), n.attr("href", "javascript:void(0);").attr("target", ""), setTimeout(function() { n.attr("href", href).attr("target", target) }, 0))
                }, u.constructor.prototype.logEditorSingleClick = function(t) {
                    var e = t.editor,
                        o = t.module;
                    clearTimeout(r), r = setTimeout(function() { "true" != e.attr(T) && _EditToolBase.getEventCtrl().editToolLogDog({ module: o, command: BtnCommand.SingleClick }) }, 300)
                }, u.constructor.prototype.setEidtorSelectedRule = function(t) {
                    var e = t.editor,
                        o = t.command,
                        i = !1;
                    e.text().length <= 0 || (l.getEventCtrl().getSelectText(e, !0).length <= 0 && (e.data(E.HasRefreshClick) ? (l.getEventCtrl().setNodeRange(e[0]), i = !0) : o != BtnCommand.Colors && o != BtnCommand.FontSize && o != BtnCommand.LineHeight && (l.getEventCtrl().setSelectRange(e.data(E.Range)), i = !0)), clearTimeout(n), n = setTimeout(function() {
                        var t = e.data(E.SignClassNum),
                            o = e.find("." + e.data(E.EditSignClass) + t);
                        if (e.data(E.HasRefreshClick) || o.length <= 0) {
                            var n = l.getEventCtrl().getSelectText(e, !0).length > 0;
                            e.data(E.HasSelectText, n), n && l.getEventCtrl().setTagStyle({ styleName: "xxxx", styleValue: "", editor: e, notCreateNewNode: !1 })
                        }
                        i && l.getEventCtrl().getSelectText(e, !1)
                    }, 100))
                }, u.constructor.prototype.bindAllEvent = function(e) {
                    var n, i = e.option,
                        a = e.module,
                        r = e.editor,
                        m = (e.fkEditorWrap, "mouseup.fkTool" + i.moduleId);
                    a.unbind("mouseenter.fkModuleEvent").bind("mouseenter.fkModuleEvent", function(o) {
                        if (t(this).is(":hover"), (!c.checkNestModule(a).inSubNav || s.top._subNavPackEdit) && (!c.checkNestModule(a).inPopupZone || s.top._popupZone && s.top._popupZone.pZone && s.top._popupZone.pZone.editing) && !a.hasClass("ui-resizable-resizing")) {
                            clearTimeout(r.data(E.EditLineTimeout));
                            var n, l, u = t(this).find(".fk-editor-line"),
                                m = t("#" + i.css + "-toolBar-" + i.moduleId);
                            u.hasClass("fk-editor-bdNone") && (u.addClass("fk-editor-bd"), u.removeClass("fk-editor-bdNone")), clearTimeout(r.data(E.HoverToolTimeout)), e.toolbar = m, m.length < 1 && (n = _EditBtnBase.getEventCtrl().getButtonsData(e), e.buttons = n, l = _EditBtnBase.getEventCtrl().getHoverShowButtons(e), e.hoverShowButtons = l, m = _EditToolBase.getUICtrl().buildToolWrapDom(e), e.toolbar = m, i.EditRadiusBtn && _EditRadiusBtn.getUICtrl().createEditRadiusBtnDom(e), _EditToolBase.getUICtrl().creatHoverButtonsList(e), _EditToolBase.getUICtrl().creatButtonsList(e), d.getEventCtrl().setUnselectable(e), _EditToolBase.getEventCtrl().bindToolAndEditorCreatedEvent(e), _EditToolBase.getEventCtrl().showToolBar(e)), r.data(E.SimpleTextEdit) || (_EditToolBase.getEventCtrl().checkEditItemDisplay(e), m.find(".simpleTextEditTool").hide(), m.find(".simpleTextHoverTool").show()), c.createSimpleTextAutoWidthBtn(t(this))
                        }
                    }).unbind("mouseleave.fkModuleEvent").bind("mouseleave.fkModuleEvent", function(o) {
                        var n = t(this).find(".fk-editor-line");
                        u.checkEditorEditable(e) || r.data(E.SimpleTextEdit) || r.data(E.EditLineTimeout, setTimeout(function() { e.fkEditorLine = n, _EditorBase.getEventCtrl().hideEditLine(e) }, 200)), r.data(E.SimpleTextEdit) || r.data(E.HoverToolTimeout, setTimeout(function() { _EditToolBase.getEventCtrl().hideHoverTool(e) }, 200))
                    }).unbind("dblclick.fkModuleEvent").bind("dblclick.fkModuleEvent", function(e) {
                        if (!c.checkNestModule(a).inSubNav || s.top._subNavPackEdit) {
                            var o = c.hasPopupModuleOpen();
                            (!c.checkNestModule(a).inPopupZone || o && o.editing) && ((n = t("#" + i.css + "-toolBar-" + i.moduleId)).find(".simpleTextHoverTool").is(":visible") && (r.data(E.TriggerClick, !0), n.find(".tool-editContentNew .editToolIcon").trigger("click")), _EditToolBase.getEventCtrl().editToolLogDog({ module: a, command: BtnCommand.Dblclick }))
                        }
                    }), f && t(o).unbind(m).bind(m, function(e) { 0 == e.button && a.data(E.Mousemove) && t(".fk-popupWindowVT").length < 1 && l.getEventCtrl().getSelectText(r, !1) })
                }, u.constructor.prototype.bindSimpleToolAllEvent = function(e) {
                    var o = e.option,
                        n = e.module,
                        i = e.editor;
                    n.unbind("mouseenter.fkModuleEvent").bind("mouseenter.fkModuleEvent", function(a) {
                        if (!c.checkNestModule(n).inSubNav || s.top._subNavPackEdit) {
                            var r, l = t("#" + o.css + "-toolBar-" + o.moduleId);
                            clearTimeout(i.data(E.HoverToolTimeout)), e.toolbar = l, l.length < 1 ? (r = _EditBtnBase.getEventCtrl().getHoverShowButtons(e), e.hoverShowButtons = r, l = _EditToolBase.getUICtrl().buildToolWrapDom(e), e.toolbar = l, o.EditRadiusBtn && _EditRadiusBtn.getUICtrl().createEditRadiusBtnDom(e), _EditToolBase.getUICtrl().creatHoverButtonsList(e), _EditToolBase.getEventCtrl().bindSimpleToolCreatedEvent(e), _EditToolBase.getEventCtrl().showToolBar(e)) : _EditToolBase.getEventCtrl().showToolBar(e)
                        }
                    }).unbind("mouseleave.fkModuleEvent").bind("mouseleave.fkModuleEvent", function(t) { i.data(E.SimpleTextEdit) || i.data(E.HoverToolTimeout, setTimeout(function() { _EditToolBase.getEventCtrl().hideHoverTool(e) }, 200)) }).unbind("dblclick.fkModuleEvent").bind("dblclick.fkModuleEvent", function(t) { c.checkNestModule(n).inSubNav && !s.top._subNavPackEdit || (o.dblclickFun && "" != o.dblclickFun && s.fkEval(o.dblclickFun), _EditToolBase.getEventCtrl().editToolLogDog({ module: n, command: BtnCommand.Dblclick })) })
                }, u.constructor.prototype.checkEditorEditable = function(t) { var e = t.editor.attr(T); return _typeof(e) != i && 0 != e && "false" != e }, u.constructor.prototype.backTextSelected = function(t) {
                    var e = t.data(E.SignClassNum),
                        o = t.find("." + t.data(E.EditSignClass) + e);
                    return t.data(E.HasRefreshClick) || l.getEventCtrl().setNodeRange(o[0]), a
                }, u.constructor.prototype.refeshEidtorHeight = function(t) {
                    var e = t.option,
                        o = t.editor,
                        n = t.module;
                    if (!o.hasClass("fk-editor-vertical-rl") && !o.hasClass("fk-editor-vertical-lr")) {
                        var i = o[0].clientHeight,
                            a = o[0].scrollHeight;
                        o.data(E.PreScrollHeight) || o.data(E.PreScrollHeight, a), o.data(E.ChangeCount) > e.changeCount && (a > i || a != o.data(E.PreScrollHeight)) && !o.data(E.ScrollChangeChecking) && (o.data(E.PreScrollHeight, a), o.data(E.ScrollChangeChecking, !0), o.css("height", a + "px"), n.css("height", a + "px"), n.attr("_autoheight", 0), n.trigger("mouseover"), setTimeout(function() { o.data(E.ScrollChangeChecking, !1) }, 50)), u.setEditorAutoHeight(n.attr("id"))
                    }
                }, u.constructor.prototype.setEditorAutoHeight = function(o) { if (!(t("#fkEditor-" + o).length > 0 && (t("#fkEditor-" + o).hasClass("fk-editor-vertical-rl") || t("#fkEditor-" + o).hasClass("fk-editor-vertical-lr")))) return clearTimeout(e), e = setTimeout(function() { c.autoModuleHeight(o.replace("module", "")) }, 200), a }, u.constructor.prototype.hideEditLine = function(e) {
                    var o = e.option,
                        n = e.editor,
                        i = e.fkEditorLine,
                        a = t("#fkEditor-toolBar-" + o.moduleId);
                    n.data(E.SimpleTextEdit) || a.find(".tool-link").find(".linkPanel").height() > 0 || i.hasClass("fk-editor-bd") && (i.addClass("fk-editor-bdNone"), i.removeClass("fk-editor-bd"))
                }, u.constructor.prototype.simpleTextFormatPasteData = function(t, e) { d.getEventCtrl().filterPasteData(t), d.getEventCtrl().textPositionCorrect(t) }
            })
        }, this.getUICtrl = function() { return n || (n = new function() {}) }
    };
    _EditSeperatorBtn = new function() {
        var t;
        this.getEventCtrl = function() {}, this.getUICtrl = function() { return t || (t = new function() { this.constructor.prototype.createHoverBtnToolDom = function() { var t = []; return t.push('<div class="seperatorNew"></div>'), t } }) }
    };
    _EditBreakLineBtn = new function() {
        var t;
        this.getEventCtrl = function() {}, this.getUICtrl = function() { return t || (t = new function() { this.constructor.prototype.createHoverBtnToolDom = function() { var t = []; return t.push('<div style="clear:both;"></div>'), t } }) }
    };
    _EditAnimationBtn = new function() {
        var t;
        this.getEventCtrl = function() {}, this.getUICtrl = function() { return t || (t = new function() { this.constructor.prototype.createHoverBtnToolDom = function(t) { return _EditBtnBase.getUICtrl().createHoverBtnToolDom(t) } }) }
    };
    _EditBtnModuleStyleBtn = new function() {
        var t;
        this.getEventCtrl = function() {}, this.getUICtrl = function() { return t || (t = new function() { this.constructor.prototype.createHoverBtnToolDom = function(t) { var e, o = t.btn; return t.btnContent = '<a unselectable class="editToolIcon f-editToolIcon" command ="' + o.command + '">' + o.title + "</a>", e = _EditBtnBase.getUICtrl().createHoverBtnToolDom(t), t.btnContent = null, e } }) }
    };
    _EditPhotoBtn = new function() {
        var t;
        this.getEventCtrl = function() {}, this.getUICtrl = function() {
            return t || (t = new function() {
                var t = this;
                t.constructor.prototype.setEditPhotoText = function(t) {
                    t.btn;
                    var e = t.option.moduleId,
                        o = t.module;
                    return "logo" == e ? 1 == s.top.$("#logo").attr("_defaultlogo") ? "添加logo" : "编辑logo" : o.data("imgHoverEft") && o.data("imgHoverEft").isInit ? "添加图片" : "编辑图片"
                }, t.constructor.prototype.createHoverBtnToolDom = function(e) {
                    var o, n = e.btn,
                        i = n.title;
                    return i = t.setEditPhotoText(e), e.btnContent = '<a unselectable class="editToolIcon f-editToolIcon" command ="' + n.command + '">' + i + "</a>", o = _EditBtnBase.getUICtrl().createHoverBtnToolDom(e), e.btnContent = null, o
                }
            })
        }
    };
    _EditImgEffectBtn = new function() {
        var t;
        this.getEventCtrl = function() {}, this.getUICtrl = function() { return t || (t = new function() { this.constructor.prototype.createHoverBtnToolDom = function(t) { return _EditBtnBase.getUICtrl().createHoverBtnToolDom(t) } }) }
    };
    _EditPhotoShapeBtn = new function() {
        var t;
        this.getEventCtrl = function() {}, this.getUICtrl = function() { return t || (t = new function() { this.constructor.prototype.createHoverBtnToolDom = function(t) { return _EditBtnBase.getUICtrl().createHoverBtnToolDom(t) } }) }
    };
    _EditSimpleLinkBtn = new function() {
        var t;
        this.getEventCtrl = function() {}, this.getUICtrl = function() { return t || (t = new function() { this.constructor.prototype.createHoverBtnToolDom = function(t) { return _EditBtnBase.getUICtrl().createHoverBtnToolDom(t) } }) }
    };
    _EditModuleTitleBtn = new function() {
        var t, e;
        this._panelHeight = 47, this.getEventCtrl = function() {
            return t || (t = new function() {
                this.constructor.prototype.bindModuleTitlePanelEvent = function(t) {
                    var e = t.option,
                        o = (t.module, t.editor, t.toolbar);
                    e.moduleId.replace("module", ""), o.find(".tool-edit-name").find("." + e.css + "-moduleNameSlideBar").find(".J_moduleNamePanel").find(".J_module-name-input").off("keyup.moduleTitleSlideBar change.moduleTitleSlideBar").on("keyup.moduleTitleSlideBar change.moduleTitleSlideBar", function() { e.moduleTitleFun && "" != e.moduleTitleFun && s.fkEval(e.moduleTitleFun) })
                }, this.constructor.prototype.showModuleTitlePanel = function(t) {
                    var e = t.option,
                        o = t.toolbar.find(".tool-edit-name"),
                        n = e.moduleId.replace("module", ""),
                        i = o.find("." + e.css + "-moduleNameSlideBar").find(".J_moduleNamePanel");
                    i.height() > 0 ? _EditToolBase.getEventCtrl().animateHideToolSecondPanel(e, BtnCommand.ModuleTitleBtn) : (i.addClass("f-moduleNamePanel-show"), o.find(".slideDiv").addClass("slideDivModuleName"), _EditToolBase.getEventCtrl().editToolBarMask(n))
                }
            })
        }, this.getUICtrl = function() {
            return e || (e = new function() {
                var t = this;
                t.constructor.prototype.createHoverBtnToolDom = function(e) {
                    var o = e.option,
                        n = e.btn,
                        i = [],
                        a = "";
                    return o.tipTitle && (a = ' data-title-tip="' + n.title + '" '), i.push('<div class="f-module-name-div J_moduleNameDiv slideDiv" unselectable>'), i.push("</div>"), i.push('<a unselectable class="f-editToolIcon editToolIcon ' + n.command + '-tool-icon" command ="' + n.command + '" ' + a + " ></a>"), i.push('<div class=" ' + o.css + "-moduleNameSlideBar f-" + o.css + '-moduleNameSlideBar ">'), i.push('<div class="J_moduleNamePanel f-fkEditorBar fkEditorBar">'), i.push(t.createModuleTitlePanelDom(o)), i.push("</div>"), i.push("</div>"), i.push("</div>"), e.btnContent = i.join(""), i = _EditBtnBase.getUICtrl().createHoverBtnToolDom(e), e.btnContent = null, i
                }, t.constructor.prototype.createModuleTitlePanelDom = function(t) { return '<div class="f-descItem"><div class="f-descTip">模块标题：</div><div class="f-descSet"><input class="f-module-name-input J_module-name-input"  maxlength="50"/></div></div>' }
            })
        }
    };
    _EditDescribePicBtn = new function() {
        var e, o;
        this._panelHeight = 47, this.getEventCtrl = function() {
            return e || (e = new function() {
                this.constructor.prototype.bindDescribePicPanelEvent = function(e) {
                    var o = e.option,
                        n = (e.module, e.editor, e.toolbar),
                        i = (o.moduleId.replace("module", ""), n.find(".tool-description").find("." + o.css + "-describePicSlideBar").find(".descPanel")),
                        a = "";
                    i.find("#logoDescription").off("keyup.describePicSlideBar change.describePicSlideBar").on("keyup.describePicSlideBar change.describePicSlideBar", function() { o.describePicFun && "" != o.describePicFun && s.fkEval(o.describePicFun) }).off(".undoLogo").on("focus.undoLogo", function() { a = t(this).val() }).on("blur.undoLogo", function() { c.undoRun(function() {}, { type: "logo", detail: "logoDescription", undoSame: !1, redoSame: !1, undoArgs: [a], redoArgs: [t(this).val()], undoFn: s.top._undo.logoDiscUndo, redoFn: s.top._undo.logoDiscUndo }) })
                }, this.constructor.prototype.showDescribePicPanel = function(t) {
                    var e = t.option,
                        o = t.toolbar.find(".tool-description"),
                        n = e.moduleId.replace("module", ""),
                        i = o.find("." + e.css + "-describePicSlideBar").find(".descPanel");
                    i.height() > 0 ? _EditToolBase.getEventCtrl().animateHideToolSecondPanel(e, BtnCommand.DescribePicBtn) : (i.addClass("f-descPanel-show"), o.find(".slideDiv").addClass("slideDivDesc"), _EditToolBase.getEventCtrl().editToolBarMask(n))
                }
            })
        }, this.getUICtrl = function() {
            return o || (o = new function() {
                var t = this;
                t.constructor.prototype.createHoverBtnToolDom = function(e) {
                    var o = e.option,
                        n = e.btn,
                        i = [],
                        a = "";
                    return o.tipTitle && (a = ' data-title-tip="' + n.title + '" '), i.push('<div class="describeDiv slideDiv" unselectable>'), i.push("</div>"), i.push('<a unselectable class="f-editToolIcon editToolIcon ' + n.command + '-tool-icon" command ="' + n.command + '" ' + a + " ></a>"), i.push('<div class=" ' + o.css + "-describePicSlideBar f-" + o.css + '-describePicSlideBar ">'), i.push('<div class="f-descPanel f-fkEditorBar descPanel fkEditorBar">'), i.push(t.createDescribePicPanelDom(o)), i.push("</div>"), i.push("</div>"), i.push("</div>"), e.btnContent = i.join(""), i = _EditBtnBase.getUICtrl().createHoverBtnToolDom(e), e.btnContent = null, i
                }, t.constructor.prototype.createDescribePicPanelDom = function(t) { var e = []; return e.push('<div class="f-descItem">'), e.push('<div class="f-descTip">输入图片描述文字：</div>'), e.push('<div class="f-descSet"><input id="logoDescription" class="f-logoDesPic"  maxlength="50"/></div>'), e.push("</div>"), e.join("") }
            })
        }
    };
    _EditFixedBtn = new function() {
        var t, e;
        this.getEventCtrl = function() {
            return t || (t = new function(t) {
                this.constructor.prototype.setFixedLogoBtnTitle = function(t) {
                    var e = t.btn,
                        o = t.option,
                        n = (t.toolbar, o.tipTitle),
                        i = "";
                    s.top._logoPositionFixTop ? (e.addClass("unfixed"), i = "固定") : (e.removeClass("unfixed"), i = "不固定"), n ? e.attr("data-title-tip", i) : e.attr("title", i)
                }
            })
        }, this.getUICtrl = function() {
            return e || (e = new function() {
                this.constructor.prototype.createHoverBtnToolDom = function(t) {
                    var e, o = t.btn,
                        n = "",
                        i = t.option.tipTitle;
                    return editToolIconExt = s.top._logoPositionFixTop ? "" : "unfixed", o.title = s.top._logoPositionFixTop ? "不固定" : "固定", n = i ? ' data-title-tip="' + o.title + '" ' : ' title="' + o.title + '" ', t.btnContent = '<a unselectable class="f-editToolIcon editToolIcon ' + editToolIconExt + '" command ="' + o.command + '" ' + n + "></a>", e = _EditBtnBase.getUICtrl().createHoverBtnToolDom(t), t.btnContent = null, e
                }
            })
        }
    };
    _EditBoldBtn = new function() {
        var t;
        this.getEventCtrl = function() {}, this.getUICtrl = function() { return t || (t = new function() { this.constructor.prototype.createBtnToolDom = function(t) { return _EditBtnBase.getUICtrl().createBtnToolDom(t) } }) }
    };
    _EditContentBtn = new function() {
        var t;
        this.getEventCtrl = function() {}, this.getUICtrl = function() { return t || (t = new function() { this.constructor.prototype.createHoverBtnToolDom = function(t) { var e, o = t.btn; return t.option.btnModuleEdit ? t.btnContent = "" : t.btnContent = '<a unselectable class="editToolIcon" command ="' + o.command + '">' + o.title + "</a>", e = _EditBtnBase.getUICtrl().createHoverBtnToolDom(t), t.btnContent = null, e } }) }
    };
    _EditFixedPositionBtn = new function() {
        var t, e;
        this.getEventCtrl = function() {
            return t || (t = new function(t) {
                var e = this;
                e.constructor.prototype.checkPositionFixed = function(t) { t.btn; var o = t.option; "function" == typeof o.positionFixedFun && c.undoRun(function() { e.setFixedPositionBtnTitle(t), o.positionFixedFun() }, { type: "logo", detail: "logoFixed" }) }, e.constructor.prototype.setFixedPositionBtnTitle = function(t) {
                    var e = t.btn,
                        o = t.option,
                        n = (t.toolbar, o.tipTitle),
                        i = "";
                    s.top._titlePositionFixTop ? (e.removeClass("editToolIconUnable"), i = "固定") : (e.addClass("editToolIconUnable"), i = "不固定"), n ? e.attr("data-title-tip", i) : e.attr("title", i)
                }
            })
        }, this.getUICtrl = function() {
            return e || (e = new function() {
                this.constructor.prototype.createHoverBtnToolDom = function(t) {
                    var e, o = t.btn,
                        n = "",
                        i = t.option.tipTitle;
                    return editToolIconUnable = s.top._titlePositionFixTop ? "editToolIconUnable" : "", o.title = s.top._titlePositionFixTop ? "不固定" : "固定", n = i ? ' data-title-tip="' + o.title + '" ' : ' title="' + o.title + '" ', t.btnContent = '<a unselectable class="editToolIcon ' + editToolIconUnable + '" command ="' + o.command + '" ' + n + "></a>", e = _EditBtnBase.getUICtrl().createHoverBtnToolDom(t), t.btnContent = null, e
                }
            })
        }
    };
    _EditLogoDisplayBtn = new function() {
        var t, e;
        this.getEventCtrl = function() {
            return t || (t = new function(t) {
                var e = this;
                e.constructor.prototype.checkLogoDisplay = function(t) {
                    t.btn;
                    var o = t.option;
                    "function" == typeof o.logoDisplayFun && c.undoRun(function() {
                        var n = e.setLogoDisplayBtnTitle(t);
                        o.logoDisplayFun(n)
                    }, { type: "logo", detail: "logoDisplaySwitch" })
                }, e.constructor.prototype.setLogoDisplayBtnTitle = function(t) {
                    var e = t.btn,
                        o = t.option,
                        n = "",
                        i = (t.toolbar, o.tipTitle),
                        a = !!s.top.$("#logo").is(":visible");
                    return a ? (e.addClass("editToolIconUnable"), n = "显示Logo") : (e.removeClass("editToolIconUnable"), n = "隐藏Logo"), i ? e.attr("data-title-tip", n) : e.attr("title", n), a
                }
            })
        }, this.getUICtrl = function() {
            return e || (e = new function() {
                this.constructor.prototype.createHoverBtnToolDom = function(t) {
                    var e, o = t.btn,
                        n = t.option.tipTitle,
                        i = "",
                        a = !!s.top.$("#logo").is(":visible"),
                        r = a ? "" : "editToolIconUnable";
                    return o.title = a ? "隐藏Logo" : "显示Logo", i = n ? ' data-title-tip="' + o.title + '" ' : ' title="' + o.title + '" ', t.btnContent = '<a unselectable class="editToolIcon ' + r + '" command ="' + o.command + '" ' + i + "></a>", e = _EditBtnBase.getUICtrl().createHoverBtnToolDom(t), t.btnContent = null, e
                }
            })
        }
    };
    _EditColorBtn = new function() {
        var e, n, a = this;
        this.getEventCtrl = function() {
            return e || (e = new function() {
                var e = this;
                e.constructor.prototype.initColorBtnBgColor = function(t) {
                    var e = t.editor,
                        o = t.option,
                        n = t.toolbar.find(".tool-color ." + o.css + "-tool-icon");
                    setTimeout(function() { n.css("background", e.css("color")), n.removeClass("fk-colorPicker-transparentIco") }, 100)
                }, e.constructor.prototype.checkColorIsWhite = function(e) { var o = !1; if (_typeof(e) == i || "null" == e || t.trim(e).length <= 0) return o; if ((e = (e = t.trim(e)).toLowerCase()).indexOf(";") > 0 && (e = (e = e.split(";"))[0]), -1 != e.indexOf("white") || -1 != e.indexOf("#ffffff")) return !0; if (-1 != e.indexOf("rgb")) { if (-1 != e.indexOf("(255, 255, 255)")) return !0; if (e.split(",").length > 3 && (-1 != e.indexOf(", 0)") || -1 != e.indexOf(",0)"))) return !0 } return o }, e.constructor.prototype.simpleTextColorInputHexStatus = function(o) {
                    var n, r, d, s = o.editor,
                        c = o.option,
                        u = o.state,
                        m = o.color,
                        f = o.rgbaColor,
                        p = !1,
                        h = !1,
                        g = l.getEventCtrl().getSelectedNode();
                    if (s.data(E.HasRefreshClick) && 1 == u && (t.trim(l.getEventCtrl().getSelectText(s, !0)).length <= 0 ? s.data(E.NotCreateNewNode, !1) : s.data(E.NotCreateNewNode, !0)), _typeof(p = s.data(E.NotCreateNewNode)) == i && (p = !0), g && "function" == typeof g.hasClass && g.hasClass("J_colorpicker_hex") && (p = !0), 1 == u && p) {
                        var v = { styleName: "xxxx", styleValue: "", editor: s, notCreateNewNode: "false", tTag: "font" };
                        l.getEventCtrl().setTagStyle(v), setTimeout(function() { l.getEventCtrl().setTagStyle(v), l.getEventCtrl().getWindowSelection().removeAllRanges() }, 100)
                    } else r = (n = s.attr("id")).substring(n.indexOf("-") + 1), d = t("#fkEditor-toolBar-" + r).find(".tool-color ." + c.css + "-tool-icon"), f && "" != f ? (d.css("background", f), h = e.checkColorIsWhite(f)) : (d.css("background", m), h = e.checkColorIsWhite(m)), h ? d.css("border", "solid 1px #ccc") : d.css("border", "0px"), f && "" != f ? l.getEventCtrl().setTagStyle({ styleName: "color", styleValue: f, editor: s, notCreateNewNode: p, attr2: "color", attr2Value: m }) : m.indexOf("linear-gradient") > -1 ? (l.getEventCtrl().setTagStyle({ styleName: "color", styleValue: "transparent", editor: s, notCreateNewNode: p, attr2: "color", attr2Value: m }), l.getEventCtrl().setTagStyle({ styleName: "background-image", styleValue: m, editor: s, notCreateNewNode: p, attr2: "color", attr2Value: m })) : (l.getEventCtrl().setTagStyle({ styleName: "color", styleValue: m, editor: s, notCreateNewNode: p, attr2: "color", attr2Value: m }), l.getEventCtrl().setTagStyle({ styleName: "background-image", styleValue: "", editor: s, notCreateNewNode: p, attr2: "color", attr2Value: m }));
                    return a
                }, e.constructor.prototype.backTextSelectedStatus = function(n) {
                    var i = n.option,
                        r = n.editor;
                    if (!t(".J_faiColorPickerAlp").is(":visible") || !t(".J_advanceColorPicker").data("open")) return a;
                    var d, s = r.data(E.SignClassNum),
                        c = r.find("." + r.data(E.EditSignClass) + s)[0];
                    p ? ((d = o.createRange()).selectNode(c), B.addRange(d)) : u ? l.getEventCtrl().setSelectRange(r.data(E.Range)) : l.getEventCtrl().setNodeRange(c);
                    var m = t("#fkEditor-toolBar-" + i.moduleId);
                    colorBar = m.find(".tool-color ." + i.css + "-tool-icon"), fontColor = t(c).css("color"), e.checkColorIsWhite(fontColor) ? colorBar.css("border", "solid 1px #ccc") : colorBar.css("border", "0px"), colorBar.css("background", fontColor), colorBar.removeClass("fk-colorPicker-transparentIco")
                }
            })
        }, this.getUICtrl = function() { return n || (n = new function() { this.constructor.prototype.createBtnToolDom = function(t) { return _EditBtnBase.getUICtrl().createBtnToolDom(t) } }) }
    };
    _EditDeleteBtn = new function() {
        var t;
        this.getEventCtrl = function() {}, this.getUICtrl = function() { return t || (t = new function() { this.constructor.prototype.createHoverBtnToolDom = function(t) { return _EditBtnBase.getUICtrl().createHoverBtnToolDom(t) } }) }
    };
    _EditFormatsBtn = new function() {
        var e, o, n = this;
        this.getEventCtrl = function() {
            return e || (e = new function() {
                this.constructor.prototype.showFormatToolBar = function(t) {
                    var e = t.option,
                        o = t.toolbar.find(".tool-formats").find("." + e.css + "-formatBar"),
                        i = o.height() > 0;
                    return o.find(".formatDef").removeClass("formatDef"), i ? _EditToolBase.getEventCtrl().animateHideToolSecondPanel(e) : (o.parent().find(".fkEditor-tool-iconNew").addClass("edTriangleOnNew"), o.addClass("formatBarSlideDown"), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(e, BtnCommand.Formats)), n
                }, this.constructor.prototype.bindFormatSliderEvent = function(e) {
                    var o = e.option,
                        n = e.editor,
                        i = e.toolbar,
                        a = i.find(".tool-formats"),
                        r = (o.moduleId.replace("module", ""), a.find("." + o.css + "-formatBar"));
                    _SelectedTool.getEventCtrl().bindMousewheelAndSlideEvent({ formatbar: r, toolbar: i }), r.find("a").click(function(i) { var d; return f && (i.stopPropagation(), !o.btnModuleEdit && l.getEventCtrl().setSelectRange(n.data(E.Range))), r.find(".formatDef").removeClass("formatDef"), r.find(".selectedTip").hide(), t(this).addClass("formatDef"), a.find(".selectDiv span").attr("title", t(this).attr(o.css + "-formatName")).html(t(this).attr(o.css + "-formatName")), o.btnModuleEdit ? ((d = {}).command = BtnCommand.Formats, d.val = t(this).attr(o.css + "-formatval"), _EditBtnBase.getEventCtrl().selectChangeForBtnModuel(e, d)) : l.getEventCtrl().setSelection("fontname", t(this).attr(o.css + "-formatval")), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(o), !1 }).hover(function() {
                        var e, o = t(this);
                        r.find(".formatDef").removeClass("formatDef"), o.addClass("formatDef"), o.find(".formatMg").hasClass("needTip") && (e = r.find(".selectedTip"), r.find(".selectedTip").show(), e.css({ top: o[0].getBoundingClientRect().top - r[0].getBoundingClientRect().top - parseInt((e.find(".tipRight").outerHeight() - o.outerHeight()) / 2), left: parseInt(o.width()) + 22 }))
                    }, function() { t(this).find(".formatMg").hasClass("needTip") && r.find(".selectedTip").hide() })
                }
            })
        }, this.getUICtrl = function() { return o || (o = new function() { this.constructor.prototype.createBtnToolDom = function(t) { return t.selectedData = t.option.EditFormatsBtn.selectedData, _SelectedTool.getUICtrl().createSelectedSlideToolDom(t) } }) }
    };
    _EditFontSizeBtn = new function() {
        var e, o, n = this;
        this.getEventCtrl = function() {
            return e || (e = new function() {
                var e;
                this.constructor.prototype.showSizeToolBar = function(t) {
                    var o = t.option,
                        i = t.toolbar,
                        a = (t.editor, i.find(".tool-fontSize")),
                        r = a.find(".selectDivNew span"),
                        d = a.find("." + o.css + "-formatBar"),
                        s = d.height() > 0;
                    return d.find(".formatDef").addClass("J_formatDef").removeClass("formatDef"), s ? _EditToolBase.getEventCtrl().animateHideToolSecondPanel(o) : (a.find(".selectDiv span").html(a.find(".selectDiv span").attr("_value")), d.parent().find(".fkEditor-tool-iconNew").addClass("edTriangleOnNew"), d.addClass("formatBarSlideDown"), r.attr(T, !0), clearTimeout(e), e = setTimeout(function() { l.getEventCtrl().setNodeRange(r[0]) }, 300), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(o, BtnCommand.FontSize)), n
                }, this.constructor.prototype.bindFontSizeEvent = function(e) {
                    var o = e.option,
                        n = e.editor,
                        i = e.toolbar,
                        a = e.module,
                        r = i.find(".tool-fontSize"),
                        d = r.find(".selectDivNew span"),
                        s = r.find("." + o.css + "-formatBar");
                    _SelectedTool.getEventCtrl().bindMousewheelAndSlideEvent({ formatbar: s, toolbar: i }), _SelectedTool.getEventCtrl().bindInputEvent({ element: d, command: BtnCommand.FontSize, editor: n, btn: r, option: o, module: a }), s.find("a").click(function(i) { var s; return _EditToolBase.getEventCtrl().editToolLogDog({ module: a, command: BtnCommand.ChooseFormats }), d.attr(T, !1), l.getEventCtrl().getWindowSelection().removeAllRanges(), f && (i.stopPropagation(), !o.btnModuleEdit && l.getEventCtrl().setSelectRange(n.data(E.Range))), r.find(".selectDiv span").attr("_value", t(this).attr(o.css + "-formatName").replace("px", "")).html(t(this).attr(o.css + "-formatName")), o.btnModuleEdit ? ((s = {}).command = BtnCommand.FontSize, s.val = t(this).attr(o.css + "-formatval"), _EditBtnBase.getEventCtrl().selectChangeForBtnModuel(e, s)) : l.getEventCtrl().setTagStyle({ styleName: "font-size", styleValue: t(this).attr(o.css + "-formatval"), editor: n, notCreateNewNode: !0, createNewNodeAction: !0 }), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(o), !1 }).hover(function() { s.find(".formatDef").removeClass("formatDef"), t(this).addClass("formatDef") })
                }
            })
        }, this.getUICtrl = function() { return o || (o = new function() { this.constructor.prototype.createBtnToolDom = function(t) { var e; return t.selectedData = t.option.EditFontSizeBtn.selectedData, t.reSetUnselectable = " ", e = _SelectedTool.getUICtrl().createSelectedSlideToolDom(t), delete t.reSetUnselectable, e } }) }
    };
    _EditGlobalLinkBtn = new function() {
        var e, o;
        this._panelHeight = 110, this.getEventCtrl = function() {
            return e || (e = new function() {
                this.constructor.prototype.bindGlobalLinkPanelEvent = function(e) {
                    var o = e.option,
                        n = e.module,
                        i = e.editor,
                        a = e.toolbar.find(".tool-link").find("." + o.css + "-linkSlideBar"),
                        r = a.find(".linkPanel");
                    f && a.unbind("click.globalLinkBar mouseup.globalLinkBar").bind("click.globalLinkBar mouseup.globalLinkBar", function(t) { t.stopPropagation() }), r.find(".cancel").unbind("click.linkPanelCancel").bind("click.linkPanelCancel", function() { o.cancelGlobalJumpCtrlFun && "" != o.cancelGlobalJumpCtrlFun && s.fkEval(o.cancelGlobalJumpCtrlFun), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(o) }), r.find(".confirm").unbind("click.linkPanelConfirm").bind("click.linkPanelConfirm", function() { o.saveGlobalJumpCtrlFun && "" != o.saveGlobalJumpCtrlFun && (s.fkEval(o.saveGlobalJumpCtrlFun) && _EditToolBase.getEventCtrl().animateHideToolSecondPanel(o), i.trigger("change")) }), r.find(".linkDelete").off("mouseenter.linkDeleteHover").on("mouseenter.linkDeleteHover", function() { "" == r.find(".linkSet").find(".jumpHref").val() ? t(this).addClass("f-deleteDisable") : t(this).removeClass("f-deleteDisable") }).off("click.linkDeleteClick").on("click.linkDeleteClick", function() { _EditToolBase.getEventCtrl().editToolLogDog({ module: n, command: BtnCommand.DeleteLink }), r.find(".linkSet").find(".jumpHref").val("").removeAttr("disabled"), r.find(".linkSet").find(".jumpCtrl").attr({ _lType: "0", _linkdeleteclick: !0 }).removeAttr("_lide target _lname _lurl _extJUrl"), n.data("jumpIde", ""), t(this).trigger("mouseenter") })
                }, this.constructor.prototype.showGlobalLinkPanel = function(t) {
                    var e = t.option,
                        o = t.toolbar.find(".tool-link"),
                        n = e.moduleId.replace("module", ""),
                        i = o.find("." + e.css + "-linkSlideBar"),
                        a = i.find(".linkPanel");
                    i.height() > 0 ? _EditToolBase.getEventCtrl().animateHideToolSecondPanel(e) : (a.find(".linkSet").find(".jumpCtrl").removeAttr("_linkdeleteclick"), a.addClass("fkEditorBarBorder"), o.find(".slideDiv").addClass("slideDivBorder"), i.addClass("linkPanelSlide"), _EditToolBase.getEventCtrl().editToolBarMask(n))
                }
            })
        }, this.getUICtrl = function() {
            return o || (o = new function() {
                var t = this;
                t.constructor.prototype.createHoverBtnToolDom = function(e) {
                    var o = e.option,
                        n = e.btn,
                        i = [],
                        a = "";
                    return o.tipTitle && (a = ' data-title-tip="' + n.title + '" '), i.push('<div class="linkDiv slideDiv" unselectable>'), i.push("</div>"), i.push('<a unselectable class="editToolIcon ' + n.command + '-tool-icon" command ="' + n.command + '" ' + a + " ></a>"), i.push('<div class="' + o.css + '-linkSlideBar">'), i.push('<div class="linkPanel fkEditorBar">'), i.push(t.createLinkPanelDom(o)), i.push("</div>"), i.push("</div>"), i.push("</div>"), e.btnContent = i.join(""), i = _EditBtnBase.getUICtrl().createHoverBtnToolDom(e), e.btnContent = null, i
                }, t.constructor.prototype.createLinkPanelDom = function(t) { var e = []; return e.push('<div class="linkItem">'), e.push('<div class="linkTip">链接地址：</div>'), t.btnModuleEdit || t.simpleTool ? e.push('<div class="linkSet"><input id="jumpHref' + t.moduleId.replace("module", "") + '" class="jumpHref" maxlength="255"/></div>') : (e.push('<div class="linkSet"><input id="jumpHref' + t.moduleId + '" class="jumpHref" maxlength="255"/></div>'), e.push('<div title="删除" class="linkDelete f-deleteLink" style="display:block;">删除</div>')), e.push("</div>"), e.push('<div class="operaItem">'), e.push('<div class="confirm" title="保存链接">确定</div>'), e.push('<div class="cancel" title="取消">取消</div>'), e.push("</div>"), e.join("") }
            })
        }
    };
    _EditBorderRadiusBtn = new function() {
        var t, e;
        this._panelHeight = 45, this.getEventCtrl = function() {
            return t || (t = new function() {
                this.constructor.prototype.bindBorderRadiusPanelEvent = function(t) {
                    var e, o = t.option,
                        n = t.module,
                        i = (t.editor, t.toolbar),
                        a = o.moduleId.replace("module", ""),
                        r = c.getModuleAttrPattern(a).floatBtn,
                        l = r.r,
                        d = r.s.w || 163,
                        u = r.s.h || 52,
                        m = i.find(".tool-borderRadius").find("." + o.css + "-borderRadiusSlideBar"),
                        f = m.find(".borderRadiusPanel");
                    l.lt, e = parseInt(d / 2) > parseInt(u / 2) ? parseInt(u / 2) : parseInt(d / 2);
                    var p = n.find(".floatBtn"),
                        h = l.lt > e ? e : l.lt;
                    0 == l.t && (h = parseInt(p.css("borderTopLeftRadius")));
                    var g = null,
                        v = { animate: !0, max: e, min: 0, orientation: "horizontal", step: 1, value: h, start: function(t, e) { g = e.value }, slide: E, stop: function(t, e) { s.top.Site.getModuleAttrPattern(a).changed = !0, c.styleChanged(), null !== g && (c.undoRun(E, { type: "module.floatBtn", detail: "floatBtnBorderRadius", id: a, doArgs: [null, { value: e.value }], undoArgs: [null, { value: g }] }), g = null) } },
                        C = v.value,
                        B = 90 / e;

                    function E(t, e) {
                        m.find(".borderRadiusLhBar").css("width", e.value * B + "px"), l.t = 2, l.lb = e.value, l.lt = e.value, l.rb = e.value, l.rt = e.value, c.setFlBtnRadiusChange(a, l);
                        var o = i.find(".setRadiusBar .ui-slider-handle"),
                            n = e.value;
                        o.css({ left: n * B + "px" })
                    }
                    f.find(".borderRadiusLhBar").css("width", C * B + "px"), setTimeout(function() { f.find(".borderRadiusBar").slider(v) }, 200)
                }, this.constructor.prototype.showBorderRadiusPanel = function(t) {
                    var e = t.option,
                        o = t.toolbar.find(".tool-borderRadius"),
                        n = e.moduleId.replace("module", ""),
                        i = o.find("." + e.css + "-borderRadiusSlideBar").find(".borderRadiusPanel");
                    i.height() > 0 ? _EditToolBase.getEventCtrl().animateHideToolSecondPanel(e, BtnCommand.BorderRadius) : (i.addClass("f-borderRadiusPanel-show"), o.find(".slideDiv").addClass("slideDivBorder"), _EditToolBase.getEventCtrl().editToolBarMask(n), c.logDog(200193, 16))
                }
            })
        }, this.getUICtrl = function() {
            return e || (e = new function() {
                var t = this;
                t.constructor.prototype.createHoverBtnToolDom = function(e) {
                    var o = e.option,
                        n = e.btn,
                        i = [],
                        a = "";
                    return o.tipTitle && (a = ' data-title-tip="' + n.title + '" '), i.push('<div class="boderRadiusDiv slideDiv" unselectable>'), i.push("</div>"), i.push('<a unselectable class="f-editToolIcon editToolIcon ' + n.command + '-tool-icon" command ="' + n.command + '" ' + a + " ></a>"), i.push('<div class="borderRadiusSlideBarForBtnM ' + o.css + "-borderRadiusSlideBar f-" + o.css + '-borderRadiusSlideBar ">'), i.push('<div class="f-borderRadiusPanel f-fkEditorBar borderRadiusPanel fkEditorBar">'), i.push(t.createBorderRadiusPanelDom(o)), i.push("</div>"), i.push("</div>"), i.push("</div>"), e.btnContent = i.join(""), i = _EditBtnBase.getUICtrl().createHoverBtnToolDom(e), e.btnContent = null, i
                }, t.constructor.prototype.createBorderRadiusPanelDom = function(t) { var e = []; return e.push('<div class="borderRadiusBar f-slideBar" ></div>'), e.push('<div class="borderRadiusLhBar f-select-slideBar"></div>'), e.join("") }
            })
        }
    };
    _EditOpacityBtn = new function() {
        var e, o;
        this._panelHeight = 45, this.getEventCtrl = function() {
            return e || (e = new function() {
                this.constructor.prototype.bindOpacityPanelEvent = function(e) {
                    var o = e.option,
                        n = (e.module, e.editor, e.toolbar),
                        i = o.moduleId.replace("module", ""),
                        a = n.find(".tool-opacity").find("." + o.css + "-opacitySlideBar"),
                        r = a.find(".opacityPanel"),
                        l = 100 - s.top.Site.getModuleAttrPattern(i).transparent;
                    r.find(".opacityBar").css("left"), r.find(".inputVal").html(l + "%"), r.find(".opacityLhBar").css("width", l + "px");
                    var d = null,
                        u = { animate: !0, max: 90, min: 0, orientation: "horizontal", step: 1, value: l, start: function(t, e) { d = e.value }, slide: function(t, e) { a.find(".opacityLhBar").css("width", e.value + "px"), a.find(".inputVal").html(e.value + "%"), c.refreshFloatImgOpacity(i, e.value), s.top.Site.getModuleAttrPattern(i).transparent = 100 - e.value }, stop: m };

                    function m(t, e) { null !== d && (c.undoRun(f, { type: "module.floatBtn", detail: "floatBtnOpacity", id: i, doArgs: [e.value], undoArgs: [d] }), d = null) }

                    function f(t) { r.find(".opacityBar").slider("value", t), a.find(".opacityLhBar").css("width", t + "px"), a.find(".inputVal").hasClass("contentEditable") || a.find(".inputVal").html(t + "%"), c.refreshFloatImgOpacity(i, t), s.top.Site.getModuleAttrPattern(i).transparent = 100 - t, s.top.Site.getModuleAttrPattern(i).changed = !0, c.styleChanged() }
                    setTimeout(function() { r.find(".opacityBar").slider(u), _EditToolBase.getEventCtrl().bindSliderInputEvent(a.find(".inputVal"), { onChange: f, maxVal: a.find(".opacityBar").width() }), a.find(".inputVal").off(".undoOpacity").on("focus.undoOpacity", function() { s.isNull(d) && (d = parseInt(t(this).text())) }).on("blur.undoOpactiy", function() { m(0, { value: parseInt(t(this).text()) }) }) }, 200)
                }, this.constructor.prototype.showOpacityPanel = function(t) {
                    var e = t.option,
                        o = t.toolbar.find(".tool-opacity"),
                        n = e.moduleId.replace("module", ""),
                        i = o.find("." + e.css + "-opacitySlideBar").find(".opacityPanel");
                    i.height() > 0 ? _EditToolBase.getEventCtrl().animateHideToolSecondPanel(e, BtnCommand.Opacity) : (i.addClass("f-opacityPanel-show"), o.find(".slideDiv").addClass("slideDivBorder"), _EditToolBase.getEventCtrl().editToolBarMask(n))
                }
            })
        }, this.getUICtrl = function() {
            return o || (o = new function() {
                var t = this;
                t.constructor.prototype.createHoverBtnToolDom = function(e) {
                    var o = e.option,
                        n = e.btn,
                        i = [],
                        a = "";
                    return o.tipTitle && (a = ' data-title-tip="' + n.title + '" '), i.push('<div class="opacityDiv slideDiv" unselectable>'), i.push("</div>"), i.push('<a unselectable class="f-editToolIcon editToolIcon ' + n.command + '-tool-icon" command ="' + n.command + '" ' + a + " ></a>"), i.push('<div class="opacitySlideBarForBtnM ' + o.css + "-opacitySlideBar f-" + o.css + '-opacitySlideBar ">'), i.push('<div class="f-opacityPanel f-fkEditorBar opacityPanel fkEditorBar">'), i.push(t.createOpacityPanelDom(o)), i.push("</div>"), i.push("</div>"), i.push("</div>"), e.btnContent = i.join(""), i = _EditBtnBase.getUICtrl().createHoverBtnToolDom(e), e.btnContent = null, i
                }, t.constructor.prototype.createOpacityPanelDom = function(t) { var e = []; return e.push('<div class="opacityBar f-slideBar" ></div>'), e.push('<div class="opacityLhBar f-select-slideBar"></div>'), e.push('<div class="inputVal f-inputVal">0%</div>'), e.join("") }
            })
        }
    };
    _EditBorderBtn = new function() {
        var e, o;
        this._panelHeight = 55, this.getEventCtrl = function() {
            return e || (e = new function() {
                this.constructor.prototype.bindBorderPanelEvent = function(e) {
                    var o = e.option,
                        n = (e.module, e.editor, e.toolbar),
                        i = o.moduleId.replace("module", ""),
                        a = n.find(".tool-border").find("." + o.css + "-borderSlideBar"),
                        r = a.find(".borderPanel"),
                        l = s.top.Site.getModuleAttrPattern(i).floatBtn.b,
                        d = l.w || 0,
                        u = null;
                    0 == l.t && (d = 0);
                    var m = { animate: !0, max: 8, min: 0, orientation: "horizontal", step: 1, value: d, start: function(t, e) { u = e.value }, slide: f, stop: p };

                    function f(t, e) { a.find(".borderSizeBar").css("width", 11 * e.value + "px"), l.t = 2, l.w = e.value, a.find(".inputVal").html(e.value + "px"), c.setFlBtnBorderChang(i, l) }

                    function p(t, e) { s.top.Site.getModuleAttrPattern(i).changed = !0, c.styleChanged(), null !== u && (c.undoRun(function(t) { f(0, { value: t }), r.find(".setBorderSize").slider("value", t), a.find(".borderSizeBar").css("width", 11 * t + "px") }, { type: "module.floatBtn", detail: "floatBtnBorderSize", id: i, doArgs: [e.value], undoArgs: [u] }), u = null) }
                    r.find(".setBorderSize").slider(m), a.find(".inputVal").html(d + "px"), a.find(".borderSizeBar").css("width", 11 * d + "px"), a.find(".borderColor").css("background", l.c), _EditToolBase.getEventCtrl().bindSliderInputEvent(a.find(".inputVal"), { onChange: function(t) { r.find(".setBorderSize").slider("value", t), a.find(".borderSizeBar").css("width", 11 * t + "px"), l.t = 2, l.w = t, c.setFlBtnBorderChang(i, l), s.top.Site.getModuleAttrPattern(i).changed = !0, c.styleChanged() }, maxVal: 8, per: "px" }), a.find(".inputVal").off(".undoBorder").on("focus.undoBorder", function() { s.isNull(u) && (u = parseInt(t(this).text())) }).on("blur.undoBorder", function() { p(0, { value: parseInt(t(this).text()) }) }), a.find(".borderColor").off("click.b").on("click.b", function(t) {
                        function e(t) { a.find(".borderColor").css("background", t), l.t = 2, l.c = t, c.setFlBtnBorderChang(i, l), s.top.Site.getModuleAttrPattern(i).changed = !0, c.styleChanged() }
                        s.isMozilla() && t.stopPropagation();
                        var o = l.c,
                            n = (a.find(".borderColor"), a.find(".borderColor")[0]);
                        c.colorPickerV2.show({ base: n, initialColor: n.style.background, openGradientMode: !1, onChange: e, onChangeStop: function(t) { c.undoRun(e, { type: "module.floatBtn", detail: "floatBtnBordercolor", id: i, doArgs: [t], undoArgs: [o] }) }, top: c.colorPickerV2.nonHeaderHeight / 2 })
                    })
                }, this.constructor.prototype.showBorderPanel = function(t) {
                    var e = t.option,
                        o = t.toolbar.find(".tool-border"),
                        n = e.moduleId.replace("module", ""),
                        i = o.find("." + e.css + "-borderSlideBar").find(".borderPanel");
                    i.height() > 0 ? _EditToolBase.getEventCtrl().animateHideToolSecondPanel(e, BtnCommand.Border) : (i.addClass("f-borderPanel-show"), o.find(".slideDiv").addClass("slideDivBorder"), _EditToolBase.getEventCtrl().editToolBarMask(n))
                }
            })
        }, this.getUICtrl = function() {
            return o || (o = new function() {
                var t = this;
                t.constructor.prototype.createHoverBtnToolDom = function(e) {
                    var o = e.option,
                        n = e.btn,
                        i = [],
                        a = "";
                    return o.tipTitle && (a = ' data-title-tip="' + n.title + '" '), i.push('<div class="borderDiv slideDiv" unselectable>'), i.push("</div>"), i.push('<a unselectable class="f-editToolIcon editToolIcon ' + n.command + '-tool-icon" command ="' + n.command + '" ' + a + " ></a>"), i.push('<div class=" ' + o.css + "-borderSlideBar f-" + o.css + '-borderSlideBar ">'), i.push('<div class="f-borderPanel f-fkEditorBar borderPanel fkEditorBar">'), i.push(t.createBorderPanelDom(o)), i.push("</div>"), i.push("</div>"), i.push("</div>"), e.btnContent = i.join(""), i = _EditBtnBase.getUICtrl().createHoverBtnToolDom(e), e.btnContent = null, i
                }, t.constructor.prototype.createBorderPanelDom = function(t) { var e = []; return e.push('<div class="f-item">'), e.push('<div class="f-tip">大小</div>'), e.push('<div class="setBorderSize f-slideBar"></div>'), e.push('<div class="borderSizeBar f-select-slideBar"></div>'), e.push('<div class="inputVal f-inputVal">0px</div>'), e.push("</div>"), e.push('<div class="f-item">'), e.push('<div class="f-tip">颜色</div>'), e.push('<div class="borderColor f-color-select"></div>'), e.push("</div>"), e.join("") }
            })
        }
    };
    _EditShadowBtn = new function() {
        var e, o;
        this._panelHeight = 130, this.getEventCtrl = function() {
            return e || (e = new function() {
                this.constructor.prototype.bindShadowPanelEvent = function(e) {
                    var o = e.option,
                        n = (e.module, e.editor, e.toolbar),
                        i = o.moduleId.replace("module", ""),
                        a = n.find(".tool-shadow").find("." + o.css + "-shadowSlideBar"),
                        r = a.find(".shadowPanel"),
                        l = s.top.Site.getModuleAttrPattern(i).floatBtn.sh,
                        d = l.dx,
                        u = l.dy,
                        m = l.f;
                    0 == l.t && (d = 0, u = 0, m = 0);
                    var f = null,
                        p = { animate: !0, max: 110, min: 0, orientation: "horizontal", step: 1, value: d, start: function(e, o) { f = t.extend({}, l) }, slide: function(t, e) { a.find(".shadowXBar").css("width", e.value + "px"), a.find(".J_inputValX").html(e.value + "px"), l.t = 2, l.dx = e.value, c.setFlBtnShadowChange(i, l), k(i) }, stop: v },
                        h = { animate: !0, max: 110, min: 0, orientation: "horizontal", step: 1, value: u, start: function(e, o) { f = t.extend({}, l) }, slide: function(t, e) { a.find(".shadowYBar").css("width", e.value + "px"), a.find(".J_inputValY").html(e.value + "px"), l.t = 2, l.dy = e.value, c.setFlBtnShadowChange(i, l), k(i) }, stop: v },
                        g = { animate: !0, max: 110, min: 0, orientation: "horizontal", step: 1, value: m, start: function(e, o) { f = t.extend({}, l) }, slide: function(t, e) { a.find(".shadowStyleBar").css("width", e.value + "px"), a.find(".J_inputValS").html(e.value + "px"), l.t = 2, l.f = e.value, c.setFlBtnShadowChange(i, l), k(i) }, stop: v };

                    function v(e, o) { c.undoRun(C, { type: "module.floatBtn", detail: "floatBtnShadow", id: i, doArgs: [t.extend({}, l)], undoArgs: [t.extend({}, f)] }), undoCacheOpacity = null }

                    function C(e) { a.find(".shadowXBar").css("width", e.dx + "px"), a.find(".J_inputValX").html(e.dx + "px"), r.find(".setShadowX").slider("value", e.dx), a.find(".shadowYBar").css("width", e.dy + "px"), a.find(".J_inputValY").html(e.dy + "px"), r.find(".setShadowY").slider("value", e.dy), a.find(".shadowStyleBar").css("width", e.f + "px"), a.find(".J_inputValS").html(e.f + "px"), r.find(".setShadowStyle").slider("value", e.f), t.extend(l, e), c.setFlBtnShadowChange(i, l), k(i) }
                    r.find(".setShadowX").slider(p), a.find(".J_inputValX").html(d + "px"), _EditToolBase.getEventCtrl().bindSliderInputEvent(a.find(".J_inputValX"), { onChange: function(t) { r.find(".setShadowX").slider("value", t), a.find(".shadowXBar").css("width", t + "px"), l.t = 2, l.dx = t, c.setFlBtnShadowChange(i, l), k(i) }, per: "px", maxVal: p.max, maxLength: 4 }), r.find(".setShadowY").slider(h), a.find(".J_inputValY").html(u + "px"), _EditToolBase.getEventCtrl().bindSliderInputEvent(a.find(".J_inputValY"), { onChange: function(t) { r.find(".setShadowY").slider("value", t), a.find(".shadowYBar").css("width", t + "px"), l.t = 2, l.dy = t, c.setFlBtnShadowChange(i, l), k(i) }, per: "px", maxVal: h.max, maxLength: 4 }), r.find(".setShadowStyle").slider(g), a.find(".J_inputValS").html(m + "px"), _EditToolBase.getEventCtrl().bindSliderInputEvent(a.find(".J_inputValS"), { onChange: function(t) { r.find(".setShadowStyle").slider("value", t), a.find(".shadowStyleBar").css("width", t + "px"), l.t = 2, l.f = t, c.setFlBtnShadowChange(i, l), k(i) }, per: "px", maxVal: g.max }), a.find(".shadowXBar").css("width", l.dx + "px"), a.find(".shadowYBar").css("width", l.dy + "px"), a.find(".shadowStyleBar").css("width", l.f + "px"), a.find(".shadowColor").css("background", l.c), a.find(".J_inputValY, .J_inputValY, .J_inputValS").off(".undoShadow").on("focus.undoShadow", function() { s.isNull(undoCacheOpacity) && (undoCacheOpacity = t.extend({}, l)) }).on("blur.undoShadow", function() { v() }), a.find(".shadowColor").off("click.s").on("click.s", function(t) {
                        function e(t) { a.find(".shadowColor").css("background", t), l.t = 2, l.c = t, c.setFlBtnShadowChange(i, l), s.top.Site.getModuleAttrPattern(i).changed = !0, c.styleChanged() }
                        s.isMozilla() && t.stopPropagation(), l.c, a.find(".shadowColor");
                        var o = a.find(".shadowColor")[0];
                        c.colorPickerV2.show({ base: o, initialColor: o.style.background, onChange: e, openGradientMode: !1, top: c.colorPickerV2.nonHeaderHeight / 2 })
                    })
                }, this.constructor.prototype.showShadowPanel = function(t) {
                    var e = t.option,
                        o = t.toolbar.find(".tool-shadow"),
                        n = e.moduleId.replace("module", ""),
                        i = o.find("." + e.css + "-shadowSlideBar").find(".shadowPanel");
                    i.height() > 0 ? _EditToolBase.getEventCtrl().animateHideToolSecondPanel(e, BtnCommand.Shadow) : (i.addClass("f-shadowPanel-show"), o.find(".slideDiv").addClass("slideDivShadow"), _EditToolBase.getEventCtrl().editToolBarMask(n))
                }
            })
        }, this.getUICtrl = function() {
            return o || (o = new function() {
                var t = this;
                t.constructor.prototype.createHoverBtnToolDom = function(e) {
                    var o = e.option,
                        n = e.btn,
                        i = [],
                        a = "";
                    return o.tipTitle && (a = ' data-title-tip="' + n.title + '" '), i.push('<div class="shadowDiv slideDiv" unselectable>'), i.push("</div>"), i.push('<a unselectable class="f-editToolIcon editToolIcon ' + n.command + '-tool-icon" command ="' + n.command + '" ' + a + " ></a>"), i.push('<div class=" ' + o.css + "-shadowSlideBar f-" + o.css + '-shadowSlideBar ">'), i.push('<div class="f-shadowPanel f-fkEditorBar shadowPanel fkEditorBar">'), i.push(t.createShadowPanelDom(o)), i.push("</div>"), i.push("</div>"), i.push("</div>"), e.btnContent = i.join(""), i = _EditBtnBase.getUICtrl().createHoverBtnToolDom(e), e.btnContent = null, i
                }, t.constructor.prototype.createShadowPanelDom = function(t) { var e = []; return e.push('<div class="f-item">'), e.push('<div class="f-tip">X轴</div>'), e.push('<div class="setShadowX f-slideBar"></div>'), e.push('<div class="shadowXBar f-select-slideBar"></div>'), e.push('<div class="f-inputVal inputVal J_inputValX"></div>'), e.push("</div>"), e.push('<div class="f-item">'), e.push('<div class="f-tip">Y轴</div>'), e.push('<div class="setShadowY f-slideBar"></div>'), e.push('<div class="shadowYBar f-select-slideBar"></div>'), e.push('<div class="f-inputVal inputVal J_inputValY"></div>'), e.push("</div>"), e.push('<div class="f-item">'), e.push('<div class="f-tip">阴影</div>'), e.push('<div class="setShadowStyle f-slideBar"></div>'), e.push('<div class="shadowStyleBar f-select-slideBar"></div>'), e.push('<div class="f-inputVal inputVal J_inputValS"></div>'), e.push("</div>"), e.push('<div class="f-item">'), e.push('<div class="f-tip">颜色</div>'), e.push('<div class="shadowColor f-color-select"></div>'), e.push("</div>"), e.join("") }
            })
        }
    };
    _EditRadiusBtn = new function() {
        var e, o, n = this;
        this.getEventCtrl = function() {
            return e || (e = new function() {
                this.constructor.prototype.bindRadiusBtnEvent = function(e) {
                    var o, n, i = e.option,
                        a = e.module,
                        r = e.toolbar,
                        l = i.moduleId.replace("module", ""),
                        d = c.getModuleAttrPattern(l).floatBtn,
                        u = d.r,
                        m = d.s.w || 163,
                        f = d.s.h || 52,
                        p = r.find(".tool-borderRadius").find("." + i.css + "-borderRadiusSlideBar").find(".borderRadiusPanel");
                    if (n = parseInt(m / 2) > parseInt(f / 2) ? parseInt(f / 2) : parseInt(m / 2), !((o = r.find(".setRadiusBar")).length < 1)) {
                        var h = 90 / n,
                            g = null,
                            v = a.find(".floatBtn"),
                            C = u.lt > n ? n : u.lt;
                        0 == u.t && (C = parseInt(v.css("borderTopLeftRadius")));
                        var B = { max: n, min: 0, orientation: "horizontal", step: 1, value: C, start: function(t, e) { g = e.value, o.data("radiusSliding", !0), _EditToolBase.getEventCtrl().editToolLogDog({ module: a, command: BtnCommand.Radius }) }, slide: E, stop: function(e, n) { o.data("radiusSliding", !1), s.top.Site.getModuleAttrPattern(l).changed = !0, c.styleChanged(), t(n.handle).blur(), null !== g && (c.undoRun(E, { type: "module.floatBtn", detail: "floatBtnRadoisBarSliding", id: l, doArgs: [null, n], undoArgs: [null, { vulue: g }] }), g = null) } };
                        o.slider(B), a.off("mouseover.radius").on("mouseover.radius", function() { r.find(".setRadiusBar").show() }).off("mouseleave.radius").on("mouseleave.radius", function() { r.find(".setRadiusBar").data("radiusSliding") || r.find(".setRadiusBar").hide() }), o.off("mouseover.radius").on("mouseover.radius", function() { r.find(".setRadiusBar").show() }).off("mouseleave.radius").on("mouseleave.radius", function() { r.find(".setRadiusBar").data("radiusSliding") || r.find(".setRadiusBar").hide() })
                    }

                    function E(t, e) { u.t = 2, u.lb = e.value, u.lt = e.value, u.rb = e.value, u.rt = e.value, c.setFlBtnRadiusChange(l, u), p.find(".borderRadiusLhBar").css("width", e.value * h + "px"), p.find(".ui-slider-handle").css("left", e.value * h + "px") }
                }
            })
        }, this.getUICtrl = function() { return o || (o = new function() { this.constructor.prototype.createEditRadiusBtnDom = function(t) { t.option; var e = t.toolbar; if (!(e.find(".setRadiusBar").length > 0)) return e.append("<div class='setRadiusBar f-setRadiusBar' title='左右拖动改变圆角'></div>"), n } }) }
    };
    _EditItalicBtn = new function() {
        var t;
        this.getEventCtrl = function() {}, this.getUICtrl = function() { return t || (t = new function() { this.constructor.prototype.createBtnToolDom = function(t) { return _EditBtnBase.getUICtrl().createBtnToolDom(t) } }) }
    };
    _EditLinkBtn = new function() {
        var e, o, n = this;
        this.getEventCtrl = function() {
            return e || (e = new function() {
                var e, o = this;
                o.constructor.prototype.setLinkAttr = function(t) { var e = t.element; return e.attr("href", t._lurl), e.attr("_ltype", t._ltype), e.attr("_lide", t._lide), e.attr("_lname", t._lname), e.attr("target", t._target), n }, o.constructor.prototype.setChildLink = function(e) {
                    var i, a, r = e.element,
                        l = e.wrapStr;
                    if (r && !(r.text().length <= 0) && (r.find("div").length > 0 || r.find("p").length > 0)) { for (var d = 0; d < r.children().length; d++)((i = r.children().eq(d)).find("div").length > 0 || i.find("p").length > 0) && i.text().length > 0 ? o.setChildLink({ element: i, wrapStr: l }) : i.text().length > 0 && (a = t(l).html(i.html()), i.html(a)); return n }
                }, o.constructor.prototype.handTagANotJump = function(e) {
                    e.find("a").each(function() {
                        var e = t(this).attr("href");
                        e != i && "" != e && (t(this).attr("_href", e), t(this).attr("href", ""))
                    })
                }, o.constructor.prototype.setLinkAll = function(t) {
                    var e, i, a, r, l, d, s, c, u = t.text().length,
                        m = 0;
                    if (u <= 0 || !t) return n;
                    if (t.children().length <= 0) return t.text().length <= 0 ? n : ("a" != t.prop("tagName").toLowerCase() && (d = t.parent("a")) && d.length >= 0 && ((d = d.clone()).text(t.text()), t.html(d.prop("outerHTML"))), n);
                    for (var f = 0; f < t.children().length; f++) m += t.children().eq(f).text().length;
                    if (u != m && m > 0) {
                        for (e = t.clone(), i = [], f = 0; f < e.children().length; f++) i.push(t.children().eq(f)), e.children().eq(f).prop("outerHTML", "'.?+'");
                        if (a = [], r = e.html(), l = 0, d = "", (d = "a" != t.prop("tagName").toLowerCase() ? t.parent("a") : t) && d.length >= 0) {
                            for (f = 0; f < i.length && !((l = r.indexOf("'.?+'")) < 0 || r.length <= 0); f++) 0 == l ? (i[f].attr("style") || i[f].attr("style", d.attr("style")), a.push(i[f].prop("outerHTML")), (r = r.length > "'.?+'".length ? r.substring("'.?+'".length, r.length) : "").length > 0 && ((l = r.indexOf("'.?+'")) < 0 ? ((c = d.clone()).html(r), a.push(c.prop("outerHTML")), r = "") : l > 0 && (s = r.substr(0, l), r = r.length > "'.?+'".length ? r.substring("'.?+'".length, r.length) : "", (c = d.clone()).html(s), a.push(c.prop("outerHTML"))))) : (s = r.substr(0, l), (c = d.clone()).html(s), a.push(c.prop("outerHTML")), r = r.length > l + "'.?+'".length ? r.substring(l + "'.?+'".length, r.length) : "", i[f].attr("style") || i[f].attr("style", d.attr("style")), a.push(i[f].prop("outerHTML")));
                            r.length > 0 && ((c = d.clone()).html(r), a.push(c.prop("outerHTML"))), t.html(a.join(""))
                        }
                    }
                    for (f = 0; f < t.children().length; f++) o.setLinkAll(t.children().eq(f));
                    return n
                }, o.constructor.prototype.fkEditorSetLink = function(a) {
                    var r = a.editor,
                        s = a.jumpCtrl,
                        u = a.isGloableLink,
                        m = a.option,
                        f = m.moduleId;
                    if (!s) return n;
                    if ("corpTitle" != m.editorName) {
                        var h, g, v, C = s.attr("_ltype"),
                            B = s.attr("_lide"),
                            b = s.attr("_lname"),
                            k = s.attr("_lurl"),
                            S = s.attr("target"),
                            y = s.attr("_linkdeleteclick"),
                            _ = !1,
                            w = "";
                        if (r.attr(T, !0), u) {
                            if (l.getEventCtrl().setNodeRange(r[0]), "true" == y && (_typeof(B) == i || "" == t.trim(B))) return l.getEventCtrl().setSelection("Unlink"), void setTimeout(function() {
                                for (var t = r.find("a"), e = 0; e < t.length; e++) aLink = t.eq(e), aLink.text().length <= 0 && aLink.remove();
                                r.data(E.SimpleTextEdit) || r.attr(T, !1)
                            }, 300)
                        } else l.getEventCtrl().setSelectRange(r.data(E.Range));
                        if (_typeof(k) != i) return 108 == C && (S = ""), (g = t(l.getEventCtrl().getSelectedNode())) && (w = g.children("span").css("color") || g.css("color"), _ = w == r.css("color")), _ && l.getEventCtrl().setTagStyle({ styleName: "color", styleValue: "#496EE8", isSetLinkColor: !0, editor: r }), h = k + "&_saltLurl", l.getEventCtrl().setSelection("Unlink"), l.getEventCtrl().setSelection(BtnCommand.Createlink, h), clearTimeout(e), e = setTimeout(function() {
                            var t, e = r.find("a"),
                                n = r.attr("style");
                            if (!(e.length <= 0)) {
                                r.height(r.height() + "px");
                                for (var i = 0; i < e.length; i++)
                                    if ((t = e.eq(i)).text().length <= 0 && t.remove(), h == t.attr("href")) {
                                        var a = { element: t, _lurl: k, _ltype: C, _lide: B, _lname: b, _target: S };
                                        if (o.setLinkAttr(a), v = "<a href='" + k + "' _ltype='" + C + "' _lide='" + B + "' _lname='" + b + "' target='" + S + "'>", o.setChildLink({ element: t, wrapStr: v }), _ && t.css("color", "#496EE8"), p) {
                                            var l = d.getEventCtrl().findTagInParent(t, "a", r.data(E.EndCheckClass));
                                            l && o.setLinkAll(l)
                                        }
                                    }
                                r.attr("style", n), r.data(E.SimpleTextEdit) || r.attr(T, !1);
                                var s = (f || "").replace("module", "");
                                c.removeQrCode(s), c.addQrCode(s)
                            }
                        }, 500), n
                    } else c.saveTitleJumpUrl(s, r)
                }, o.constructor.prototype.getLinkPreData = function() {
                    var e = 0,
                        o = "",
                        n = "",
                        i = "",
                        a = { _ltype: e, _lide: o, _lname: n, _target: i, _moduleType: 1 };
                    if (u) return a;
                    var r, d = l.getEventCtrl().getWindowSelection();
                    if (!d.anchorNode || !d.getRangeAt) return a;
                    r = d.getRangeAt(0);
                    var s = t(r.endContainer).find("a");
                    if (s.length <= 0 && (s = t(r.endContainer).closest("a")).length <= 0) return a;
                    for (var c = 0; c < s.length; c++) { var m = s.eq(c); if (m.attr("_lide") && null != m.attr("_lide")) { e = m.attr("_ltype"), o = m.attr("_lide"), n = m.attr("_lname"), i = m.attr("target"); break } }
                    return { _ltype: e, _lide: o, _lname: n, _target: i, _moduleType: 1 }
                }, o.constructor.prototype.getCorpTitleLinkPreData = function() { var t = s.top._titleData.jm.y; return null == s.top._titleData.jm.jName && (s.top._titleData.jm.jType = 0, s.top._titleData.jm.f = "", s.top._titleData.jm.y = 0), 1 === t ? s.top._titleData.jm.y = 2 : 0 === t && (s.top._titleData.jm.jType = 0, s.top._titleData.jm.f = "", s.top._titleData.jm.jUrl = "", s.top._titleData.jm.jName = ""), { _ltype: s.top._titleData.jm.jType || 0, _lide: s.top._titleData.jm.f || "", _lname: s.top._titleData.jm.jName, _target: 1 == s.top._titleData.jm.ot ? "_blank" : "", _moduleType: 8 } }, o.constructor.prototype.getGlobalLinkPreData = function(t, e) {
                    var o, n = 0,
                        i = "",
                        a = "",
                        r = "",
                        l = e.option,
                        d = "",
                        s = t.find("a");
                    return (l.btnModuleEdit || l.simpleTool) && (s = e.module), (o = s.length > 1 ? s.eq(0) : s).attr("_lide") && null != o.attr("_lide") && (n = o.attr("_ltype"), i = o.attr("_lide"), a = o.attr("_lname"), r = o.attr("target"), d = o.attr("href")), { _ltype: n, _lide: i, _lname: a, _target: r, _moduleType: 1, _lurl: d }
                }
            })
        }, this.getUICtrl = function() { return o || (o = new function() { this.constructor.prototype.createBtnToolDom = function(t) { return _EditBtnBase.getUICtrl().createBtnToolDom(t) } }) }
    };
    _EditLineHeightBtn = new function() {
        var e, o, n = this;
        this.getEventCtrl = function() {
            return e || (e = new function() {
                var e;
                this.constructor.prototype.showLineHiehgtToolBar = function(t) {
                    var o = t.option,
                        i = t.toolbar.find(".tool-lineHeight"),
                        a = i.find(".selectDiv"),
                        r = i.find(".selectDiv span"),
                        d = i.find("." + o.css + "-formatBar");
                    return d.height() > 0 ? _EditToolBase.getEventCtrl().animateHideToolSecondPanel(o) : (d.addClass("formatBarSlideDown"), d.find(".formatDef").addClass("J_formatDef").removeClass("formatDef"), a.removeClass("selectDivNew"), a.find("span").html(a.find("span").attr("_value")), d.parent().find(".fkEditor-tool-iconNew").addClass("edTriangleOnNew"), r.attr(T, !0), clearTimeout(e), e = setTimeout(function() { l.getEventCtrl().setNodeRange(r[0]) }, 300), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(o, BtnCommand.LineHeight)), n
                }, this.constructor.prototype.bindLineHeihgtSliderBarEvent = function(e) {
                    var o, n = e.option,
                        i = e.editor,
                        a = e.toolbar,
                        r = e.module,
                        d = a.find(".tool-lineHeight"),
                        s = d.find(".selectDiv span"),
                        c = d.find("." + n.css + "-formatBar");
                    _SelectedTool.getEventCtrl().bindMousewheelAndSlideEvent({ formatbar: c, toolbar: a }), _SelectedTool.getEventCtrl().bindInputEvent({ element: s, command: BtnCommand.LineHeight, editor: i, btn: d, option: n, module: r }), c.find("a").click(function(e) { return _EditToolBase.getEventCtrl().editToolLogDog({ module: r, command: BtnCommand.ChooseLineHeight }), s.attr(T, !1), l.getEventCtrl().getWindowSelection().removeAllRanges(), f && (e.stopPropagation(), l.getEventCtrl().setSelectRange(i.data(E.Range))), o = t(this).attr(n.css + "-formatName").replace("px", ""), d.find(".selectDiv span").attr("_value", o).html(o), l.getEventCtrl().setTagStyle({ styleName: "line-height", styleValue: t(this).attr(n.css + "-formatval"), editor: i, notCreateNewNode: !0, createNewNodeAction: !0 }), l.getEventCtrl().setTagStyle({ styleName: "display", styleValue: "inline-block", editor: i, notCreateNewNode: !0, createNewNodeAction: !0 }), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n), !1 }).hover(function() { c.find(".formatDef").removeClass("formatDef"), t(this).addClass("formatDef") })
                }
            })
        }, this.getUICtrl = function() { return o || (o = new function() { this.constructor.prototype.createBtnToolDom = function(t) { var e; return t.selectedData = t.option.EditLineHeightBtn.selectedData, t.reSetUnselectable = " ", e = _SelectedTool.getUICtrl().createSelectedSlideToolDom(t), delete t.reSetUnselectable, e } }) }
    };
    _EditUnderlineBtn = new function() {
        var t;
        this.getEventCtrl = function() {}, this.getUICtrl = function() { return t || (t = new function() { this.constructor.prototype.createBtnToolDom = function(t) { return _EditBtnBase.getUICtrl().createBtnToolDom(t) } }) }
    };
    _EditWritingModeBtn = new function() {
        var e, o, n = this;
        this.getEventCtrl = function() {
            return e || (e = new function() {
                var e = this;
                e.constructor.prototype.showWritingModePanel = function(t) {
                    var e = t.option,
                        o = t.toolbar.find(".tool-writingMode"),
                        i = o.find("." + e.css + "-formatBar"),
                        a = o.find(".selectDiv");
                    return i.height() > 0 ? _EditToolBase.getEventCtrl().animateHideToolSecondPanel(e) : (i.addClass("writingModeSlideDown formatBarSlideDown"), i.find(".formatDef").addClass("J_formatDef").removeClass("formatDef"), i.find(".writingMode").removeClass("horizontalHover verticalToRightHover verticalToLeftHover"), a.removeClass("selectDivNew"), i.parent().find(".fkEditor-tool-iconNew").addClass("edTriangleOnNew"), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(e, BtnCommand.WritingMode)), n
                }, e.constructor.prototype.adjustWritingModeState = function(t) {
                    var e = t.toolbar,
                        o = (t.option.moduleId, t.option),
                        i = t.editor,
                        a = e.find(".tool-textAlign");
                    return i.hasClass("fk-editor-vertical-rl") || i.hasClass("fk-editor-vertical-lr") ? (e.find(".tool-lineHeight").find(".selectDiv span").addClass("lrLineHeight-tool-icon"), a.find(".selectDiv span").addClass("lrTextAlign-tool-icon"), a.find("." + o.css + "-formatBarNew").addClass("lrTextAlign"), a.find(".justifyLeft .fkEditor-tool-icon").addClass("lrTextAlignLeft-tool-icon"), a.find(".justifyLeft").parent().find(".formatMg").text("上对齐"), a.find(".justifyCenter .fkEditor-tool-icon").addClass("lrTextAlignCenter-tool-icon"), a.find(".justifyRight .fkEditor-tool-icon").addClass("lrTextAlignRight-tool-icon"), a.find(".justifyRight").parent().find(".formatMg").text("下对齐"), a.find(".justifyFull .fkEditor-tool-icon").addClass("lrTextAlignFull-tool-icon"), e.find(".tool-writingMode").find(".fkEditor-tool-icon").addClass("lrWritingMode-tool-icon")) : (e.find(".tool-lineHeight").find(".selectDiv span").removeClass("lrLineHeight-tool-icon"), a.find(".selectDiv span").removeClass("lrTextAlign-tool-icon"), a.find("." + o.css + "-formatBarNew").removeClass("lrTextAlign"), a.find(".justifyLeft .fkEditor-tool-icon").removeClass("lrTextAlignLeft-tool-icon"), a.find(".justifyLeft").parent().find(".formatMg").text("左对齐"), a.find(".justifyCenter .fkEditor-tool-icon").removeClass("lrTextAlignCenter-tool-icon"), a.find(".justifyRight .fkEditor-tool-icon").removeClass("lrTextAlignRight-tool-icon"), a.find(".justifyRight").parent().find(".formatMg").text("右对齐"), a.find(".justifyFull .fkEditor-tool-icon").removeClass("lrTextAlignFull-tool-icon"), e.find(".tool-writingMode").find(".fkEditor-tool-icon").removeClass("lrWritingMode-tool-icon")), n
                }, e.constructor.prototype.switchWritingMode = function(t, o) {
                    var i = t.option,
                        a = t.module,
                        r = (t.toolbar, i.moduleId),
                        l = t.editor,
                        d = a.width(),
                        s = a.height(),
                        u = l.hasClass("fk-editor-vertical-rl") || l.hasClass("fk-editor-vertical-lr"),
                        m = !l.hasClass("fk-editor-vertical-rl") && !l.hasClass("fk-editor-vertical-lr"),
                        f = a.find(".J_resizableTip");
                    return 0 == l.length ? n : m && "horizontal" == o || l.hasClass("fk-editor-vertical-rl") && "verticalToLeft" == o || l.hasClass("fk-editor-vertical-lr") && "verticalToRight" == o ? n : (a.css(_defineProperty({ "min-width": "", "min-height": "", "max-height": "" }, "max-height", "")).find(".fk-editor").css(_defineProperty({ "min-width": "", "min-height": "", "max-height": "" }, "max-height", "")), "horizontal" == o ? (l.removeClass("fk-editor-vertical-rl fk-editor-vertical-lr"), a.data(E.OldVHeight, s), a.css("width", (a.data(E.OldHwidth) || 521) + "px"), l.css("width", a.width() + "px"), a.css({ "max-height": "" }).find(".fk-editor").css({ "max-height": "" }), a.css({ "min-height": "40px", "min-width": "10px", "max-width": "1200px" }).find(".fk-editor").css({ "min-height": "40px", "min-width": "10px", "max-width": "1200px" }), c.absModuleAutoHeight(r.replace("module", ""))) : (l.removeClass("fk-editor-vertical-rl fk-editor-vertical-lr"), "verticalToLeft" == o ? l.addClass("fk-editor-vertical-rl").attr("_autowidth", 1) : "verticalToRight" == o && l.addClass("fk-editor-vertical-lr").attr("_autowidth", 1), f.attr({ _faiscoTip: "还原模块默认宽度", onclick: "Site.simpleTextAutoWidth('" + r + "');return false;" }), u || (a.data(E.OldHwidth, d), a.css({ "max-width": "" }).find(".fk-editor").css({ "max-width": "" }), a.css({ "min-width": "40px", "min-height": "10px", "max-height": "1200px" }).find(".fk-editor").css({ "min-width": "40px", "min-height": "10px", "max-height": "1200px" }))), e.adjustWritingModeState(t), u || (l.height(), a.css("height", (a.data(E.OldVHeight) || 220) + "px"), l.css("height", (a.data(E.OldVHeight) || 220) + "px"), c.simpleTextAutoWidth(r)), 0 != a.attr("_inpack") && (a.find(".fk-editor-vertical-rl").attr("_autowidth", 1), a.find(".fk-editor-vertical-lr").attr("_autowidth", 1)), c.createSimpleTextAutoWidthBtn(a), void c.resizeModule.init(a))
                }, e.constructor.prototype.writtingModeEmphasize = function(t) {
                    t.editor;
                    var e = t.toolbar,
                        o = t.command,
                        i = e.find(".tool-writingMode").find(".selectDiv");
                    switch (o) {
                        case BtnCommand.Horizontal:
                            i.removeClass("selectVerticalToRight selectVerticalToLeft");
                            break;
                        case BtnCommand.VerticalToRight:
                            i.addClass("selectVerticalToRight").removeClass("selectVerticalToLeft");
                            break;
                        case BtnCommand.VerticalToLeft:
                            i.addClass("selectVerticalToLeft").removeClass("selectVerticalToRight")
                    }
                    return n
                }, e.constructor.prototype.bindWrittingModeSliderBarEvent = function(o) {
                    var n, i, a = o.option,
                        r = o.editor,
                        d = o.toolbar,
                        s = o.module,
                        u = d.find(".tool-writingMode").find("." + a.css + "-formatBar");
                    u.find(".fkEditor-formatSlidebg").remove(), u.find(".fkEditor-formatSlider").remove(), u.find("a").click(function(i) { return f && (i.stopPropagation(), l.getEventCtrl().setSelectRange(r.data(E.Range))), n = t(this).attr(a.css + "-formatval"), _EditToolBase.getEventCtrl().editToolLogDog({ module: s, command: n }), e.constructor.prototype.switchWritingMode(o, n), e.constructor.prototype.writtingModeEmphasize({ editor: r, toolbar: d, command: n }), c.simpleTextSetCgData(a.moduleId), l.getEventCtrl().setSelection(n), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(a), !1 }).hover(function() {
                        switch (i = t(this), u.find(".formatDef").removeClass("formatDef"), u.find(".writingMode").removeClass("horizontalHover verticalToRightHover verticalToLeftHover"), i.addClass("formatDef"), n = i.attr(a.css + "-formatval")) {
                            case BtnCommand.Horizontal:
                                i.find(".writingMode").addClass("horizontalHover");
                                break;
                            case BtnCommand.VerticalToRight:
                                i.find(".writingMode").addClass("verticalToRightHover");
                                break;
                            case BtnCommand.VerticalToLeft:
                                i.find(".writingMode").addClass("verticalToLeftHover")
                        }
                    })
                }
            })
        }, this.getUICtrl = function() { return o || (o = new function() { this.constructor.prototype.createBtnToolDom = function(t) { return t.selectedData = t.option.EditWritingModeBtn.selectedData, _SelectedTool.getUICtrl().createSelectedSlideToolDom(t) } }) }
    };
    _EditTextAlignBtn = new function() {
        var e, o, n = this;
        this.getEventCtrl = function() {
            return e || (e = new function() {
                var e = this;
                e.constructor.prototype.showTextAlignBtnPanel = function(t) {
                    var e = t.option,
                        o = t.toolbar.find(".tool-textAlign"),
                        i = o.find("." + e.css + "-formatBar"),
                        a = o.find(".selectDiv");
                    return i.height() > 0 ? _EditToolBase.getEventCtrl().animateHideToolSecondPanel(e) : (a.removeClass("selectDivNew"), i.find(".formatDef").addClass("J_formatDef").removeClass("formatDef"), i.find(".justify").removeClass("justifyLeftHover justifyCenterHover justifyRightHover justifyFullHover"), i.parent().find(".fkEditor-tool-iconNew").addClass("edTriangleOnNew"), i.addClass("textAlignSlideDown formatBarSlideDown"), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(e, BtnCommand.TextAlign)), n
                }, e.constructor.prototype.textAlignEmphasize = function(t) {
                    t.editor;
                    var e = t.toolbar,
                        o = t.command,
                        i = e.find(".tool-textAlign").find(".selectDiv");
                    switch (o) {
                        case BtnCommand.JustifyLeft:
                            i.removeClass("selectJustifyCenter selectJustifyRight selectJustifyFull");
                            break;
                        case BtnCommand.JustifyCenter:
                            i.addClass("selectJustifyCenter").removeClass("selectJustifyRight selectJustifyFull");
                            break;
                        case BtnCommand.JustifyRight:
                            i.addClass("selectJustifyRight").removeClass("selectJustifyCenter selectJustifyFull");
                            break;
                        case BtnCommand.JustifyFull:
                            i.addClass("selectJustifyFull").removeClass("selectJustifyCenter selectJustifyRight")
                    }
                    return n
                }, e.constructor.prototype.bindTextAlignSliderBarEvent = function(o) {
                    var n, i, a = o.option,
                        r = o.editor,
                        d = o.module,
                        s = o.toolbar,
                        c = s.find(".tool-textAlign").find("." + a.css + "-formatBar");
                    c.find("a").click(function(o) { return f && (o.stopPropagation(), l.getEventCtrl().setSelectRange(r.data(E.Range))), n = t(this).attr(a.css + "-formatval"), _EditToolBase.getEventCtrl().editToolLogDog({ module: d, command: n }), e.constructor.prototype.textAlignEmphasize({ editor: r, toolbar: s, command: n }), l.getEventCtrl().setSelection(n), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(a), !1 }).hover(function() {
                        switch (i = t(this), c.find(".formatDef").removeClass("formatDef"), c.find(".justify").removeClass("justifyLeftHover justifyCenterHover justifyRightHover justifyFullHover"), i.addClass("formatDef"), n = i.attr(a.css + "-formatval")) {
                            case BtnCommand.JustifyLeft:
                                i.find(".justify").addClass("justifyLeftHover");
                                break;
                            case BtnCommand.JustifyCenter:
                                i.find(".justify").addClass("justifyCenterHover");
                                break;
                            case BtnCommand.JustifyRight:
                                i.find(".justify").addClass("justifyRightHover");
                                break;
                            case BtnCommand.JustifyFull:
                                i.find(".justify").addClass("justifyFullHover")
                        }
                    })
                }
            })
        }, this.getUICtrl = function() { return o || (o = new function() { this.constructor.prototype.createBtnToolDom = function(t) { return t.selectedData = t.option.EditTextAlignBtn.selectedData, _SelectedTool.getUICtrl().createSelectedSlideToolDom(t) } }) }
    };
    _EditRemoveFormatBtn = new function() {
        var t;
        this.getEventCtrl = function() {}, this.getUICtrl = function() { return t || (t = new function() { this.constructor.prototype.createBtnToolDom = function(t) { return _EditBtnBase.getUICtrl().createBtnToolDom(t) } }) }
    };
    _EditorOuterFunc = new function() {
        var t, e;
        this.getEventCtrl = function() {
            if (t) return t;
            var e = function(t) {
                function e() { return t.apply(this, arguments) }
                return e.toString = function() { return t.toString() }, e
            }(function() { this.constructor.prototype.getOuterFunc = function() { return e = { fkEditorSetLink: _EditLinkBtn.getEventCtrl().fkEditorSetLink, simpleTextColorInputHexStatus: _EditColorBtn.getEventCtrl().simpleTextColorInputHexStatus, simpleTextFormatPasteData: _EditorBase.getEventCtrl().simpleTextFormatPasteData, deleteOrHideToolBar: _EditToolBase.getEventCtrl().deleteOrHideToolBar, animateHideToolSecondPanel: _EditToolBase.getEventCtrl().animateHideToolSecondPanel } } });
            return t = new e
        }, this.getUICtrl = function() { return e || (e = new func) }
    };

    function k(t) { s.top.Site.getModuleAttrPattern(t).changed = !0, c.styleChanged() }
    _FkEditor = new function() {
        var e, n, i = this;
        this.getEventCtrl = function() {
            return e || (e = new function() {
                var e, n, i, a = "keypress.fkeditorClick keyup.fkeditorClick keydown.fkeditorClick drop.fkeditorClick cut.fkeditorClick copy.fkeditorClick paste.fkeditorClick DOMCharacterDataModified.fkeditorClick DOMSubtreeModified.fkeditorClick";
                this.constructor.prototype.bindEditorEvent = function(r) {
                    var c = r.option,
                        u = r.module,
                        m = r.editor,
                        f = r.toolbar,
                        p = m.find(".editTip");
                    emphasize = c.css + "-tool-depressedNew", emphasizeHover = c.css + "-tool-depressedNewHover", emphasizeShow = c.css + "-tool-depressedNewShow", p.unbind("click.editTipbutton").bind("click.editTipbutton", function() { m.focus() }), m.data(E.EditorEventBind) || (m.data(E.EditorEventBind, !0), m.unbind(a).bind(a, function(e) { if (t(this).trigger("change"), c.btnModuleEdit && 13 == e.which) return !1 }).unbind("change.fkeditorClick").bind("change.fkeditorClick", function() { m.data(E.ChangeCount) > c.changeCount && (m.data(E.SetPageChange) && 0 === s.top._changeStyleNum && m.data(E.SetPageChange, !1), c.pageChangeFun && "" != c.pageChangeFun && !m.data(E.SetPageChange) && m.find(".editTip").length <= 0 && (clearTimeout(e), e = setTimeout(function() { m.data(E.SimpleTextEdit) || "" != m.data(E.PreHtmlContent) || m.data(E.PreHtmlContent, m.html()), m.data(E.PreHtmlContent) != m.html() && (m.data(E.SetPageChange, !0), s.fkEval(c.pageChangeFun)) }, 200)), !c.btnModuleEdit && _EditorBase.getEventCtrl().refeshEidtorHeight(r)), (t(this).hasClass("fk-editor-vertical-rl") || t(this).hasClass("fk-editor-vertical-lr")) && "1" == t(this).attr("_autoWidth") && setTimeout(function() { u.css("width", t(this).width() + "px") }.bind(this), 0), m.data(E.ChangeCount, parseInt(m.data(E.ChangeCount)) + 1), m.data(E.RemoveUselessChildIng) || m.data(E.HasRemoveUselessChild, !1), clearTimeout(i), i = setTimeout(function() { _EditToolBase.getEventCtrl().calcuToolBarPos(r) }, 300) }).unbind("click.fkeditorClick").bind("click.fkeditorClick", function(t) { _EditColorBtn.getEventCtrl().backTextSelectedStatus(r), _EditToolBase.getEventCtrl().animateHideToolSecondPanel(c), !c.btnModuleEdit && _EditorBase.getEventCtrl().refeshEidtorHeight(r), _EditorBase.getEventCtrl().logEditorSingleClick(r), _EditorBase.getEventCtrl().stopBannerJump({ clickEvent: t }) }).unbind("mouseover.fkeditorClick").bind("mouseover.fkeditorClick", function() { _EditToolBase.getEventCtrl().showToolBar(r) }).unbind("mouseleave.fkeditorClick").bind("mouseleave.fkeditorClick", function() { u.data(E.HoverToolOn, !1), m.data(E.HasRefreshClick) && l.getEventCtrl().getSelectText(m, !1) }).unbind("mousedown.fkeditorClick").bind("mousedown.fkeditorClick", function(t) { 0 == t.button && (u.data(E.Mousemove, !1), u.data(E.Mousedown, !0), u.data(E.ScreenX, t.screenX), u.data(E.ScreenY, t.screenY), setTimeout(function() { _EditToolBase.getEventCtrl().animateHideToolSecondPanel(c), _EditBtnBase.getEventCtrl().buttonEmphasize(r) }, 100), m.data(E.HasRefreshClick, !0)) }).unbind("mousemove.fkeditorClick").bind("mousemove.fkeditorClick", function(t) {
                        if (u.data(E.Mousedown) && u.data(E.ScreenX) > 0) {
                            var e = t.screenX,
                                o = t.screenY;
                            Math.pow(u.data(E.ScreenX) - e, 2) + Math.pow(u.data(E.ScreenY) - o, 2) > 1 && u.data(E.Mousemove, !0)
                        }
                    }).unbind("mouseup.fkeditorClick").bind("mouseup.fkeditorClick", function(t) {
                        if (0 == t.button) {
                            var e = m.attr(T);
                            u.data(E.Mousemove) || 1 != e && "true" != e || (u.addClass("formLockEdit"), u.removeClass("fk-hoverModule"), m.focus().find(".editTip").remove(), clearTimeout(n), n = setTimeout(function() { _EditLinkBtn.getEventCtrl().handTagANotJump(m), m.css("cursor", "text").attr(T, !0), m.data(E.FirstChooseEditor) || (m.data(E.FirstChooseEditor, !0), d.getEventCtrl().textPositionCorrect(m), m.find(".editTip").length > 0 ? m.data(E.PreHtmlContent, "") : m.data(E.PreHtmlContent, m.html())), m.trigger("mouseover") }, 50), m.trigger("mouseover"), !c.btnModuleEdit && _EditorBase.getEventCtrl().refeshEidtorHeight(r)), u.data(E.Mousemove) || u.data(E.Mousedown, !1), u.data(E.Mousemove, !1)
                        }
                    }).unbind("keyup.fkeditorClick").bind("keyup.fkeditorClick", function() { setTimeout(function() { _EditBtnBase.getEventCtrl().buttonEmphasize(r) }, 100) }).focus(function() {
                        if (c.focusFun && "" != c.focusFun && s.fkEval(c.focusFun), h) {
                            var t = o.createRange();
                            t.selectNodeContents(m[0]), t.collapse(!1), l.getEventCtrl().setSelectRange(t)
                        }
                    }).focusout(function() { f.find(".tool"), u.data(E.Mousedown, !1), c.blurFun && "" != c.blurFun && s.fkEval(c.blurFun), m.data(E.Onfocused, !1) }))
                }
            })
        }, this.getUICtrl = function() {
            return n || (n = new function() {
                this.constructor.prototype.creatFkEditorWrapDom = function(t) {
                    var e, o = t.option,
                        n = t.element,
                        a = n.parent("." + o.css + "-wrap");
                    if (!(a.length > 0)) return n.wrap('<div class="' + o.css + '-wrap"></div>'), a = n.parent("." + o.css + "-wrap"), (e = []).push('<div id="' + o.css + "-" + o.moduleId + '" class="fk-editor fkEditor ' + o.extClasses + '" style="width:' + o.editorWidth + "; height:" + o.editorHeight + '; border:0px;" _width="' + o.editorWidth + '" _height="' + o.editorHeight + '" onpaste="Site.simpleTextFormatPasteData(event, \'' + o.moduleId + "')\" " + T + "=false >"), o.showEditTipWord ? e.push('<div class="editTip">' + o.editTipWord + "</div>") : e.push(n.html()), e.push("</div>"), a.html(e.join("")), i
                }
            })
        }
    }, c.checkSimpleTextHideTool = function(t) {
        if (0 == c.simpleTextList.checking) {
            c.simpleTextList.checking = !0;
            var e = c.hasPopupModuleOpen();
            setTimeout(function() {
                if (c.simpleTextList.allEditors)
                    for (var o, n, i, a, r, l, d, u, m, f = "", p = "", h = !1, g = !1, v = !1, C = 0; C < c.simpleTextList.allEditors.length; C++) f = c.simpleTextList.allEditors[C].moduleId, t != f && (o = s.top.$("#" + f), m = c.checkNestModule(o), e && !m.inPopupZone || ((!(n = o.find("#fkEditor-" + f)) || n.length < 1) && (n = c.simpleTextList.allEditors[C].editor), h = n.attr("contenteditable"), g = o.data("hoverToolOn"), v = o.data("mousedown"), (i = s.top.$("#fkEditor-toolBar-" + f)).find(".fkEditor-linkSlideBar"), _EditToolBase.getEventCtrl().isShowHoverToolPanel(i) ? (_EditToolBase.getEventCtrl().deleteOrHideToolBar(n.data("option")), o.data(E.Mousedown, !1)) : (g || v || "true" != h || (u = i.find(".simpleTextHoverTool"), a = i.find(".tool-formats").find(".fkEditor-formatBar"), r = i.find(".tool-fontSize").find(".fkEditor-formatBar"), fsizebarTextDiv = i.find(".tool-fontSize").find(".selectDiv"), l = i.find(".tool-lineHeight").find(".fkEditor-formatBar"), lhbarTextDiv = i.find(".tool-lineHeight").find(".selectDiv"), d = i.find(".tool-textAlign").find(".fkEditor-formatBar"), p = c.simpleTextList.colorToolShow, u.is(":visible") || a.height() > 0 || r.height() > 0 || l.height() > 0 || d.height() > 0 || p ? _EditToolBase.getEventCtrl().animateHideToolSecondPanel(n.data("option")) : _EditToolBase.getEventCtrl().deleteOrHideToolBar(n.data("option"))), o.data(E.Mousedown, !1))))
            }, 50), setTimeout(function() { c.simpleTextList.checking = !1 }, 300)
        }
    }, c.simpleTextFormatPasteData = function(t, e) {
        var o = "";
        if (c.simpleTextList.allEditors)
            for (var n = 0; n < c.simpleTextList.allEditors.length; n++)
                if (c.simpleTextList.allEditors[n].moduleId == e) { o = c.simpleTextList.allEditors[n].editor; break }
        return setTimeout(function() { _EditorBase.getEventCtrl().simpleTextFormatPasteData(o.data("editor"), "") }, 20), !0
    }, c.simpleTextSetJumpCtrl = function() {
        s.top._subNavPackEdit && c.logDog(200256, 11);
        var t = s.top.$("#jumpCtrl"),
            e = t.data("moduleId");
        if (c.simpleTextList.allEditors)
            for (var o = 0; o < c.simpleTextList.allEditors.length; o++)
                if (c.simpleTextList.allEditors[o].moduleId == e) {
                    var n = c.simpleTextList.allEditors[o].editor;
                    _EditLinkBtn.getEventCtrl().fkEditorSetLink({ editor: n.data("editor"), option: n.data("option"), jumpCtrl: t, isGloableLink: !1 });
                    break
                }
    }, c.simpleTextSetTextColor = function(t, e) {
        var o = c.simpleTextList.chooseEditor;
        o && _EditColorBtn.getEventCtrl().simpleTextColorInputHexStatus({ state: 2, editor: o.data("editor"), option: o.data("option"), color: t, rgbaColor: e })
    }, c.simpleTextColoronShowStatus = function(t) {
        var e = 1 == t;
        c.simpleTextList.colorToolShow = e, setTimeout(function() { c.simpleTextList.colorToolShow = !e }, 200)
    }, c.simpleTextShowGlobalJumpCtrl = function(t, e) {
        e = { showFullMeasure: !0, inputId: "jumpHref" + t, jumpCusId: "jumpCtrl" + t, moduleType: e._moduleType, jumpType: e._ltype, jumpIde: e._lide, jumpName: e._lname, jumpTarget: e._target, showWeixinService: !0 };
        c.jumpControl(e)
    }, c.saveTitleJumpUrl = function(t, e) {
        if (!(t.length < 1)) {
            var o = s.top._titleData,
                n = s.top.$("#corpTitle"),
                a = t.attr("_lurl"),
                r = t.attr("_linkdeleteclick"),
                l = parseInt(t.attr("_ltype"));
            if (_typeof(a) != i || r) return o.jm.ot = 108 == l ? 0 : "_blank" == t.attr("target") ? 1 : 0, null != a ? (o.jm.f = t.attr("_lide"), o.jm.jType = l, o.jm.jUrl = a, o.jm.y = 2, o.jm.jName = 2 === l || 103 === l ? a : t.attr("_lname") || o.jm.jName, n.attr("_href", a), n.css("cursor", "pointer")) : (o.jm.jType = 0, o.jm.f = "", o.jm.y = 0, n.removeAttr("_href"), n.css("cursor", "move")), s.top._titleChanged++, c.styleChanged(), e.attr(T, !1), !0
        }
    }, c.simpleTextSaveJumpCtrl = function(t) {
        var e = s.top.$("#jumpCtrl" + t);
        if (!c.simpleTextList.allEditors) return !1;
        for (var o = 0; o < c.simpleTextList.allEditors.length; o++)
            if (c.simpleTextList.allEditors[o].moduleId == t) { var n = c.simpleTextList.allEditors[o].editor; return _EditLinkBtn.getEventCtrl().fkEditorSetLink({ editor: n.data("editor"), option: n.data("option"), jumpCtrl: e, isGloableLink: !0 }), s.top.$("#fkEditor-" + t).attr(T, !1), !0 }
        return !1
    }, c.simpleTextShowJumpCtrl = function(t, e) {
        s.top.$("#jumpCtrl").remove();
        e = { showFullMeasure: !0, inputId: "simpleTextLinkInputVal-" + t, moduleType: e._moduleType, jumpType: e._ltype, jumpIde: e._lide, jumpName: e._lname, jumpTarget: e._target, setPageChange: c.simpleTextSetJumpCtrl, showWeixinService: !0 };
        c.jumpControl(e), setTimeout(function() { s.top.$("#jumpCtrl").data("moduleId", t).click() }, 300)
    }, t(function() {
        t(s.top.document.body).children().unbind("click.simpleTextBodyClick").bind("click.simpleTextBodyClick", function(t) { 0 == t.button && c.checkSimpleTextHideTool() }), t(s.top.document).live("mouseup.simpleTextScrollingMouseup", function() {
            var e = t(".J_fkSingleTool");
            e.length <= 0 && !e.data(ToolAttr.Scrolling) || setTimeout(function() { e.data(ToolAttr.Scrolling, !1) }, 0)
        })
    }), t.fn.fkEditor = function(e) {
        var o, n, i = t.extend({
                moduleId: "module0",
                editorName: "",
                css: "fkEditor",
                endCheckClass: "fkEditor-wrap",
                editSignClass: "fk-c-",
                btnModuleEdit: !1,
                simpleTool: !1,
                tipTitle: !1,
                editorWidth: "200px",
                editorHeight: "60px",
                defultContent: "",
                showEditTipWord: !1,
                editTipWord: "双击输入内容...",
                changeCount: 1,
                systemModule: "",
                extClasses: "",
                toolExtClasses: "",
                isSystemModule: !1,
                toolBarWidth: "154px",
                changeFun: "",
                focusFun: "",
                blurFun: "",
                pageChangeFun: "",
                deleteFun: "",
                jumpCtrlFun: "",
                globalJumpCtrlFun: "",
                saveGlobalJumpCtrlFun: "",
                cancelGlobalJumpCtrlFun: "",
                animationFun: "",
                editModuleFun: "",
                positionFixedFun: "",
                logoDisplayFun: "",
                EditContentBtn: { name: "编辑文本" },
                EditFormatsBtn: {
                    name: "字体",
                    selectedData: [
                        ["宋体, SimSun, STSong", "宋体"],
                        ["新细明体, PMingLiU", "新细明体"],
                        ["仿宋_GB2312, FangSong_GB2312, FangSong", "仿宋_GB2312"],
                        ["微软雅黑, Microsoft YaHei", "微软雅黑"],
                        ["Arial, 微软雅黑", "Arial"],
                        ["隶书, SimLi, LiSu, STLiti", "隶书"],
                        ["幼圆, YouYuan", "幼圆"],
                        ["华文楷体, STKaiti", "华文楷体"],
                        ["方正舒体, FZShuTi", "方正舒体"],
                        ["华文行楷, STXingkai", "华文行楷"],
                        ["华文彩云, STCaiyun", "华文彩云"],
                        ["华文宋体, STSong", "华文宋体"],
                        ["楷体,楷体_GB2312, SimKai, KaiTi", "楷体"],
                        ["黑体, SimHei, STHeiti", "黑体"],
                        ["Tahoma, 微软雅黑", "Tahoma"],
                        ["impact, 微软雅黑", "impact"],
                        ["Arial Serif, 微软雅黑", "Arial Serif"],
                        ["Times New Roman, 微软雅黑", "Times New Roman"],
                        ["Georgia, 微软雅黑", "Georgia"],
                        ["Garamond, 微软雅黑", "Garamond"],
                        ["andale mono, 微软雅黑", "andale mono"],
                        ["arial black, avant garde, 微软雅黑", "arial black"],
                        ["comic sans ms, 微软雅黑", "comic sans ms"],
                        ["思源黑体 CN Light, Source Han Sans CN, 微软雅黑", "思源黑体 Light", "", "needTip"],
                        ["思源黑体 CN Medium, Source Han Sans CN, 微软雅黑", "思源黑体 Medium", "", "needTip"],
                        ["思源黑体 CN Heavy, Source Han Sans CN, 微软雅黑", "思源黑体 Heavy", "", "needTip"],
                        ["思源宋体 CN Light, Source Han Serif SC, 微软雅黑", "思源宋体 Light", "", "needTip"],
                        ["思源宋体 CN Medium, Source Han Serif SC, 微软雅黑", "思源宋体 Medium", "", "needTip"],
                        ["思源宋体 CN Heavy, Source Han Serif SC, 微软雅黑", "思源宋体 Heavy", "", "needTip"],
                        ["站酷高端黑, 微软雅黑", "站酷高端黑", "", "needTip"],
                        ["站酷酷黑, 微软雅黑", "站酷酷黑", "", "needTip"],
                        ["站酷快乐体2016修订版, 微软雅黑", "站酷快乐体", "", "needTip"],
                        ["庞门正道标题体, 微软雅黑", "庞门正道标题体", "", "needTip"],
                        ["站酷小薇LOGO体, 微软雅黑", "站酷小薇", "", "needTip"],
                        ["'ZCOOL Addict 01', 微软雅黑", "ZCOOL Addict Italic 01", "", "needTip"],
                        ["'ZCOOL Addict 02', 微软雅黑", "ZCOOL Addict Italic 02", "", "needTip"]
                    ]
                },
                EditFontSizeBtn: {
                    name: "大小",
                    selectedData: [
                        ["12px", "12px"],
                        ["14px", "14px"],
                        ["16px", "16px"],
                        ["18px", "18px"],
                        ["20px", "20px"],
                        ["24px", "24px"],
                        ["30px", "30px"],
                        ["36px", "36px"],
                        ["48px", "48px"],
                        ["60px", "60px"],
                        ["72px", "72px"],
                        ["84px", "84px"],
                        ["96px", "96px"],
                        ["108px", "108px"],
                        ["120px", "120px"]
                    ]
                },
                EditLineHeightBtn: {
                    name: "行高",
                    selectedData: [
                        ["12px", "12px"],
                        ["14px", "14px"],
                        ["16px", "16px"],
                        ["18px", "18px"],
                        ["20px", "20px"],
                        ["24px", "24px"],
                        ["30px", "30px"],
                        ["36px", "36px"],
                        ["48px", "48px"],
                        ["60px", "60px"],
                        ["72px", "72px"],
                        ["84px", "84px"],
                        ["96px", "96px"],
                        ["108px", "108px"],
                        ["120px", "120px"]
                    ]
                },
                EditTextAlignBtn: {
                    name: "对齐方式",
                    selectedData: [
                        ["justifyLeft", "左对齐", "justify justifyLeft"],
                        ["justifyCenter", "居中对齐", "justify justifyCenter"],
                        ["justifyRight", "右对齐", "justify justifyRight"],
                        ["justifyFull", "两端对齐", "justify justifyFull"]
                    ]
                },
                EditWritingModeBtn: {
                    name: "文字排列方式",
                    selectedData: [
                        ["horizontal", "横向排列", "writingMode horizontal"],
                        ["verticalToRight", "垂直向右", "writingMode verticalToRight"],
                        ["verticalToLeft", "垂直向左", "writingMode verticalToLeft"]
                    ]
                },
                HoverTool: { show: !0, width: "154px", animationShowWidth: "186px", height: "42px", ToolBtnOrder: ["EditContentBtn", "EditSeperatorBtn", "EditAnimationBtn", "EditGlobalLinkBtn", "EditDeleteBtn"] },
                Tool: { show: !0, width: "315px", height: "82px", ToolBtnOrder: ["EditColorBtn", "EditFormatsBtn", "EditFontSizeBtn", "EditBreakLineBtn", "EditBoldBtn", "EditItalicBtn", "EditUnderlineBtn", "EditSeperatorBtn", "EditWritingModeBtn", "EditLineHeightBtn", "EditTextAlignBtn", "EditSeperatorBtn", "EditLinkBtn", "EditRemoveFormatBtn"] }
            }, e),
            a = t(this),
            r = _EditorBase.getEventCtrl().getModule({ option: i });
        if (r && !(r.length <= 0)) return p && i.changeCount++, i.btnModuleEdit ? ((!(o = r.find("#" + i.moduleId + "FlBtn")) || o.length <= 0) && (o = r.find(".J_floatBtnBox .floatBtn")), n = o, _EditorBase.getEventCtrl().bindAllEvent({ option: i, module: r, editor: o, fkEditorWrap: n })) : i.simpleTool ? ((o = r).data(E.SimpleTextEdit, !1), _EditorBase.getEventCtrl().bindSimpleToolAllEvent({ option: i, module: r, editor: o })) : (_FkEditor.getUICtrl().creatFkEditorWrapDom({ option: i, element: a }), o = t("#" + i.css + "-" + i.moduleId), n = a.parent("." + i.css + "-wrap"), _EditorBase.getEventCtrl().bindAllEvent({ option: i, module: r, editor: o, fkEditorWrap: n })), o.data(E.ScrollChangeChecking, !1), o.data(E.Onfocused, !1), o.data(E.SetPageChange, !1), o.data(E.LinkHasClick, !1), o.data(E.ClearSpanCursoring, !1), o.data(E.HasRefreshClick, !1), o.data(E.PreHtmlContent, ""), o.data(E.HasRsChildStyle, 0), o.data(E.EditSignClass, i.editSignClass), o.data(E.SignClassNum, 1), o.data(E.ChangeCount, 0), o.data(E.FirstChooseEditor, !1), o.data(E.HasRemoveUselessChild, !0), o.data(E.RemoveUselessChildIng, !1), o.data(E.EndCheckClass, i.endCheckClass), o.data(E.EditorEventBind, !1), o.data(E.Option, i), o.data(E.OuterFun, _EditorOuterFunc.getEventCtrl().getOuterFunc()), o.data(E.Editor, o), c.simpleTextList.allEditors.push({ moduleId: i.moduleId, editor: o }), o
    }
}(jQuery, window, document, Fai || {}, "undefined");