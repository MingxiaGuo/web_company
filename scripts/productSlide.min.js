Site.productSlide={},function(t,e,a){var n,s,o,l,r,u,p,c,d,m,f,h,g=-1,v=null,b="",C="",_=82,P=!0;e.data={},e.dom={},e.cachePreviewImgList=[];var w=2052==Fai.top._lcid||1028==Fai.top._lcid;function y(){var t=[];return t.push('<div class="fk-slideForProduct" id="fk-productSlidePanel" style="display:none;">'),t.push('\t<div class="f-contentBg J_contentBg J_popup_bg"></div>'),t.push('\t<div class="f-content J_content" id="fk-productSlideContent">'),t.push('\t\t<div class="f-innerContent">'),function(t){t.push('<div class="f-multiContent J_multiContent">'),function(t){t.push('<div class="f-multiContent-left J_multiContentLeft">'),function(t){t.push('<div class="f-productPicContent J_productPicContent">'),t.push('\t<div class="f-productImg J_productImg">'),t.push('\t\t<div class="f-productImgLoading"></div>'),t.push("\t</div>"),t.push('\t<div class="f-productImgGroup J_productImgGroup" style="display:none;">'),t.push('\t\t<div class="f-productImgGroupBg"></div>'),t.push('\t\t<div class="f-imgListWrap J_imgListWrap">'),t.push("\t\t</div>"),t.push('\t\t<a href="javascript:;" onclick="return false;" class="f-groupLeft J_groupLeft" hidefocus="true">向左</a>'),t.push('\t\t<a href="javascript:;" onclick="return false;" class="f-groupRight J_groupRight" hidefocus="true">向右</a>'),t.push("\t</div>"),t.push("</div>"),t.push('<div class="f-shareContent J_shareContent">'),t.push("</div>")}(t),t.push("</div>"),t.push('<div class="f-multiContent-right J_multiContentRight">'),function(t){t.push('<div class="f-productDetailContent J_productDetailContent">'),t.push("</div>"),t.push('<div class="optionMsg"></div>'),t.push('<div class="f-productBuyContent J_productBuyContent">'),t.push("</div>")}(t),t.push("</div>")}(t),t.push("</div>"),t.push('<div class="f-albumsContent J_albumsContent">'),function(t){t.push('<div class="f-albumsWrap J_albumsWrap">'),t.push("</div>"),t.push('<a href="javascript:;" onclick="return false;" class="f-albumsLeft J_albumsLeft" hidefocus="true">向左</a>'),t.push('<a href="javascript:;" onclick="return false;" class="f-albumsRight J_albumsRight" hidefocus="true">向右</a>')}(t),t.push("</div>")}(t),t.push("\t\t</div>"),t.push('\t\t<a href="javascript:;" class="f-turnLeft J_turnLeft" onclick="return false;" hidefocus="true">向右</a>'),t.push('\t\t<a href="javascript:;" class="f-turnRight J_turnRight" onclick="return false;" hidefocus="true">向左</a>'),t.push('\t\t<a href="javascript:;" class="f-close J_close" onclick="return false;" title="关闭" hidefocus="true">关闭</a>'),t.push("\t</div>"),t.push("</div>"),t}function J(e){var a,n=!1;if(null==e)return n;for(len=e.length,i=0;i<len;i++)if(a=e[i],type=a.type,value=a.value||"",!(t.trim(value).length<1)&&11==type){n=!0;break}return n}function I(){var i=e.dom;e.data;i.productDetailContent.empty(),i.productDetailContent.append(function(){if(!e.data.nowData)return"";var i,a,n,s,o,r,g=[],b=[],C=e.data.nowData,P=C.propList||[],y=(void 0!==C.saleId&&C.saleId,void 0!==C.salePromotion?C.salePromotion:[]),I="",S="",L="",F="";h=u<100&&u>1||C.actualPrice!=C.mallPrice,c?("actualPrice"in C&&(p=C.actualPrice),u="discount"in C?C.discount:100,h=u<100&&u>1||C.actualPrice!=C.mallPrice,d=!!C.indepPrice):("actualPrice"in C&&(p=C.actualPrice),p=parseFloat(p)*u*.01),null==y&&y==[]||1==J(P)&&x(y,!1)&&(h=!1,b.push('<div class="fk-saleTime J_saleProTimeCount J_saleRemove">'),b.push("<table>"),b.push("<tr>"),b.push("<td>"),b.push('<div class="showSaleTimeImg fk-showSaleTimeImg">'),b.push("</div>"),b.push("</td>"),b.push('<td class="J_showSaleTimeClass fk-showSaleTimeStyle">'),b.push("</td>"),b.push("</tr>"),b.push("</table>"),b.push("</div>")),void 0!==C.salePromotion&&(h=!1),i=C.name,j=P.length;for(O=0;O<j;O++)if(a=(r=P[O]).name,n=r.type,r.fileId,s=r.value||"",!(t.trim(s).length<1)){if(11==n&&h?(I="g_minor mallMarketPrice f-mallPriceWrap",S="g_stress mallPriceBig f-mallPriceWrap"):I=11!=n||h?12==n?"g_minor mallMarketPrice f-mallPriceWrap":"":"g_stress mallPriceBig f-mallPriceWrap",11==n&&h?(L="",F="J_mallPriceClass"):L=11!=n||h?"":"J_mallPriceClass",b.push('<div class="f-propContent '+L+'">'),b.push('<div class="f-propName" title="'+a+'" style="width:'+_+'px">'+a+'<span class="f-colon">:</span></div>'),b.push('<div class="f-propValue '+I+'">'),11==n)if(b.push('\t<span class="f-currencyVal">'+l.choiceCurrencyVal+"</span>"),h){b.push('\t<span class="mallPrice J_realMallAmount">'+(w?s:Fai.formatPriceEn(s))+"</span>"),b.push("\t</div>"),b.push("</div>"),b.push('<div class="f-propContent '+F+'">'),b.push('<div class="f-propName" title="'+a+'" style="width:'+_+'px">'+m+'<span class="f-colon">:</span></div>'),b.push('<div class="f-propValue '+S+'">'),b.push('<span class="f-currencyVal">'+l.choiceCurrencyVal+"</span>");var k="";if(s.indexOf("~")>=0)if(d)k=p;else{var D=s.split("~"),B=parseFloat(D[0])*u*.01,R=parseFloat(D[1])*u*.01;k=B.toFixed(2)+"~"+R.toFixed(2)}else k=p,k=parseFloat(k).toFixed(2);b.push('<span class="f-mallPrice mallPrice" id="realMallAmount">'+(w?k:Fai.formatPriceEn(k))+"</span>"),b.push('<span class="fk-mallBuy-big memberPrice">'+(w?f:Fai.formatPriceEn(f))+"</span>")}else b.push('\t<span class="mallPrice J_realMallAmount" id="realMallAmount">'+(w?s:Fai.formatPriceEn(s))+"</span>");else 12==n?(b.push('<span class="f-currencyVal">'+l.choiceCurrencyVal+"</span>"),b.push('<span class="mallPrice">'+(w?s:Fai.formatPriceEn(s))+"</span>")):13==n?b.push('<span id="mallAmount">'+s+"</span>"):16==n?b.push('<span id="mallWeight">'+s+"</span>"+l.weightType):b.push(s);b.push("</div>"),b.push("</div>")}if(l.mallOpen){if(l.mallShoppingOptions&&"showOptionList"in C){var T=C.showOptionList||[],W=C.oldOptionsStr,j=T.length,N=C.optionsAmountList||[];h&&t.each(N,function(t,e){e.oPrice=d?p:e.oPrice*u*.01});for(var O=0;O<j;O++){var A=T[O],M=A.items,E=A.fieldKey,z=0;if(W)for(var V=W.split("_"),H=0;H<V.length;H++)E==V[H]&&(z=H);var U=M.length;if(U>0){for(b.push('<div class="f-propContent f-optionContent">'),b.push('<div class="f-propName" title="" style="width:'+_+'px">'+Fai.encodeHtml(A.name)+'<span class="f-colon">:</span></div>'),b.push('<div class="propName" style="display:none;">'+Fai.encodeHtml(A.name)+"</div>"),b.push('<div class="f-optionValue" style="width:'+(318-_)+'px">'),b.push('<ul class="optionItemWrap J_optionItemWrap" data="'+A.fieldKey+'" type="'+A.type+'">'),H=0;H<U;H++){var q=M[H],G=q.i,$=q.v,X=q.path,Z=!1;if(N)for(var K=0;K<N.length;K++){var Y,Q=N[K],tt=Q.t2;Y="flag"in Q?Q.flag:1;var et=tt.split("_");if(1==Y&&z<et.length&&et[z]==G){Z=!0;break}}if(Z){if(b.push('<li class="optionItem">'),X){b.push('<span class="img-n">'+Fai.encodeHtml($)+"</span>");var it=q.orgPic;it?b.push('<img class="i-img J-item J-item-img" src="'+X+'" data="'+G+'" _fk-org="'+it+'" faiWidth="'+q.faiWidth+'" faiHeight="'+q.faiHeight+'"/>'):b.push('<img class="i-img J-item J-item-img" src="'+X+'" data="'+G+'"/>')}else b.push('<a class="J-item oItem" href="javascript:;" hidefocus="true" data="'+Fai.encodeHtmlAttr(G)+'">'),b.push("<span>"+Fai.encodeHtml($)+"</span>"),b.push("</a>");b.push('</li">')}}b.push("</ul>"),b.push("</div>"),b.push("</div>")}}}if(!v.hiddenBuybtn){var at=1,nt="",st="";if(C.limitAmount_mall){var ot=0,lt=C.productRestrictInfo;lt&&lt.count&&(ot=lt.count);var rt=0,ut=C.minAmount,pt=C.maxAmount;rt=pt-ot,Fai.fkEval(rt)<0&&(rt=-1),ut>1&&0!=pt?(st="( "+LS.minAmount+" : "+ut+" ; "+LS.maxAmount+" : "+rt+" )",nt=' _min="'+ut+'" _max="'+rt+'" '):1==ut&&0!=pt?(st="("+LS.maxAmount+" : "+rt+" )",nt='" _max="'+rt+'" '):ut>1&&0==pt&&(st="( "+LS.minAmount+" : "+ut+")",nt=' _min="'+ut+'" '),at=ut}b.push('<div class="f-propContent f-countContent">'),b.push('<div class="f-propName" title="" style="width:'+_+'px">'+LS.amountNum+'<span class="f-colon">:</span></div>'),b.push('<div class="f-propValue f-countValue" style="width:'+(318-_)+'px">'),b.push('<input id="cartbuyCountPdSlide" type="text" class="f-cartCountInput" onkeypress="javascript:return Fai.isNumberKey(event);" onchange="Site.mallBuyCountChange(\'PdSlide\')" value="'+at+'" '+nt+"/>"),b.push('<div class="f-buyCountBtn">'),b.push('<span id="buyCountDesPdSlide" class="f-countBtn mallJia disableMallJian" onclick="Site.desMallBuyCount(\'PdSlide\')"></span>'),b.push('<span id="buyCountIncPdSlide" class="f-countBtn mallJian" onclick="Site.incMallBuyCount(\'PdSlide\')"></span>'),b.push("</div>"),b.push('<span id="limitAmountDiv" class="f-limitAmountDiv" title="'+st+'">'),b.push(st),b.push("</span>"),b.push("</div>"),b.push("</div>")}}return g.push('<div class="f-productNameContent">'),g.push('\t<p class="f-productName">'),v.titleClick?(o=e.data.nowData.productUrl,g.push('<a class="f-productTitle" href="'+o+'" target="_blank">'),g.push(i),g.push("</a>")):g.push(i),g.push("\t</p>"),g.push("</div>"),g.push('<div class="f-underlineContent">'),g.push('<div class="f-underline"></div>'),g.push("</div>"),g.push('<div class="f-propListContent J_productProp">'),g.push(b.join("")),g.push("</div>"),g.join("")}()),i.productBuyContent.empty(),i.productBuyContent.append(function(){if((l.mallOpen||l.bookingOpen)&&!v.hiddenBuybtn){var t=[],i=(e.dom,l.addCartText||""),a=l.buyNowText||"",n=l.addCartClickEvent||"",s=l.buyNowClickEvent||"";if(l.bookingClicEvent,l.mallOpen)t.push('<div class="f-buyContent">'),1==l.showShoppingCart&&t.push('\t<a href="javascript:;" onclick="'+n+'" hidefocus="true" class="fk-mall-addCart f-addCart"><span>'+i+"</span></a>"),t.push('\t<a href="javascript:;" onclick="'+s+'" hidefocus="true" class="fk-mallBuy-big f-buyNow"><span class="bug-img">&nbsp;</span><span>'+a+"</span></a>"),t.push("</div>");else if(l.bookingOpen){var o=l.bookingInfo,r="onclick=\"jzUtils.run({'name':'bookingSubmitPanel.init', 'prompt':'true'}, '{&quot;panelHeight&quot;:"+o.panelHeight+", &quot;panelWidth&quot;:"+o.panelWidth+", &quot;pid&quot;:"+Site.productSlide.data.id+"}');\"";t.push('<div class="f-buyContent">'),t.push('\t<a href="javascript:;" '+r+' hidefocus="true" class="fk-mallBuy-big f-buyNow"><span class="bug-img fk-bookingIcon">&nbsp;</span><span>'+o.bookingNameStr+"</span></a>"),t.push("</div>")}return t.join("")}}());var a=e.data.nowData;if(a){var n=a.optionsAmountList,s=a.relateAmount,o=a.mallPrice,r=a.productRestrictInfo,g=a.limitAmount_options,b=a.oldOptionsStr,C=(a.newOptionsStr,a.limitAmount_mall),P={moduleId:"PdSlide",optionsAmountList:n,relateAmount:s,realMallPrice:o,limitAmount_options:g,productRestrictInfo:r,minAmount:a.minAmount,maxAmount:a.maxAmount,limitAmount_mall:C,oldOptionsStr:b};if(Site.productDetailInfo=P,Site.initProductRestrict(),l.mallShoppingOptions&&void 0!==n){b||(b="null");var y=a.salePromotion;void 0!==y&&(Site.salePromotionDetail.salePromotionParam=y),Site.initProductOptions(),Site.initOptionsStr()}}Fai.top._manageMode&&Z()}function S(){var t=e.dom,i=e.data;nowData=i.nowData,multiContentRight=t.multiContentRight,propList=nowData.propList||[],saleId=void 0!==nowData.saleId?nowData.saleId:0,salePromotion=void 0!==nowData.salePromotion?nowData.salePromotion:[],showSaleCountDownFlag=!1,beginTime="",endTime="",l.saleShowType=1,null!=salePromotion&&salePromotion!=[]&&(showSaleMsg=!0,findPriceFlag=J(propList),1==findPriceFlag&&(showSaleCountDownFlag=x(salePromotion,!0),showSaleCountDownFlag||(multiContentRight.find(".J_saleProTimeCount").remove(),beginTime=salePromotion.beginTime,endTime=salePromotion.endTime,null!=beginTime&&""!=beginTime&&null!=endTime&&""!=endTime||F(salePromotion))))}function L(t,i,a,n){var s,o,r,u,p,c=e.dom.multiContentRight,d="",m=LS.salePromotionBegin,f=LS.salePromotionEnd,h=0;1==a?(d=m,h=t):(d=f,h=i),"2"==a&&F(n),clearInterval(l.saleCountTimeInterval),l.saleCountTimeInterval=setInterval(function(){s=parseInt(h/86400),o=parseInt(h/3600)-24*s,r=parseInt(h/60)-24*s*60-60*o,u=parseInt(h%60),h--,p=Fai.format(d,s,o,r,u),c.find(".J_showSaleTimeClass").html("&nbsp;&nbsp;"+p),h<0&&(1==a?(h=i,d=f,a=2,F(n)):(clearInterval(l.saleCountTimeInterval),c.find(".J_saleRemove").remove(),"1"==n.other.ruleData.s&&(c.find(".J_newMallPriceClass").find(".f-propValue").addClass("g_stress mallPriceBig"),c.find(".J_newMallPriceClass").find(".f-propValue").removeClass("g_minor mallMarketPrice"),c.find(".J_newMallPriceClass").find(".mallPrice").addClass("f-mallPrice"))))},1e3)}function x(t,e){var i,a,n=!1,s=t.beginTime,o=t.endTime,r=(new Date).getTime()+l.timeDiff;return void 0===s||null==s||""==s||void 0===o||null==o||""==o?n:(i=new Date(s.replace(/-/g,"/")).getTime(),a=new Date(o.replace(/-/g,"/")).getTime(),(i>r||a>r)&&(n=!0),e&&(i>r?L(parseInt((i-r)/1e3),parseInt((a-i)/1e3),1,t):a>r&&L(parseInt((i-r)/1e3),parseInt((a-r)/1e3),2,t)),n)}function F(i){if("1"==l.saleShowType){l.saleShowType=2;var a,n,s,o,r,u,p,c=[],d=[],m=e.dom.multiContentRight,f=[],h="";if(void 0!==i&&null!=i&&""!=i){var g=m.find(".J_mallPriceClass").find(".f-mallPrice").css("color");if(void 0!==g&&null!=g&&""!=g||(g="#cf0000"),"1"==i.saleType){o="",r=parseFloat(i.other.ruleData.d[0].m),u=t(".J_mallPriceClass").find(".f-propName").attr("title");var v=t(".J_mallPriceClass").find(".mallPrice").html();if(v.indexOf("~")>0){var b=v.split("~"),C=parseFloat(b[0]);isNaN(C)&&(C=0),f.push(C),C=parseFloat(b[1]),isNaN(C)&&(C=0),f.push(C)}else{C=parseFloat(v);isNaN(C)&&(C=0),f.push(C)}for(var P=0;P<f.length;P++)p=0,"1"==i.other.ruleData.s?(o=2052==Fai.top._lcid||1028==Fai.top._lcid?Fai.format(LS.salePromotionDisCount,r):Fai.format(LS.salePromotionDisCount,Fai.formatPriceEn(10*(10-r),null,!0)),p=f[P]*(r/10)):(o=2052==Fai.top._lcid||1028==Fai.top._lcid?Fai.format(LS.salePromotionLapse,r):Fai.format(LS.salePromotionLapse,Fai.formatPriceEn(r,null,!0)),p=f[P]-r),(isNaN(p)||p<0)&&(p=0),P>0&&(h+="~"),h+=p.toFixed(2)+"";t(".J_mallPriceClass").find(".f-propValue").addClass("fk-saleRelative"),d.push('<div class="f-propContent J_newMallPriceClass">'),d.push('<div class="f-propName" title="'+u+'" style="width:'+_+'px">'+u+'<span class="f-colon">:</span></div>'),d.push('<div class="f-propValue g_minor mallMarketPrice f-mallPriceWrap">'),d.push('<span class="f-currencyVal">'+l.choiceCurrencyVal+"</span>"),d.push('<span class="mallPrice">'+v+"</span>"),d.push("</div>"),d.push("</div>"),t(".J_mallPriceClass").before(d.join("")),t(".J_mallPriceClass").find(".f-propName").html(LS.promotionPrice+"<span class='f-colon'>:</span>"),t(".J_mallPriceClass").find(".mallPrice").html(h),t(".J_mallPriceClass").find(".f-propName").attr("title",LS.promotionPrice),t(".J_mallPriceClass").addClass("J_saleRemove"),c.push('<span class="fk-saleTopSet fk-saleAbsolute"><table border="0" cellspacing="0" cellpadding="0"><tr>'),c.push('<td class="fk-saleTdSty1">'),c.push('<div  class="f-trangle " style="border-bottom: 5px solid '+g+';">'),c.push("</div>"),c.push("</td>"),c.push('<td class="fk-saleTdSty2">'),c.push('<div class="f-rect" style="background-color:'+g+';"  title="'+i.name+'">'),c.push(o),c.push("</div>"),c.push("</td>"),c.push("</tr></table></span>"),t(".J_mallPriceClass").find(".f-propValue").append(c.join(""))}else{n=20*(a=i.other.ruleData.d.length)+12*(a-1)+"px",c.push('<div class="f-propContent J_saleRemove">'),c.push('<div class="f-propName" title="'+LS.salePromotionName+'" style="height:'+n+";width:"+_+'px">'+LS.salePromotionName+'<span class="f-colon">:</span></div>'),c.push('<div class="f-propValue fk-saleRelative" style="height:'+n+'">'),c.push('<span class="saleHoverDefault fk-saleAbsolute" title="'+i.name+'">');for(P=0;P<a;P++)s=0!=P?"top:"+30*P+"px":"top:0",c.push('<span class="fk-saleAbsolute" style="'+s+'">'),c.push('<span class="saleFullReBg" style="margin:0;background-color:'+g+';">'),c.push(Fai.format(LS.salePromotionOnlyFullReduce)),c.push("</span>"),c.push('<span style="margin:0;color:'+g+'">'),w?c.push("&nbsp;&nbsp;&nbsp;"+Fai.format(LS.salePromotionFullReduce,i.other.ruleData.d[P].m,i.other.ruleData.d[P].n)):c.push("&nbsp;&nbsp;&nbsp;"+Fai.format(LS.salePromotionFullReduce,Fai.formatPriceEn(i.other.ruleData.d[P].m,null,!0),Fai.formatPriceEn(i.other.ruleData.d[P].n,null,!0))),c.push("</span>"),c.push("</span>");c.push("</span>"),c.push("\t</div>"),c.push("</div>"),m.find(".J_mallPriceClass").after(c.join(""))}Site.showSalePromotionDl(),Fai.top._manageMode&&Z()}}}function k(i){e.data;var a={};t.extend(a,{src:"",width:-1,height:-1},i),function(i){var a,n,o=e.dom.productImg,l=i.src||"",r=new Image,u=o.find(".J_nowImg");t.trim(l).length<1&&Fai.ing("找不到该图片",!0);if(u.length>0&&u.attr("src")==t.trim(l))return;o.empty().append('<div class="f-productImgLoading"></div>'),s&&s.onload&&(s.onload=function(){});r.onload=function(){var t,i,s=!1,p=!1,c="",d=[],m=[];a=r.width,t=a,n=r.height,i=n,a>=n&&a>390?(s=!0,t=390):n>390&&(p=!0,i=390),s&&(c+="width:"+t+"px;"),p&&(c+="height:"+i+"px;"),s&&!p&&(i=390*r.height/r.width),!s&&p&&(t=390*r.width/r.height),v.picZoom||v.picPopupPD?m.push('\t<img class="J_nowImg " src="'+l+'" style="'+c+'" />'):(m.push('\t<a class="f-imgClick" href="'+e.data.nowData.productUrl+'" target="_blank" title="'+LS.toProductDetail+'">'),m.push('\t\t<img class="J_nowImg " src="'+l+'" style="'+c+'" />'),m.push("\t</a>")),d.push('<table cellpadding="0" cellspacing="0" class="f-imgContainer">'),d.push("\t<tr>"),d.push("\t\t<td>"),d.push(m.join("")),d.push("\t\t</td>"),d.push("\t</tr>"),d.push("</table>"),v.picZoom&&((m=[]).push(d.join("")),(d=[]).push('<div class="cloud-zoom f-imgWrap" href="'+l+'">'),d.push(m.join("")),d.push("</div>")),o.empty(),o.append(d.join("")),v.picZoom&&((u=o.find(".cloud-zoom")).attr("rel",'adjustX:-4, adjustY:-4, maxWidth:390, maxHeight:390,position:"inside"'),u.CloudZoom({imageHeight:n,imageWidth:a}),v.picPopupPD||setTimeout(function(){o.find(".mousetrap").append('<a href="'+e.data.nowData.productUrl+'" target="_blank" hidefocus="true" class="f-popupImgA" title="点击查看产品详情"></a>')},30))},s=r,setTimeout(function(){r.src=l},50)}(a)}function D(){var t=e.data.nowData;t&&k({src:t.picPath,width:t.picwidth,height:t.picHeight})}function B(){var i=e.dom,a=e.data,s=i.groupBtn;s.left.removeClass("f-BtnDisabled f-BtnEnabled"),s.right.removeClass("f-BtnDisabled f-BtnEnabled"),i.imgListWrap.empty(),i.imgListWrap.append(function(t){var i,a,s,o,l=[],r=[],u=0,p=(t=e.data.id,!1),c="",d="",m=0,f=0;for(o=n.length,s=0;s<o;s++)if(n[s].id==t){i=n[s],p=!0;break}if(!p)return"";for(o=(a=i.picPathList||[]).length,s=0;s<o;s++)c=a[s].thumbPath,d=a[s].path,m=a[s].picWidth,f=a[s].picHeight,r.push("<li>"),r.push('\t<a href="javascript:;" class="J_pic" onclick="return false;" path="'+d+'" picwidth="'+m+'" picheight="'+f+'" >'),r.push('\t\t<img src="'+c+'" style="display: block; width:60px; height:60px;" />'),r.push("\t</a>"),r.push("</li>"),u+=68;return l.push('\t\t\t<div class="f-imgListOuter J_imgListOuter">'),l.push('\t\t\t\t<ul class="f-imgList J_imgList" style="width:'+u+'px;" _num="0">'),l.push(r.join("")),l.push("\t\t\t\t</ul>"),l.push("\t\t\t</div>"),l.join("")}(a.id)),i.imgListOuter=i.imgListWrap.find(".J_imgListOuter"),i.imgList=i.imgListWrap.find(".J_imgList"),i.imgList.find(".J_pic").hover(function(){k({src:t(this).attr("path"),width:t(this).attr("picwidth"),height:t(this).attr("picheight")})})}function R(){var i=e.dom;i.albumsWrap.empty(),i.albumsWrap.append(function(){var t,e,i,a=[],s=[],o=0;if(n&&n.length>0){for(var l=0,r=n.length;l<r;l++)e=(t=n[l]).picThumbPath||"",i=t.id,s.push("<li>"),s.push('\t<div class="f-albumsImgWrap J_albumsImgWrap J_albumsImgWrap'+i+'">'),s.push('\t\t<a href="javascript:;" onclick="return false;" class="f-albumsImg J_albumsImg J_albumsImg'+i+'" _id="'+i+'">'),s.push('\t\t\t<img data-src="'+e+'" class="f_albums_image" />'),s.push("\t\t</a>"),s.push('\t\t<div class="f-albumsImgTip"></div>'),s.push("\t</div>"),s.push("</li>"),o+=90;a.push('<div class="f-albumsOuter J_albumsOuter">'),a.push('\t<ul class="f-albums J_albums" style="width:'+o+'px;" _num="0">'),a.push(s.join("")),a.push("\t</ul>"),a.push("</div>")}return a.join("")}()),i.albumsOuter=i.albumsWrap.find(".J_albumsOuter"),i.albums=i.albumsWrap.find(".J_albums"),i.albumsImgWrap=i.albums.find(".J_albumsImgWrap"),i.albums.children().first().outerWidth(),i.albums.find(".J_albumsImg").click(function(){var e=t(this).attr("_id");V(e);H(e)}),A(),O({index:g,visibleNum:2}),function(){var i=e.dom,a=i.albums,n=i.albumsOuter,s=i.albumsBtn,o={content:a,contentOuter:n,button:s,scrollRow:!0},l={};t.extend(l,o,{scrollRow:!0}),M(l)}()}function T(){var t=e.dom,i=e.data;t.albumsImgWrap.removeClass("f-albumsImgWrap-selected"),t.albumsImgWrap.filter(".J_albumsImgWrap"+i.id).addClass("f-albumsImgWrap-selected")}function W(i){var a=e.dom,s=0,o={content:a.albums,contentOuter:a.albumsOuter,button:a.albumsBtn,scrollRow:!0,visibleNum:2},l={};i.changeProduct;t.extend(l,o,i),l.scrollRow?N(l):(O({index:s=function(t){var e,i,a=t.content.children(),n=a.length,s=(a.first().outerWidth(),t.contentOuter.width(),g),o=t.direction,l=0,r=t.cycle||!1;if(e=n-n%1,o)if((i=s+1)<e)l=i;else if(s>e)l=0;else{if(e==n)return l=e-1,r&&(l=0),l;if(e==s)return l=e;l=e}else if((i=s-1)>0)l=i;else if(s<0)l=0;else if(l=0,0==s)return r&&(l=n-1),l;return l}(l),visibleNum:2}),function(t){if(g==t)return;n&&n[t]&&H(n[t].id)}(s)),M(l),t("#fk-productSlidePanel").find(".optionMsg").hide()}function j(i){var a=e.dom,n={content:a.imgList,contentOuter:a.imgListOuter,button:a.groupBtn,scrollRow:!0},s={};t.extend(s,n,i),N(s),M(s)}function N(t){var e,i=t.content,a=i.children(),n=a.length,s=a.first().outerWidth(),o=t.contentOuter.width(),l=parseInt(o/s),r=t.visibleNum||0,u=l-r,p=parseInt((n-r)/u),c=parseInt(i.attr("_num"))||0,d=0;(n<=l?p=0:p*u-n>=0&&(p-=1),t.direction)?(d=c+1)>p?(d=0,A(0),i.stop(!0).animate({left:"0"}),i.attr("_num",d)):(A(e=-d*u*s),i.stop(!0).animate({left:e+"px"}),i.attr("_num",d)):((d=c-1)<0&&(d=p),A(e=-d*u*s),i.stop(!0).animate({left:e+"px"}),i.attr("_num",d))}function O(t){var i=e.dom,a=i.albums,n=a.children(),s=n.length,o=n.first().outerWidth(),l=i.albumsOuter.width(),r=parseInt(l/o),u=t.visibleNum||0,p=r-u,c=0,d=parseInt(a.attr("_num"))||0,m=0,f=0,h=t.index;if(u>parseInt(r/2)&&(p=r-(u=parseInt(r/2))),s>r&&h>=p?((c=parseInt((s-u)/p))*p-s>=0&&(c-=1),m=parseInt((h-u)/p),f=parseInt(h/p)):(c=0,m=0,f=0),m>c?m=0:m<0&&(m=c),d!=m&&d!=f){var g=-m*p*o;A(g),a.stop(!0).animate({left:g+"px"}),a.attr("_num",m)}}function A(t){for(var i=parseInt(t||0),a=e.cachePreviewImgList.length?e.cachePreviewImgList:e.cachePreviewImgList=e.dom.albums.children(),n=e.dom.albumsWrap.width(),s=a.eq(0).outerWidth(!0),o=parseInt(Math.abs(i)/s),l=o+Math.ceil(n/s),r=o;r<l;r++){var u=a.eq(r).find("img");u.length&&!u.attr("src")&&u.attr("src",u.attr("data-src"))}}function M(t){var e=t.content,i=e.children(),a=i.length,n=i.first().outerWidth(),s=t.contentOuter.width(),o=t.button,l=parseInt(s/n),r=t.visibleNum||0,u=l-r,p=parseInt((a-r)/u),c=parseInt(e.attr("_num"))||0;a<=l?p=0:p*u-a>=0&&(p-=1),c+1>p?(0,o.right.addClass("f-BtnDisabled").removeClass("f-BtnEnabled")):o.right.addClass("f-BtnEnabled").removeClass("f-BtnDisabled"),c-1<0?o.left.addClass("f-BtnDisabled").removeClass("f-BtnEnabled"):o.left.addClass("f-BtnEnabled").removeClass("f-BtnDisabled")}function E(i){var a,s,o=[];o.push(i.qsUrl),o.push("&cmd=list&part=true"),t.ajax({type:"get",cache:!1,url:Site.genAjaxUrl("productSlide_h.jsp")+o.join(""),error:function(){Fai.ing("服务繁忙，请稍候重试",!1)},success:function(i){var o=t.parseJSON(i),p=e.data;if(o.success){if(n=o.list,v=o.setInfo,l=o.data,C=l.css,u=l.levelDiscount,m=l.memberPrice,c=l.proIndepDisc,P=l.isLoadAllPdList,f=l.memberPriceLabel,_=v.prop2,Fai.top._manageMode&&(r=o.itemList),n.length<1)return void Fai.ing("没有产品信息");if(a=(new Date).getTime(),s=l.svrTimeLong,l.timeDiff=s-a,l.saleShowType=1,l.saleCountTimeInterval="",-1==l.productId?p.id=n[0].id:p.id=l.productId,-1==(g=V(p.id)))return void Fai.ing("没有该产品信息");p.nowData=n[g],function(){if(function(i){!Site.checkCssLoad(C)&&t.trim(C).length>0?Site.demandLoadCss(C,function(){"function"==typeof i.func&&i.func.apply(e,arguments)}):"function"==typeof i.func&&i.func.apply(e,arguments)}({func:function(){var t=e.dom;t.panel&&t.panel.length>0?t.panel.is(":hidden")&&t.panel.show():Fai.top.$("#fk-productSlidePanel").show(),D(),I(),S(),B(),R(),z(),T(),setTimeout(function(){U()},50)}}),Fai.top._manageMode&&r&&r.length>0){var i=e.dom.content;i.off("mousemove.productSlide").on("mousemove.productSlide",function(){Site.addEditLayer("fk-productSlideContent",r,100,{extCls:"fk-productSlideEditLayer"})}),i.off("mouseleave.productSlide").on("mouseleave.productSlide",function(){Site.removeEditLayer("fk-productSlideContent")})}}()}else Fai.ing("获取数据失败",!1)}})}function z(){v.shareShow&&(e.dom.shareContent.addClass("f-shareContentIniting"),clearTimeout(o),o=setTimeout(function(){var i=[];i.push("cmd=share"),i.push("&id="+e.data.id),i.push("&browserTitle="+Fai.top.document.title),t.ajax({type:"post",url:Site.genAjaxUrl("productSlide_h.jsp"),data:i.join(""),error:function(){Fai.ing("服务繁忙，请稍后重试",!1)},success:function(i){var a=t.parseJSON(i),n=e.dom,s="";a.success?s=a.content||"":Fai.ing("获取数据失败",!1),n.shareContent.removeClass("f-shareContentIniting"),n.shareContent.empty().append(s)}})},300))}function V(t){var e,i,a=-1;if(n&&n.length>0)for(i=n.length,e=0;e<i;e++)if(n[e].id==t){a=e;break}return a}function H(i){var a,s=e.data;-1!=(a=V(i))?a!=g&&(g=a,s.id=parseInt(i),s.nowData=n[g],function(){if((g+50>n.length||g-50<0)&&!P){var e=[];e.push(b),e.push("&cmd=list&part=false"),t.ajax({type:"get",cache:!1,url:Site.genAjaxUrl("productSlide_h.jsp")+e.join(""),error:function(){Fai.ing("服务繁忙，请稍候重试",!1)},success:function(e){var i=t.parseJSON(e);i.success&&(n=i.list,P=!0)}})}}(),e.dom.imgList=null,D(),I(),S(),B(),z(),T(),setTimeout(function(){U()},50)):Fai.ing("没有该产品信息")}function U(){var t,i,a,n=e.data.nowData.picPathList||[];for(i=n.length,t=0;t<i;t++)a=n[t].path,(new Image).src=a}function q(){n=null,g=-1,s=null,o=null,l=null,v=null,u=null,p=null,d=null,c=null,m=null,f=null,h=!1,e.data={},_=82}function G(){var i,a=e.dom,n=(a.panel,a.panelBtn),s=a.groupBtn,o=a.albumsBtn;n.close.click(function(){X()}),n.left.click(function(){W({scrollRow:!1,direction:!1,cycle:!0,changeProduct:!0})}),n.right.click(function(){W({scrollRow:!1,direction:!0,cycle:!0,changeProduct:!0})}),o.left.click(function(){W({scrollRow:!0,direction:!1})}),o.right.click(function(){W({scrollRow:!0,direction:!0})}),s.left.click(function(){j({scrollRow:!0,direction:!1})}),s.right.click(function(){j({scrollRow:!0,direction:!0})}),a.contentBg.click(function(){X()}),a.productPicContent.hover(function(){if(a.imgList){var n=a.imgList.children();n&&n.length<2||(i=setTimeout(function(){a.productImgGroup.slideDown("normal",function(){var i,a,n;i=e.dom,a={content:i.imgList,contentOuter:i.imgListOuter,button:i.groupBtn,scrollRow:!0},n={},t.extend(n,a,{scrollRow:!0}),M(n)})},250))}},function(){clearTimeout(i),a.productImgGroup.slideUp()}),a.content.mouseleave(function(){clearTimeout(i),a.productImgGroup.slideUp()})}function $(){var t=e.dom;Fai.top.$(".J_popup_bg").length>1&&t.contentBg.css("opacity",".15")}function X(){var t=e.dom;Fai.top._manageMode&&r&&Site.removeEditLayer("fk-productSlideContent"),t.panel&&t.panel.hide(),q(),e.dom={},e.cachePreviewImgList=[],b="",C="",r=null,Fai.top.$("#fk-productSlidePanel").remove()}function Z(){t(".f-propName").attr("class","f-propName paramResize"),function(){var e=t(".f-propListContent ").find(".f-propContent").find(".paramResize");if(e.length<1)return;e.each(function(){var e,i,a,n,s=t(this),o=Fai.isIE8()?t(document):t(window),l=t(this),r={};function u(e){e=e||window.event,r.x=e.pageX,t(this).hasClass("u-paramResize-w")?(r.dir="w",r.ptb=parseInt(l.css("width"))):t(this).hasClass("u-paramResize-e")&&(r.dir="e",r.ptb=parseInt(l.css("width"))),a=t("#dockTip").show().css({left:"-1000px;",top:"-1000px"}),o.off("mousemove.fi").on("mousemove.fi",p),o.off("mouseup.fi").on("mouseup.fi",c),e.preventDefault()}function p(e){t("body").css("cursor","e-resize"),t(".f-propName").css({"border-left":"1px dashed #2b73ba","border-right":"1px dashed #2b73ba","border-top":"1px solid #2b73ba","border-bottom":"1px solid #2b73ba"});var i,s,o={x:(e=e||window.event).pageX},l="";"w"==r.dir?(i=r.x-o.x,s=(s=(s=r.ptb+i)>1?s:1)>200?200:s,s=Math.round(s),l="宽度:"):"e"==r.dir&&(i=o.x-r.x,s=(s=(s=r.ptb+i)>1?s:1)>200?200:s,s=Math.round(s),l="宽度:"),n=s,t(".f-propName").css({width:s+"px"}),t(".f-optionValue").css({width:318-s+"px"}),t(".f-countValue").css({width:318-s+"px"}),a.html(l+s).css({left:e.pageX-28,top:e.pageY-40}),e.preventDefault()}function c(e){t("body").css("cursor",""),t(".f-propName").css("border","1px dashed transparent"),e=e||window.event,r.dir="",o.off("mousemove.fi"),o.off("mouseup.fi"),a.hide(),r={};var i=v.id,s="cmd=set&id="+i+"&style=19&prop0=1&prop2="+n,l=Site.genAjaxUrl("module_h.jsp");Fai.ing("正在保存……",!1),t.ajax({type:"post",url:l,data:s,error:function(){Fai.ing("服务繁忙，请稍候重试",!1)},success:function(e){var i=t.parseJSON(e);i.success?(Fai.ing("修改宽度成功",!0),_=n):(Fai.ing(i.msg,!1),t(".J_productDetailContent").find(".f-propContent").find(".paramResize").css("width",_))}}),e.preventDefault()}s.hasClass("paramResize")&&(s.before("<div class='u-paramResize-w' style='float:left' title='可拖动调节宽度'><div style='width:5px;height:"+t(s).outerHeight()+"px;z-index:999'></div></div>"),s.after("<div class='u-paramResize-e' style='float:left' title='可拖动调节宽度'><div style='width:5px;height:"+t(s).outerHeight()+"px;z-index:999'></div></div>"),t(".u-paramResize-e,.u-paramResize-w").css("cursor","e-resize")),e=t(s).prev(),(i=t(s).next()).hasClass("u-paramResize-e")&&e.hasClass("u-paramResize-w")&&(e.off("mousedown.fi").on("mousedown.fi",u),i.off("mousedown.fi").on("mousedown.fi",u))})}(),t(".f-propName,.u-paramResize-e,.u-paramResize-w").hover(function(){t(".f-propName").css({"border-left":"1px dashed #2b73ba","border-right":"1px dashed #2b73ba","border-top":"1px solid #2b73ba","border-bottom":"1px solid #2b73ba"})},function(){t(".f-propName").css("border","1px dashed transparent")})}e.init=function(t){var i,a;X(),Fai.top.$("body").append(y().join("")),b=t,E({qsUrl:t}),i={eventFunc:G,styleFunc:$},(a=e.dom).panel=Fai.top.$("#fk-productSlidePanel"),a.content=a.panel.find(".J_content"),a.contentBg=a.panel.find(".J_contentBg"),a.panelBtn={},a.panelBtn.left=a.panel.find(".J_turnLeft"),a.panelBtn.right=a.panel.find(".J_turnRight"),a.panelBtn.close=a.panel.find(".J_close"),a.multiContent=a.panel.find(".J_multiContent"),a.albumsContent=a.panel.find(".J_albumsContent"),a.multiContentLeft=a.multiContent.find(".J_multiContentLeft"),a.multiContentRight=a.multiContent.find(".J_multiContentRight"),a.productDetailContent=a.multiContentRight.find(".J_productDetailContent"),a.productBuyContent=a.multiContentRight.find(".J_productBuyContent"),a.shareContent=a.multiContentLeft.find(".J_shareContent"),a.productPicContent=a.multiContentLeft.find(".J_productPicContent"),a.productImg=a.multiContentLeft.find(".J_productImg"),a.productImgGroup=a.multiContentLeft.find(".J_productImgGroup"),a.imgListWrap=a.multiContentLeft.find(".J_imgListWrap"),a.groupBtn={},a.groupBtn.left=a.multiContentLeft.find(".J_groupLeft"),a.groupBtn.right=a.multiContentLeft.find(".J_groupRight"),a.albumsWrap=a.albumsContent.find(".J_albumsWrap"),a.albumsBtn={},a.albumsBtn.left=a.albumsContent.find(".J_albumsLeft"),a.albumsBtn.right=a.albumsContent.find(".J_albumsRight"),"function"==typeof i.eventFunc&&setTimeout(function(){i.eventFunc.apply(e,arguments)},30),"function"==typeof i.styleFunc&&setTimeout(function(){i.styleFunc.apply(e,arguments)},30)},e.refresh=function(){var t;(t=e.dom).productDetailContent.empty(),t.productBuyContent.empty(),t.productImg.empty(),t.imgListWrap.empty(),t.albumsWrap.empty(),t.shareContent.empty(),q(),E({qsUrl:b})}}(jQuery,Site.productSlide);